% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{ifxetex,ifluatex}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={PGY1 - Allocations 2024},
  pdfauthor={Dr Scott Johnson Gelzinnis},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\usepackage{booktabs}
\usepackage{caption}
\usepackage{longtable}
\usepackage{colortbl}
\usepackage{array}
\ifluatex
  \usepackage{selnolig}  % disable illegal ligatures
\fi

\title{PGY1 - Allocations 2024}
\author{Dr Scott Johnson Gelzinnis}
\date{2024-03-08}

\begin{document}
\maketitle

\emph{Copyright Dr Scott Johnson Gelzinnis (2023) - Statement below}

\hypertarget{setting-up-the-environment}{%
\section{Setting up the Environment}\label{setting-up-the-environment}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(}\FunctionTok{here}\NormalTok{())}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'here' was built under R version 4.1.3
\end{verbatim}

\begin{verbatim}
## here() starts at D:/My Documents/GitHub/term-allocations
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{i\_am}\NormalTok{(}\StringTok{"PGY2\_Solve\_TRIAL.Rmd"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## here() starts at D:/My Documents/GitHub/term-allocations
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# List of required packages}
\NormalTok{required\_packages }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"randomNames"}\NormalTok{, }\StringTok{"lpSolve"}\NormalTok{, }\StringTok{"lpSolveAPI"}\NormalTok{, }\StringTok{"ROI"}\NormalTok{, }\StringTok{"gt"}\NormalTok{, }\StringTok{"readr"}\NormalTok{, }\StringTok{"tidyverse"}\NormalTok{, }\StringTok{"googlesheets4"}\NormalTok{, }\StringTok{"stringr"}\NormalTok{, }\StringTok{"knitr"}\NormalTok{, }\StringTok{"writexl"}\NormalTok{)}

\CommentTok{\# Check if packages are installed and install them if they are not}
\NormalTok{new\_packages }\OtherTok{\textless{}{-}}\NormalTok{ required\_packages[}\SpecialCharTok{!}\NormalTok{(required\_packages }\SpecialCharTok{\%in\%} \FunctionTok{installed.packages}\NormalTok{()[,}\StringTok{"Package"}\NormalTok{])]}
\ControlFlowTok{if}\NormalTok{(}\FunctionTok{length}\NormalTok{(new\_packages)) }\FunctionTok{install.packages}\NormalTok{(new\_packages)}

\CommentTok{\# Load the packages}
\FunctionTok{lapply}\NormalTok{(required\_packages, require, }\AttributeTok{character.only =} \ConstantTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Loading required package: randomNames
\end{verbatim}

\begin{verbatim}
## Warning: package 'randomNames' was built under R version 4.1.3
\end{verbatim}

\begin{verbatim}
## Loading required package: lpSolve
\end{verbatim}

\begin{verbatim}
## Warning: package 'lpSolve' was built under R version 4.1.3
\end{verbatim}

\begin{verbatim}
## Loading required package: lpSolveAPI
\end{verbatim}

\begin{verbatim}
## Warning: package 'lpSolveAPI' was built under R version 4.1.3
\end{verbatim}

\begin{verbatim}
## Loading required package: ROI
\end{verbatim}

\begin{verbatim}
## ROI: R Optimization Infrastructure
\end{verbatim}

\begin{verbatim}
## Registered solver plugins: nlminb, glpk.
\end{verbatim}

\begin{verbatim}
## Default solver: auto.
\end{verbatim}

\begin{verbatim}
## Loading required package: gt
\end{verbatim}

\begin{verbatim}
## Loading required package: readr
\end{verbatim}

\begin{verbatim}
## Loading required package: tidyverse
\end{verbatim}

\begin{verbatim}
## -- Attaching packages --------------------------------------- tidyverse 1.3.1 --
\end{verbatim}

\begin{verbatim}
## v ggplot2 3.3.5     v dplyr   1.1.2
## v tibble  3.2.1     v stringr 1.4.0
## v tidyr   1.1.3     v forcats 0.5.1
## v purrr   0.3.4
\end{verbatim}

\begin{verbatim}
## Warning: package 'tibble' was built under R version 4.1.3
\end{verbatim}

\begin{verbatim}
## Warning: package 'dplyr' was built under R version 4.1.3
\end{verbatim}

\begin{verbatim}
## -- Conflicts ------------------------------------------ tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()
\end{verbatim}

\begin{verbatim}
## Loading required package: googlesheets4
\end{verbatim}

\begin{verbatim}
## Loading required package: knitr
\end{verbatim}

\begin{verbatim}
## Loading required package: writexl
\end{verbatim}

\begin{verbatim}
## Warning: package 'writexl' was built under R version 4.1.3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Random seed}
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{69}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{loading-in-the-preference-matrix}{%
\section{Loading in the Preference
Matrix}\label{loading-in-the-preference-matrix}}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Read in Google Sheet}
\NormalTok{raw\_preference\_data }\OtherTok{\textless{}{-}} \FunctionTok{read\_sheet}\NormalTok{(}\StringTok{"https://docs.google.com/spreadsheets/d/19xMulDMIK6FgmfMajmI1BnlaSsVut\_idzsIN1k{-}X{-}Aw/edit?usp=sharing"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## ! Using an auto-discovered, cached token.
\end{verbatim}

\begin{verbatim}
##   To suppress this message, modify your code or options to clearly consent to
##   the use of a cached token.
\end{verbatim}

\begin{verbatim}
##   See gargle's "Non-interactive auth" vignette for more details:
\end{verbatim}

\begin{verbatim}
##   <https://gargle.r-lib.org/articles/non-interactive-auth.html>
\end{verbatim}

\begin{verbatim}
## i The googlesheets4 package is using a cached token for
##   'scott.gelzinnis@gmail.com'.
\end{verbatim}

\begin{verbatim}
## v Reading from "PGY 1 Allocations 2024 (FINAL)".
\end{verbatim}

\begin{verbatim}
## v Range
##   '2024 Hunter New England - Junior Medical Officer (PGY1) Term Allocations EOI'.
\end{verbatim}

\begin{verbatim}
## New names:
## * `First Name` -> `First Name...8`
## * `Last Name` -> `Last Name...9`
## * `Last Name` -> `Last Name...13`
## * `First Name` -> `First Name...14`
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Convert the tibble to a data.frame}
\NormalTok{raw\_preference\_data }\OtherTok{\textless{}{-}} \FunctionTok{as.data.frame}\NormalTok{(raw\_preference\_data)}

\DocumentationTok{\#\# Define preference matrix  \#\#}

\CommentTok{\# Combine columns 13 and 14 to create the "Doctor" column}
\NormalTok{raw\_preference\_data}\SpecialCharTok{$}\NormalTok{Doctor }\OtherTok{\textless{}{-}} \FunctionTok{paste}\NormalTok{(raw\_preference\_data[[}\DecValTok{13}\NormalTok{]], raw\_preference\_data[[}\DecValTok{14}\NormalTok{]], }\AttributeTok{sep =} \StringTok{", "}\NormalTok{)}

\CommentTok{\# Sort the raw\_preference\_data by Doctor column}
\NormalTok{raw\_preference\_data }\OtherTok{\textless{}{-}}\NormalTok{ raw\_preference\_data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{arrange}\NormalTok{(Doctor)}

\CommentTok{\# Extract column names that have the pattern \textquotesingle{}| \textquotesingle{}}
\NormalTok{term\_columns }\OtherTok{\textless{}{-}} \FunctionTok{grep}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{| "}\NormalTok{, }\FunctionTok{names}\NormalTok{(raw\_preference\_data), }\AttributeTok{value =} \ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\# Select the relevant columns}
\NormalTok{selected\_data }\OtherTok{\textless{}{-}}\NormalTok{ raw\_preference\_data[, term\_columns]}

\CommentTok{\# Select survey data and load as a data frame}
\CommentTok{\# Read in and rename columns of survey\_data}
\NormalTok{survey\_data }\OtherTok{\textless{}{-}}\NormalTok{ raw\_preference\_data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}
\NormalTok{    Doctor, }
    \StringTok{\textasciigrave{}}\AttributeTok{Desired Career Pathway (GP, Medicine, Surgery, Critical Care, Psych)}\StringTok{\textasciigrave{}}\NormalTok{, }
    \StringTok{\textasciigrave{}}\AttributeTok{Do you have plans requiring leave of more than 2 weeks in the 2024 clinical year? (If possible your request will be accommodated)}\StringTok{\textasciigrave{}}\NormalTok{,}
    \StringTok{\textasciigrave{}}\AttributeTok{Any further comments or questions?}\StringTok{\textasciigrave{}}
\NormalTok{  ) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{rename}\NormalTok{(}
    \StringTok{\textasciigrave{}}\AttributeTok{Desired Career Pathway}\StringTok{\textasciigrave{}} \OtherTok{=} \StringTok{\textasciigrave{}}\AttributeTok{Desired Career Pathway (GP, Medicine, Surgery, Critical Care, Psych)}\StringTok{\textasciigrave{}}\NormalTok{,}
    \StringTok{\textasciigrave{}}\AttributeTok{Leave Request Term}\StringTok{\textasciigrave{}} \OtherTok{=} \StringTok{\textasciigrave{}}\AttributeTok{Do you have plans requiring leave of more than 2 weeks in the 2024 clinical year? (If possible your request will be accommodated)}\StringTok{\textasciigrave{}}
\NormalTok{  )}

\CommentTok{\# Set "Doctor" column as row names}
\FunctionTok{rownames}\NormalTok{(selected\_data) }\OtherTok{\textless{}{-}}\NormalTok{ raw\_preference\_data}\SpecialCharTok{$}\NormalTok{Doctor}

\CommentTok{\# Clean the column names by removing everything before \textquotesingle{}| \textquotesingle{} (i.e., pipe followed by a space)}
\FunctionTok{colnames}\NormalTok{(selected\_data) }\OtherTok{\textless{}{-}} \FunctionTok{gsub}\NormalTok{(}\StringTok{".*}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{| "}\NormalTok{, }\StringTok{""}\NormalTok{, }\FunctionTok{colnames}\NormalTok{(selected\_data))}

\CommentTok{\# Convert selected data to a matrix and exclude the "Doctor" column}
\NormalTok{preference\_matrix }\OtherTok{\textless{}{-}} \FunctionTok{as.matrix}\NormalTok{(selected\_data)}

\CommentTok{\# Define dimensions based on preference\_matrix}
\NormalTok{num\_columns }\OtherTok{\textless{}{-}} \FunctionTok{ncol}\NormalTok{(preference\_matrix)}
\NormalTok{num\_doctors }\OtherTok{\textless{}{-}} \FunctionTok{nrow}\NormalTok{(preference\_matrix)}
\NormalTok{num\_terms }\OtherTok{\textless{}{-}}\NormalTok{ num\_columns  }

\CommentTok{\# Assuming the number of terms is equal to the number of columns in the matrix}
\NormalTok{row\_names }\OtherTok{\textless{}{-}} \FunctionTok{rownames}\NormalTok{(selected\_data)}
\NormalTok{column\_names }\OtherTok{\textless{}{-}} \FunctionTok{colnames}\NormalTok{(selected\_data)}
\end{Highlighting}
\end{Shaded}

\hypertarget{definitions}{%
\section{Definitions}\label{definitions}}

\begin{Shaded}
\begin{Highlighting}[]
                         \DocumentationTok{\#\# Linear Optimization {-} Defining the problem \#\#}

\NormalTok{term\_master\_df }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"PGY1 2024 Dataframe.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Rows: 59 Columns: 14
## -- Column specification --------------------------------------------------------
## Delimiter: ","
## chr (8): Term Name, Term Classification, Term Classification 2, Specialty St...
## dbl (6): PGY1 Term 1 Allocation, PGY1 Term 2 Allocation, PGY1 Term 3 Allocat...
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Directly infer the number of doctors and terms from the preference matrix}
\NormalTok{num\_doctors }\OtherTok{\textless{}{-}} \FunctionTok{nrow}\NormalTok{(preference\_matrix)}
\NormalTok{num\_terms }\OtherTok{\textless{}{-}} \FunctionTok{ncol}\NormalTok{(preference\_matrix)}

\CommentTok{\# Define the objective function coefficients (preferences)}
\NormalTok{objective\_coeffs }\OtherTok{\textless{}{-}} \FunctionTok{as.vector}\NormalTok{(preference\_matrix)}

\CommentTok{\# Extract the maximum number of doctors allowed for each term using the column names}
\NormalTok{max\_doctors\_per\_term1 }\OtherTok{\textless{}{-}} \FunctionTok{as.vector}\NormalTok{(term\_master\_df}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{PGY1 Term 1 Allocation}\StringTok{\textasciigrave{}}\NormalTok{)}
\NormalTok{max\_doctors\_per\_term2 }\OtherTok{\textless{}{-}} \FunctionTok{as.vector}\NormalTok{(term\_master\_df}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{PGY1 Term 2 Allocation}\StringTok{\textasciigrave{}}\NormalTok{)}
\NormalTok{max\_doctors\_per\_term3 }\OtherTok{\textless{}{-}} \FunctionTok{as.vector}\NormalTok{(term\_master\_df}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{PGY1 Term 3 Allocation}\StringTok{\textasciigrave{}}\NormalTok{)}
\NormalTok{max\_doctors\_per\_term4 }\OtherTok{\textless{}{-}} \FunctionTok{as.vector}\NormalTok{(term\_master\_df}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{PGY1 Term 4 Allocation}\StringTok{\textasciigrave{}}\NormalTok{)}
\NormalTok{max\_doctors\_per\_term5 }\OtherTok{\textless{}{-}} \FunctionTok{as.vector}\NormalTok{(term\_master\_df}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{PGY1 Term 5 Allocation}\StringTok{\textasciigrave{}}\NormalTok{)}

\CommentTok{\# Helper function for tidy conversions}
\NormalTok{convert\_and\_name }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(column\_name) \{}
\NormalTok{  term\_master\_df }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{pull}\NormalTok{(column\_name) }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{as.factor}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{set\_names}\NormalTok{(term\_master\_df}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{Term Name}\StringTok{\textasciigrave{}}\NormalTok{)}
\NormalTok{\}}

\CommentTok{\# Using the helper function to define the vectors}
\NormalTok{clinical\_structure\_term }\OtherTok{\textless{}{-}} \FunctionTok{convert\_and\_name}\NormalTok{(}\StringTok{\textquotesingle{}Clinical Team Structure\textquotesingle{}}\NormalTok{)}
\NormalTok{specialty\_status\_per\_term }\OtherTok{\textless{}{-}} \FunctionTok{convert\_and\_name}\NormalTok{(}\StringTok{\textquotesingle{}Specialty Status\textquotesingle{}}\NormalTok{)}
\NormalTok{sub\_specialty\_status\_per\_term }\OtherTok{\textless{}{-}} \FunctionTok{convert\_and\_name}\NormalTok{(}\StringTok{\textquotesingle{}Subspecialty Status\textquotesingle{}}\NormalTok{)}
\NormalTok{rural\_status\_term }\OtherTok{\textless{}{-}} \FunctionTok{convert\_and\_name}\NormalTok{(}\StringTok{\textquotesingle{}Rurality\textquotesingle{}}\NormalTok{)}
\NormalTok{term\_classification1 }\OtherTok{\textless{}{-}} \FunctionTok{convert\_and\_name}\NormalTok{(}\StringTok{\textquotesingle{}Term Classification\textquotesingle{}}\NormalTok{)}
\NormalTok{term\_classification2 }\OtherTok{\textless{}{-}} \FunctionTok{convert\_and\_name}\NormalTok{(}\StringTok{\textquotesingle{}Term Classification 2\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{linear-optimization-model-with-minimized-dissatisfaction}{%
\section{Linear Optimization Model with Minimized
Dissatisfaction}\label{linear-optimization-model-with-minimized-dissatisfaction}}

\hypertarget{with-allowable-constraints-to-provide-viable-solution-i.e-if-unable-to-solve-roll-back-constraint-one-at-a-time}{%
\subsubsection{With allowable constraints to provide viable solution
(i.e if unable to solve, roll back constraint one at a
time)}\label{with-allowable-constraints-to-provide-viable-solution-i.e-if-unable-to-solve-roll-back-constraint-one-at-a-time}}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Linear Optimization with Weighted Dissatisfaction Values \#\#}

\CommentTok{\# Use the preference\_matrix directly as the dissatisfaction\_values}
\NormalTok{dissatisfaction\_values }\OtherTok{\textless{}{-}}\NormalTok{ preference\_matrix}


\CommentTok{\# Convert dissatisfaction values to a vector for the objective function}
\NormalTok{objective\_coeffs\_dissatisfaction }\OtherTok{\textless{}{-}} \FunctionTok{as.vector}\NormalTok{(dissatisfaction\_values)}


\CommentTok{\# Extend LP model to include slack variables}
\NormalTok{lp\_model\_dissatisfaction }\OtherTok{\textless{}{-}} \FunctionTok{make.lp}\NormalTok{(}\DecValTok{0}\NormalTok{, num\_doctors }\SpecialCharTok{*}\NormalTok{ num\_terms }\SpecialCharTok{+}\NormalTok{ num\_doctors)}


\CommentTok{\# SLACK VARIABLE TRIAL}
\NormalTok{slack\_penalty }\OtherTok{\textless{}{-}} \FunctionTok{max}\NormalTok{(dissatisfaction\_values) }\SpecialCharTok{*} \DecValTok{10}
\NormalTok{slack\_coefficients }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(slack\_penalty, num\_doctors)}
\NormalTok{objective\_coeffs\_extended }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(objective\_coeffs\_dissatisfaction, slack\_coefficients)}

\CommentTok{\# Set binary decision variables (0 or 1)}
\FunctionTok{set.type}\NormalTok{(lp\_model\_dissatisfaction, }\AttributeTok{columns =} \DecValTok{1}\SpecialCharTok{:}\NormalTok{(num\_doctors }\SpecialCharTok{*}\NormalTok{ num\_terms), }\AttributeTok{type =} \StringTok{"binary"}\NormalTok{)}

\CommentTok{\# Set the objective function coefficients for minimizing dissatisfaction}
\FunctionTok{set.objfn}\NormalTok{(lp\_model\_dissatisfaction, objective\_coeffs\_extended)}

\CommentTok{\# Initialize a matrix to track specialty assignments}
\NormalTok{unique\_specialty\_statuses }\OtherTok{\textless{}{-}} \FunctionTok{levels}\NormalTok{(specialty\_status\_per\_term)}
\CommentTok{\# Rows represent doctors, and columns represent unique specialty statuses}
\NormalTok{specialty\_assignment\_tracker }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\DecValTok{0}\NormalTok{, }\AttributeTok{nrow =}\NormalTok{ num\_doctors, }\AttributeTok{ncol =} \FunctionTok{length}\NormalTok{(unique\_specialty\_statuses))}

\CommentTok{\# Initialize a matrix to track specialty assignments}
\NormalTok{unique\_subspecialty\_statuses }\OtherTok{\textless{}{-}} \FunctionTok{levels}\NormalTok{(sub\_specialty\_status\_per\_term)}
\CommentTok{\# Rows represent doctors, and columns represent unique specialty statuses}
\NormalTok{subspecialty\_assignment\_tracker }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\DecValTok{0}\NormalTok{, }\AttributeTok{nrow =}\NormalTok{ num\_doctors, }\AttributeTok{ncol =} \FunctionTok{length}\NormalTok{(unique\_subspecialty\_statuses))}

\DocumentationTok{\#\# NEXT STEP TO RUN A LOOP TO ASSIGN 5 TERMS ACROSS THE YEAR BASED ON PREFERENCES \#\#}

\CommentTok{\# Number of times to run the assignment}
\NormalTok{num\_assignments }\OtherTok{\textless{}{-}} \DecValTok{5}

\CommentTok{\# Initialize a list to store the results of each assignment}
\NormalTok{assignment\_results }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{()}

\CommentTok{\# Create a list to store unassigned terms for each assignment iteration}
\NormalTok{unassigned\_terms\_list }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{()}

\CommentTok{\# This matrix will have rows corresponding to doctors and columns corresponding to terms.}
\CommentTok{\# An entry of 1 in the matrix indicates that the doctor (row) has been assigned the term (column).}
\NormalTok{assigned\_terms\_matrix }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\DecValTok{0}\NormalTok{, }\AttributeTok{nrow =}\NormalTok{ num\_doctors, }\AttributeTok{ncol =}\NormalTok{ num\_terms)}

\CommentTok{\# Loop through the assignments}
\ControlFlowTok{for}\NormalTok{ (assignment\_num }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{num\_assignments) \{}
    \CommentTok{\# Create an empty LP model for minimizing dissatisfaction}
\NormalTok{    lp\_model\_dissatisfaction }\OtherTok{\textless{}{-}} \FunctionTok{make.lp}\NormalTok{(}\DecValTok{0}\NormalTok{, num\_doctors }\SpecialCharTok{*}\NormalTok{ num\_terms }\SpecialCharTok{+}\NormalTok{ num\_doctors)}

    \CommentTok{\# Set binary decision variables (0 or 1)}
    \FunctionTok{set.type}\NormalTok{(lp\_model\_dissatisfaction, }\AttributeTok{columns =} \DecValTok{1}\SpecialCharTok{:}\NormalTok{(num\_doctors }\SpecialCharTok{*}\NormalTok{ num\_terms), }\AttributeTok{type =} \StringTok{"binary"}\NormalTok{)}

    \CommentTok{\# Set the objective function coefficients for minimizing dissatisfaction}
    \FunctionTok{set.objfn}\NormalTok{(lp\_model\_dissatisfaction, objective\_coeffs\_extended)}

    \CommentTok{\# Add constraints to ensure one assignment per doctor}
    \ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{num\_doctors) \{}
\NormalTok{        constr\_one\_assignment }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\DecValTok{0}\NormalTok{, num\_doctors }\SpecialCharTok{*}\NormalTok{ num\_terms }\SpecialCharTok{+}\NormalTok{ num\_doctors)}
\NormalTok{        constr\_one\_assignment[((i }\SpecialCharTok{{-}} \DecValTok{1}\NormalTok{) }\SpecialCharTok{*}\NormalTok{ num\_terms }\SpecialCharTok{+} \DecValTok{1}\NormalTok{)}\SpecialCharTok{:}\NormalTok{(i }\SpecialCharTok{*}\NormalTok{ num\_terms)] }\OtherTok{\textless{}{-}} \DecValTok{1}
        \FunctionTok{add.constraint}\NormalTok{(lp\_model\_dissatisfaction, constr\_one\_assignment, }\AttributeTok{type =} \StringTok{"="}\NormalTok{, }\AttributeTok{rhs =} \DecValTok{1}\NormalTok{)}
\NormalTok{    \}}

    \CommentTok{\# Add constraint for top 10 terms for each doctor (MODIFIED TO ADD SLACK)}
\NormalTok{    margin }\OtherTok{=} \SpecialCharTok{{-}}\DecValTok{5}
    \ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{num\_doctors) \{}
\NormalTok{        top\_10\_terms\_for\_doctor }\OtherTok{\textless{}{-}} \FunctionTok{order}\NormalTok{(preference\_matrix[i,])[}\DecValTok{1}\SpecialCharTok{:}\NormalTok{(}\DecValTok{10} \SpecialCharTok{+}\NormalTok{ margin)]}
\NormalTok{        constr\_top\_10 }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\DecValTok{0}\NormalTok{, num\_doctors }\SpecialCharTok{*}\NormalTok{ num\_terms }\SpecialCharTok{+}\NormalTok{ num\_doctors)}
        \ControlFlowTok{for}\NormalTok{ (j }\ControlFlowTok{in}\NormalTok{ top\_10\_terms\_for\_doctor) \{}
\NormalTok{            constr\_top\_10[(i }\SpecialCharTok{{-}} \DecValTok{1}\NormalTok{) }\SpecialCharTok{*}\NormalTok{ num\_terms }\SpecialCharTok{+}\NormalTok{ j] }\OtherTok{\textless{}{-}} \DecValTok{1}
\NormalTok{        \}}
\NormalTok{        constr\_top\_10[num\_doctors }\SpecialCharTok{*}\NormalTok{ num\_terms }\SpecialCharTok{+}\NormalTok{ i] }\OtherTok{\textless{}{-}} \SpecialCharTok{{-}}\NormalTok{margin}
        \FunctionTok{add.constraint}\NormalTok{(lp\_model\_dissatisfaction, constr\_top\_10, }\AttributeTok{type =} \StringTok{"\textgreater{}="}\NormalTok{, }\AttributeTok{rhs =} \DecValTok{1}\NormalTok{)}
\NormalTok{    \}}
    
\CommentTok{\# 1. Max doctors per term constraint:}

\CommentTok{\# Helper function to retrieve the correct \textquotesingle{}max doctors\textquotesingle{} vector for a given term}
\NormalTok{   get\_max\_doctors\_for\_term }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(term) \{}
     \ControlFlowTok{switch}\NormalTok{(term,}
            \StringTok{"1"} \OtherTok{=}\NormalTok{ max\_doctors\_per\_term1,}
            \StringTok{"2"} \OtherTok{=}\NormalTok{ max\_doctors\_per\_term2,}
            \StringTok{"3"} \OtherTok{=}\NormalTok{ max\_doctors\_per\_term3,}
            \StringTok{"4"} \OtherTok{=}\NormalTok{ max\_doctors\_per\_term4,}
            \StringTok{"5"} \OtherTok{=}\NormalTok{ max\_doctors\_per\_term5)}
\NormalTok{   \}}


\ControlFlowTok{for}\NormalTok{ (j }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{num\_terms) \{}
\NormalTok{  constr\_max\_doctors\_per\_term }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\DecValTok{0}\NormalTok{, num\_doctors }\SpecialCharTok{*}\NormalTok{ num\_terms }\SpecialCharTok{+}\NormalTok{ num\_doctors)}
  
\NormalTok{  indices }\OtherTok{\textless{}{-}}\NormalTok{ j }\SpecialCharTok{+} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, (num\_doctors }\SpecialCharTok{{-}} \DecValTok{1}\NormalTok{) }\SpecialCharTok{*}\NormalTok{ num\_terms, }\AttributeTok{by =}\NormalTok{ num\_terms)}
\NormalTok{  constr\_max\_doctors\_per\_term[indices] }\OtherTok{\textless{}{-}} \DecValTok{1}
  
\NormalTok{  max\_doctors\_for\_this\_term }\OtherTok{\textless{}{-}} \FunctionTok{get\_max\_doctors\_for\_term}\NormalTok{(assignment\_num)}
  \FunctionTok{add.constraint}\NormalTok{(lp\_model\_dissatisfaction, constr\_max\_doctors\_per\_term, }\AttributeTok{type =} \StringTok{"\textless{}="}\NormalTok{, }\AttributeTok{rhs =}\NormalTok{ max\_doctors\_for\_this\_term[j])}
\NormalTok{\}}

\CommentTok{\# 2. Constraint to prevent reassignment to same term:}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{num\_doctors) \{}
  \ControlFlowTok{for}\NormalTok{ (j }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{num\_terms) \{}
    \ControlFlowTok{if}\NormalTok{ (assigned\_terms\_matrix[i, j] }\SpecialCharTok{==} \DecValTok{1}\NormalTok{) \{}
\NormalTok{      constraint\_already\_assigned }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\DecValTok{0}\NormalTok{, num\_doctors }\SpecialCharTok{*}\NormalTok{ num\_terms }\SpecialCharTok{+}\NormalTok{ num\_doctors)}
\NormalTok{      constraint\_already\_assigned[(i }\SpecialCharTok{{-}} \DecValTok{1}\NormalTok{) }\SpecialCharTok{*}\NormalTok{ num\_terms }\SpecialCharTok{+}\NormalTok{ j] }\OtherTok{\textless{}{-}} \DecValTok{1}
      \FunctionTok{add.constraint}\NormalTok{(lp\_model\_dissatisfaction, constraint\_already\_assigned, }\AttributeTok{type =} \StringTok{"="}\NormalTok{, }\AttributeTok{rhs =} \DecValTok{0}\NormalTok{)}
\NormalTok{    \}}
\NormalTok{  \}}
\NormalTok{\}}

\CommentTok{\# 3. Specialty Status Constraint:}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{num\_doctors) \{}
  \ControlFlowTok{for}\NormalTok{ (specialty\_idx }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(unique\_specialty\_statuses)) \{}
\NormalTok{    constr\_specialty }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\DecValTok{0}\NormalTok{, num\_doctors }\SpecialCharTok{*}\NormalTok{ num\_terms }\SpecialCharTok{+}\NormalTok{ num\_doctors)}
\NormalTok{    specialty }\OtherTok{\textless{}{-}}\NormalTok{ unique\_specialty\_statuses[specialty\_idx]}
    
    \ControlFlowTok{for}\NormalTok{ (j }\ControlFlowTok{in} \FunctionTok{which}\NormalTok{(specialty\_status\_per\_term }\SpecialCharTok{==}\NormalTok{ specialty)) \{}
\NormalTok{      constr\_specialty[(i }\SpecialCharTok{{-}} \DecValTok{1}\NormalTok{) }\SpecialCharTok{*}\NormalTok{ num\_terms }\SpecialCharTok{+}\NormalTok{ j] }\OtherTok{\textless{}{-}} \DecValTok{1}
\NormalTok{    \}}
    
\NormalTok{    current\_count }\OtherTok{\textless{}{-}}\NormalTok{ specialty\_assignment\_tracker[i, specialty\_idx]}
\NormalTok{    max\_allowed }\OtherTok{\textless{}{-}} \DecValTok{2} \SpecialCharTok{{-}}\NormalTok{ current\_count  }\CommentTok{\# Adjust based on the current count}
    \FunctionTok{add.constraint}\NormalTok{(lp\_model\_dissatisfaction, constr\_specialty, }\AttributeTok{type =} \StringTok{"\textless{}="}\NormalTok{, }\AttributeTok{rhs =}\NormalTok{ max\_allowed)}
\NormalTok{  \}}
\NormalTok{\}}

\CommentTok{\# 4. Sub{-}specialty constraint}
    \ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{num\_doctors) \{}
  \ControlFlowTok{for}\NormalTok{ (subspecialty\_idx }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(unique\_subspecialty\_statuses)) \{}
\NormalTok{    constr\_subspecialty }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\DecValTok{0}\NormalTok{, num\_doctors }\SpecialCharTok{*}\NormalTok{ num\_terms }\SpecialCharTok{+}\NormalTok{ num\_doctors)}
\NormalTok{    subspecialty }\OtherTok{\textless{}{-}}\NormalTok{ unique\_subspecialty\_statuses[subspecialty\_idx]}

    \ControlFlowTok{if}\NormalTok{ (subspecialty }\SpecialCharTok{!=} \StringTok{"NA"}\NormalTok{) \{  }\CommentTok{\# Exclude NA values}
      \ControlFlowTok{for}\NormalTok{ (j }\ControlFlowTok{in} \FunctionTok{which}\NormalTok{(sub\_specialty\_status\_per\_term }\SpecialCharTok{==}\NormalTok{ subspecialty)) \{}
\NormalTok{        constr\_subspecialty[(i }\SpecialCharTok{{-}} \DecValTok{1}\NormalTok{) }\SpecialCharTok{*}\NormalTok{ num\_terms }\SpecialCharTok{+}\NormalTok{ j] }\OtherTok{\textless{}{-}} \DecValTok{1}
\NormalTok{      \}}

\NormalTok{      current\_count }\OtherTok{\textless{}{-}}\NormalTok{ subspecialty\_assignment\_tracker[i, subspecialty\_idx]}
\NormalTok{      max\_allowed }\OtherTok{\textless{}{-}} \DecValTok{1} \SpecialCharTok{{-}}\NormalTok{ current\_count  }\CommentTok{\# Strictly less than 2}
      
      \FunctionTok{add.constraint}\NormalTok{(lp\_model\_dissatisfaction, constr\_subspecialty, }\AttributeTok{type =} \StringTok{"\textless{}="}\NormalTok{, }\AttributeTok{rhs =}\NormalTok{ max\_allowed)}
\NormalTok{    \}}
\NormalTok{  \}}
\NormalTok{\}}
  
\CommentTok{\# Solve the linear programming problem to minimize dissatisfaction}
\NormalTok{lp\_result\_dissatisfaction }\OtherTok{\textless{}{-}} \FunctionTok{solve}\NormalTok{(lp\_model\_dissatisfaction)}

\CommentTok{\# Check if the LP problem was solved successfully}
\ControlFlowTok{if}\NormalTok{ (lp\_result\_dissatisfaction }\SpecialCharTok{==} \DecValTok{0}\NormalTok{) \{}
\NormalTok{    optimal\_solution\_dissatisfaction }\OtherTok{\textless{}{-}} \FunctionTok{get.variables}\NormalTok{(lp\_model\_dissatisfaction)}
\NormalTok{    assignment\_results[[assignment\_num]] }\OtherTok{\textless{}{-}}\NormalTok{ optimal\_solution\_dissatisfaction}
    
    \CommentTok{\# Update the assigned\_terms\_matrix based on this solution}
    \ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{num\_doctors) \{}
        \ControlFlowTok{for}\NormalTok{ (j }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{num\_terms) \{}
            \ControlFlowTok{if}\NormalTok{ (optimal\_solution\_dissatisfaction[(i }\SpecialCharTok{{-}} \DecValTok{1}\NormalTok{) }\SpecialCharTok{*}\NormalTok{ num\_terms }\SpecialCharTok{+}\NormalTok{ j] }\SpecialCharTok{==} \DecValTok{1}\NormalTok{) \{}
\NormalTok{                assigned\_terms\_matrix[i, j] }\OtherTok{\textless{}{-}} \DecValTok{1}
\NormalTok{            \}}
\NormalTok{        \}}
        \ControlFlowTok{for}\NormalTok{ (specialty\_idx }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(unique\_specialty\_statuses)) \{}
\NormalTok{            specialty }\OtherTok{\textless{}{-}}\NormalTok{ unique\_specialty\_statuses[specialty\_idx]}
\NormalTok{            assigned\_specialties }\OtherTok{\textless{}{-}} \FunctionTok{sum}\NormalTok{(optimal\_solution\_dissatisfaction[(i }\SpecialCharTok{{-}} \DecValTok{1}\NormalTok{) }\SpecialCharTok{*}\NormalTok{ num\_terms }\SpecialCharTok{+} \FunctionTok{which}\NormalTok{(specialty\_status\_per\_term }\SpecialCharTok{==}\NormalTok{ specialty)])}
\NormalTok{            specialty\_assignment\_tracker[i, specialty\_idx] }\OtherTok{\textless{}{-}}\NormalTok{ specialty\_assignment\_tracker[i, specialty\_idx] }\SpecialCharTok{+}\NormalTok{ assigned\_specialties}
\NormalTok{        \}}
        \ControlFlowTok{for}\NormalTok{ (subspecialty\_idx }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(unique\_subspecialty\_statuses)) \{}
\NormalTok{            subspecialty }\OtherTok{\textless{}{-}}\NormalTok{ unique\_subspecialty\_statuses[subspecialty\_idx]}
            \ControlFlowTok{if}\NormalTok{ (subspecialty }\SpecialCharTok{!=} \StringTok{"NA"}\NormalTok{) \{  }\CommentTok{\# Exclude NA values}
\NormalTok{                assigned\_subspecialties }\OtherTok{\textless{}{-}} \FunctionTok{sum}\NormalTok{(optimal\_solution\_dissatisfaction[(i }\SpecialCharTok{{-}} \DecValTok{1}\NormalTok{) }\SpecialCharTok{*}\NormalTok{ num\_terms }\SpecialCharTok{+} \FunctionTok{which}\NormalTok{(sub\_specialty\_status\_per\_term }\SpecialCharTok{==}\NormalTok{ subspecialty)])}
\NormalTok{                subspecialty\_assignment\_tracker[i, subspecialty\_idx] }\OtherTok{\textless{}{-}}\NormalTok{ subspecialty\_assignment\_tracker[i, subspecialty\_idx] }\SpecialCharTok{+}\NormalTok{ assigned\_subspecialties}
\NormalTok{            \}}
\NormalTok{        \}}
\NormalTok{    \}}
\NormalTok{\} }\ControlFlowTok{else}\NormalTok{ \{}
    \FunctionTok{cat}\NormalTok{(}\StringTok{"LP problem could not be solved for assignment"}\NormalTok{, assignment\_num, }\StringTok{"Result:"}\NormalTok{, lp\_result\_dissatisfaction, }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\NormalTok{  \}}
\NormalTok{\}}

\CommentTok{\# Print the results of each assignment}
\ControlFlowTok{for}\NormalTok{ (assignment\_num }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{num\_assignments) \{}
  \FunctionTok{cat}\NormalTok{(}\StringTok{"Assignment"}\NormalTok{, assignment\_num, }\StringTok{"results:}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\NormalTok{  optimal\_solution\_dissatisfaction }\OtherTok{\textless{}{-}}\NormalTok{ assignment\_results[[assignment\_num]]}
  \ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{num\_doctors) \{}
    \ControlFlowTok{for}\NormalTok{ (j }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{num\_terms) \{}
      \ControlFlowTok{if}\NormalTok{ (optimal\_solution\_dissatisfaction[(i }\SpecialCharTok{{-}} \DecValTok{1}\NormalTok{) }\SpecialCharTok{*}\NormalTok{ num\_terms }\SpecialCharTok{+}\NormalTok{ j] }\SpecialCharTok{==} \DecValTok{1}\NormalTok{) \{}
\NormalTok{        doctor\_name }\OtherTok{\textless{}{-}}\NormalTok{ row\_names[i]}
\NormalTok{        term\_name }\OtherTok{\textless{}{-}}\NormalTok{ column\_names[j]}
        \FunctionTok{cat}\NormalTok{(}\StringTok{"Doctor"}\NormalTok{, doctor\_name, }\StringTok{"is assigned to Term"}\NormalTok{, term\_name, }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\NormalTok{      \}}
\NormalTok{    \}}
\NormalTok{  \}}
  \FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\NormalTok{\}}
\CommentTok{\# Initialize a data frame to store the results}
\NormalTok{assignment\_table }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{Doctor =}\NormalTok{ row\_names, }
                               \AttributeTok{Assignment1 =} \FunctionTok{character}\NormalTok{(num\_doctors), }
                               \AttributeTok{Assignment2 =} \FunctionTok{character}\NormalTok{(num\_doctors),}
                               \AttributeTok{Assignment3 =} \FunctionTok{character}\NormalTok{(num\_doctors),}
                               \AttributeTok{Assignment4 =} \FunctionTok{character}\NormalTok{(num\_doctors),}
                               \AttributeTok{Assignment5 =} \FunctionTok{character}\NormalTok{(num\_doctors),}
                               \AttributeTok{stringsAsFactors =} \ConstantTok{FALSE}\NormalTok{)}

\CommentTok{\# Populate the data frame with the assignment results}
\ControlFlowTok{for}\NormalTok{ (assignment\_num }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{num\_assignments) \{}
\NormalTok{  optimal\_solution\_dissatisfaction }\OtherTok{\textless{}{-}}\NormalTok{ assignment\_results[[assignment\_num]]}
  \ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{num\_doctors) \{}
    \ControlFlowTok{for}\NormalTok{ (j }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{num\_terms) \{}
      \ControlFlowTok{if}\NormalTok{ (optimal\_solution\_dissatisfaction[(i }\SpecialCharTok{{-}} \DecValTok{1}\NormalTok{) }\SpecialCharTok{*}\NormalTok{ num\_terms }\SpecialCharTok{+}\NormalTok{ j] }\SpecialCharTok{==} \DecValTok{1}\NormalTok{) \{}
\NormalTok{        term\_name }\OtherTok{\textless{}{-}}\NormalTok{ column\_names[j]}
\NormalTok{        assignment\_column }\OtherTok{\textless{}{-}} \FunctionTok{paste0}\NormalTok{(}\StringTok{"Assignment"}\NormalTok{, assignment\_num)}
\NormalTok{        assignment\_table[i, assignment\_column] }\OtherTok{\textless{}{-}}\NormalTok{ term\_name}
\NormalTok{      \}}
\NormalTok{    \}}
\NormalTok{  \}}
\NormalTok{\}}


\CommentTok{\# Print the table using gt}
\FunctionTok{gt}\NormalTok{(assignment\_table)}
\end{Highlighting}
\end{Shaded}

\hypertarget{pgy1-unassigned-terms-data-frame-and-terms-list}{%
\section{PGY1 Unassigned terms Data Frame and Terms
List}\label{pgy1-unassigned-terms-data-frame-and-terms-list}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Initialize a data frame to store the unassigned slots for each term}
\NormalTok{unassigned\_terms\_table }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{Term =}\NormalTok{ column\_names, }
                                     \AttributeTok{Assignment1 =} \FunctionTok{integer}\NormalTok{(}\FunctionTok{length}\NormalTok{(column\_names)), }
                                     \AttributeTok{Assignment2 =} \FunctionTok{integer}\NormalTok{(}\FunctionTok{length}\NormalTok{(column\_names)),}
                                     \AttributeTok{Assignment3 =} \FunctionTok{integer}\NormalTok{(}\FunctionTok{length}\NormalTok{(column\_names)),}
                                     \AttributeTok{Assignment4 =} \FunctionTok{integer}\NormalTok{(}\FunctionTok{length}\NormalTok{(column\_names)),}
                                     \AttributeTok{Assignment5 =} \FunctionTok{integer}\NormalTok{(}\FunctionTok{length}\NormalTok{(column\_names)),}
                                     \AttributeTok{stringsAsFactors =} \ConstantTok{FALSE}\NormalTok{)}

\CommentTok{\# Helper function to get total assignments for a term for a given assignment number}
\NormalTok{get\_total\_assignments\_for\_term }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(term\_index, assignment\_num) \{}
\NormalTok{  optimal\_solution\_dissatisfaction }\OtherTok{\textless{}{-}}\NormalTok{ assignment\_results[[assignment\_num]]}
  \FunctionTok{return}\NormalTok{(}\FunctionTok{sum}\NormalTok{(optimal\_solution\_dissatisfaction[}\FunctionTok{seq}\NormalTok{(term\_index, num\_doctors }\SpecialCharTok{*}\NormalTok{ num\_terms, }\AttributeTok{by =}\NormalTok{ num\_terms)]))}
\NormalTok{\}}

\CommentTok{\# Compute the unassigned slots for each term and assignment}
\ControlFlowTok{for}\NormalTok{ (term\_index }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(column\_names)) \{}
  \ControlFlowTok{for}\NormalTok{ (assignment\_num }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{num\_assignments) \{}
\NormalTok{    max\_doctors\_for\_this\_term }\OtherTok{\textless{}{-}} \FunctionTok{get\_max\_doctors\_for\_term}\NormalTok{(assignment\_num)}
\NormalTok{    total\_assignments }\OtherTok{\textless{}{-}} \FunctionTok{get\_total\_assignments\_for\_term}\NormalTok{(term\_index, assignment\_num)}
    
\NormalTok{    unassigned\_slots }\OtherTok{\textless{}{-}}\NormalTok{ max\_doctors\_for\_this\_term[term\_index] }\SpecialCharTok{{-}}\NormalTok{ total\_assignments}
    
\NormalTok{    assignment\_column }\OtherTok{\textless{}{-}} \FunctionTok{paste0}\NormalTok{(}\StringTok{"Assignment"}\NormalTok{, assignment\_num)}
\NormalTok{    unassigned\_terms\_table[term\_index, assignment\_column] }\OtherTok{\textless{}{-}}\NormalTok{ unassigned\_slots}
\NormalTok{  \}}
\NormalTok{\}}

\CommentTok{\# View the unassigned\_terms\_table}
\FunctionTok{gt}\NormalTok{(unassigned\_terms\_table)}
\end{Highlighting}
\end{Shaded}

\begin{longtable}{lrrrrr}
\toprule
Term & Assignment1 & Assignment2 & Assignment3 & Assignment4 & Assignment5 \\ 
\midrule\addlinespace[2.5pt]
BDH Acute General Medicine \& Cardiology (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
BDH Acute General Medicine \& Rehabilitation (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
BDH Acute General Medicine (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
BDH Drug and Alcohol Clinical Services (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
BDH Emergency (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
BDH Sub-Acute General Medicine (Team 5) (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
BDH Surgery (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
CMN Emergency (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
CMN General Medicine (PGY1/2) & 0 & 0 & 0 & 0 & 1 \\ 
CMN Medicine - Cardiology (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
CMN Medicine - Gastroenterology with Drug \& Alcohol (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
CMN Medicine - Haematology (01) (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
CMN Medicine - Medical Oncology (01) (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
CMN Palliative Care (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
CMN Surgery (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
HNE Mental Health \& Substance Use Service - Mater Hospital (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
HNE Mental Health Lake Macquarie Ward - Mater hospital (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
HNE Mental Health Newcastle Inpatient Unit - Mater Hospital (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
HNE Mental Health Older People's Service - Mater Hospital (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
JHH Acute General Surgery Unit (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
JHH Emergency (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
JHH General Medicine (PGY1/2) & 0 & 0 & 0 & 0 & 4 \\ 
JHH General Surgery / Colorectal (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
JHH General Surgery / Hepatopancreatobiliary and Upper GI Surgery (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
JHH General Surgery / Trauma (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
JHH General Surgery / Upper GI (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
JHH Medicine - Cardiology (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
JHH Medicine - Dermatology (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
JHH Medicine - Gastroenterology (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
JHH Medicine - Infectious Disease (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
JHH Medicine - MACU (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
JHH Medicine - Nephrology \& Dialysis (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
JHH Medicine - Neurology (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
JHH Medicine - Rehabilitation (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
JHH Medicine - Respiratory (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
JHH Medicine - Rheumatology (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
JHH Obstetrics \& Gynaecology (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
JHH Surgery - Cardiothoracic Surgery (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
JHH Surgery - Ear, Nose and Throat (ENT) (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
JHH Surgery - Neurosurgery (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
JHH Surgery - Oral Maxillofacial (OMF) (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
JHH Surgery - Orthopaedics (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
JHH Surgery - Orthopaedics (Team 6) (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
JHH Surgery - Urology (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
JHH Surgery - Vascular (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
MBH Emergency (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
MH  Medicine - Cardiology (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
MH Emergency (PGY1/2) & 2 & 2 & 2 & 3 & 0 \\ 
MH General Medicine (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
MH General Surgery (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
MH KK Rehabilitation (PGY 1/2) & 0 & 0 & 0 & 0 & 0 \\ 
TRRH Surgery C (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
TRRH Surgery - Orthopaedics 02 (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
TRRH General Medicine 08 (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
BDH After Hours Internal Relief (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
CMN Relief (PGY1/2) & 1 & 0 & 4 & 1 & 2 \\ 
HNE Relief (PGY1/2) & 6 & 8 & 3 & 8 & 5 \\ 
JHH Medicine Relief (PGY1/2) & 0 & 3 & 1 & 0 & 0 \\ 
JHH Surgery Relief (PGY1/2) & 0 & 0 & 0 & 0 & 0 \\ 
\bottomrule
\end{longtable}

\begin{Shaded}
\begin{Highlighting}[]
                                            \CommentTok{\# Generate this data frame as a term list}

\CommentTok{\# Initialize a new dataframe for unassigned terms}
\CommentTok{\# Drop the first column for calculation purposes}
\NormalTok{numeric\_unassigned\_terms }\OtherTok{\textless{}{-}}\NormalTok{ unassigned\_terms\_table[,}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{]}

\CommentTok{\# Compute the maximum unassigned terms across all assignments}
\NormalTok{max\_unassigned }\OtherTok{\textless{}{-}} \FunctionTok{max}\NormalTok{(}\FunctionTok{as.matrix}\NormalTok{(numeric\_unassigned\_terms))}

\CommentTok{\# Create a list to store term repetitions for each assignment}
\NormalTok{unassigned\_list }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{()}

\ControlFlowTok{for}\NormalTok{ (assignment\_num }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{num\_assignments) \{}
\NormalTok{  assignment\_column }\OtherTok{\textless{}{-}} \FunctionTok{paste0}\NormalTok{(}\StringTok{"Assignment"}\NormalTok{, assignment\_num)}
\NormalTok{  terms\_rep }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(unassigned\_terms\_table}\SpecialCharTok{$}\NormalTok{Term, numeric\_unassigned\_terms[[assignment\_column]])}
\NormalTok{  unassigned\_list[[assignment\_num]] }\OtherTok{\textless{}{-}}\NormalTok{ terms\_rep}
\NormalTok{\}}

\CommentTok{\# Make all lists the same length by padding with NA}
\NormalTok{max\_length }\OtherTok{\textless{}{-}} \FunctionTok{max}\NormalTok{(}\FunctionTok{sapply}\NormalTok{(unassigned\_list, length))}
\NormalTok{unassigned\_list }\OtherTok{\textless{}{-}} \FunctionTok{lapply}\NormalTok{(unassigned\_list, }\ControlFlowTok{function}\NormalTok{(x) \{}
  \FunctionTok{c}\NormalTok{(x, }\FunctionTok{rep}\NormalTok{(}\ConstantTok{NA}\NormalTok{, max\_length }\SpecialCharTok{{-}} \FunctionTok{length}\NormalTok{(x)))}
\NormalTok{\})}

\CommentTok{\# Convert the list to dataframe}
\NormalTok{unassigned\_df }\OtherTok{\textless{}{-}} \FunctionTok{as.data.frame}\NormalTok{(unassigned\_list)}
\FunctionTok{names}\NormalTok{(unassigned\_df) }\OtherTok{\textless{}{-}} \FunctionTok{paste0}\NormalTok{(}\StringTok{"Term"}\NormalTok{, }\DecValTok{1}\SpecialCharTok{:}\NormalTok{num\_assignments)}

\CommentTok{\# View the dataframe}
\FunctionTok{gt}\NormalTok{(unassigned\_df)}
\end{Highlighting}
\end{Shaded}

\begin{longtable}{lllll}
\toprule
Term1 & Term2 & Term3 & Term4 & Term5 \\ 
\midrule\addlinespace[2.5pt]
MH Emergency (PGY1/2) & MH Emergency (PGY1/2) & MH Emergency (PGY1/2) & MH Emergency (PGY1/2) & CMN General Medicine (PGY1/2) \\ 
MH Emergency (PGY1/2) & MH Emergency (PGY1/2) & MH Emergency (PGY1/2) & MH Emergency (PGY1/2) & JHH General Medicine (PGY1/2) \\ 
CMN Relief (PGY1/2) & HNE Relief (PGY1/2) & CMN Relief (PGY1/2) & MH Emergency (PGY1/2) & JHH General Medicine (PGY1/2) \\ 
HNE Relief (PGY1/2) & HNE Relief (PGY1/2) & CMN Relief (PGY1/2) & CMN Relief (PGY1/2) & JHH General Medicine (PGY1/2) \\ 
HNE Relief (PGY1/2) & HNE Relief (PGY1/2) & CMN Relief (PGY1/2) & HNE Relief (PGY1/2) & JHH General Medicine (PGY1/2) \\ 
HNE Relief (PGY1/2) & HNE Relief (PGY1/2) & CMN Relief (PGY1/2) & HNE Relief (PGY1/2) & CMN Relief (PGY1/2) \\ 
HNE Relief (PGY1/2) & HNE Relief (PGY1/2) & HNE Relief (PGY1/2) & HNE Relief (PGY1/2) & CMN Relief (PGY1/2) \\ 
HNE Relief (PGY1/2) & HNE Relief (PGY1/2) & HNE Relief (PGY1/2) & HNE Relief (PGY1/2) & HNE Relief (PGY1/2) \\ 
HNE Relief (PGY1/2) & HNE Relief (PGY1/2) & HNE Relief (PGY1/2) & HNE Relief (PGY1/2) & HNE Relief (PGY1/2) \\ 
NA & HNE Relief (PGY1/2) & JHH Medicine Relief (PGY1/2) & HNE Relief (PGY1/2) & HNE Relief (PGY1/2) \\ 
NA & JHH Medicine Relief (PGY1/2) & NA & HNE Relief (PGY1/2) & HNE Relief (PGY1/2) \\ 
NA & JHH Medicine Relief (PGY1/2) & NA & HNE Relief (PGY1/2) & HNE Relief (PGY1/2) \\ 
NA & JHH Medicine Relief (PGY1/2) & NA & NA & NA \\ 
\bottomrule
\end{longtable}

\hypertarget{reporting--}{%
\section{Reporting -}\label{reporting--}}

\hypertarget{to-add-transparancy-to-allocations-process-and-to-assist-in-manual-auditing-of-lines-in-order-to-preserve-the-integrity-of-the-preferences-of-the-cohort.-assist-with-manual-changes-to-make-terms-heti-compliant-or-understand-gaps-in-the-event-their-is-nil-viable-solution-to-whole-gamut-of-constraints.}{%
\subsubsection{To add transparancy to allocations process and to assist
in manual auditing of lines in order to preserve the integrity of the
preferences of the cohort. Assist with manual changes to make terms HETI
compliant or understand GAPS in the event their is nil viable solution
to whole gamut of
constraints.}\label{to-add-transparancy-to-allocations-process-and-to-assist-in-manual-auditing-of-lines-in-order-to-preserve-the-integrity-of-the-preferences-of-the-cohort.-assist-with-manual-changes-to-make-terms-heti-compliant-or-understand-gaps-in-the-event-their-is-nil-viable-solution-to-whole-gamut-of-constraints.}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 1. Doctors Preference Report}

\CommentTok{\# Initialize an empty data frame to store the report}
\NormalTok{doctor\_preference\_report }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
  \AttributeTok{Doctor =} \FunctionTok{character}\NormalTok{(),}
  \AttributeTok{Term =} \FunctionTok{character}\NormalTok{(),}
  \AttributeTok{Preference\_Score =} \FunctionTok{numeric}\NormalTok{(),}
  \AttributeTok{stringsAsFactors =} \ConstantTok{FALSE}
\NormalTok{)}

\CommentTok{\# Iterate through each doctor}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{num\_doctors) \{}
\NormalTok{  doctor\_name }\OtherTok{\textless{}{-}}\NormalTok{ row\_names[i]}
  
  \CommentTok{\# Iterate through each of the assignments to extract the allocated terms for each doctor}
  \ControlFlowTok{for}\NormalTok{ (assignment\_num }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{num\_assignments) \{}
\NormalTok{    optimal\_solution\_dissatisfaction }\OtherTok{\textless{}{-}}\NormalTok{ assignment\_results[[assignment\_num]]}
    \ControlFlowTok{for}\NormalTok{ (j }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{num\_terms) \{}
      \ControlFlowTok{if}\NormalTok{ (optimal\_solution\_dissatisfaction[(i }\SpecialCharTok{{-}} \DecValTok{1}\NormalTok{) }\SpecialCharTok{*}\NormalTok{ num\_terms }\SpecialCharTok{+}\NormalTok{ j] }\SpecialCharTok{==} \DecValTok{1}\NormalTok{) \{}
\NormalTok{        assigned\_term }\OtherTok{\textless{}{-}}\NormalTok{ column\_names[j]}
        
        \CommentTok{\# Access the doctor\textquotesingle{}s preference row from the preference matrix}
\NormalTok{        doctor\_preference }\OtherTok{\textless{}{-}}\NormalTok{ preference\_matrix[i, ]}
        
        \CommentTok{\# Calculate preference score for the assigned term}
\NormalTok{        preference\_score }\OtherTok{\textless{}{-}}\NormalTok{ doctor\_preference[}\FunctionTok{match}\NormalTok{(assigned\_term, column\_names)]}
        
        \CommentTok{\# Build a data frame with the results for this doctor and term}
\NormalTok{        doctor\_report }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
          \AttributeTok{Doctor =} \FunctionTok{rep}\NormalTok{(doctor\_name, }\DecValTok{1}\NormalTok{),}
          \AttributeTok{Term =}\NormalTok{ assigned\_term,}
          \AttributeTok{Preference\_Score =}\NormalTok{ preference\_score}
\NormalTok{        )}
        
        \CommentTok{\# Append the doctor\textquotesingle{}s report to the overall report data frame}
\NormalTok{        doctor\_preference\_report }\OtherTok{\textless{}{-}} \FunctionTok{rbind}\NormalTok{(doctor\_preference\_report, doctor\_report)}
\NormalTok{      \}}
\NormalTok{    \}}
\NormalTok{  \}}
\NormalTok{\}}


\FunctionTok{gt}\NormalTok{(doctor\_preference\_report)}
\end{Highlighting}
\end{Shaded}

\begin{longtable}{llr}
\toprule
Doctor & Term & Preference\_Score \\ 
\midrule\addlinespace[2.5pt]
Anjum, Asad & CMN Relief (PGY1/2) & 59 \\ 
Anjum, Asad & JHH Surgery - Orthopaedics (PGY1/2) & 41 \\ 
Anjum, Asad & JHH Emergency (PGY1/2) & 2 \\ 
Anjum, Asad & MH General Surgery (PGY1/2) & 51 \\ 
Anjum, Asad & TRRH General Medicine 08 (PGY1/2) & 1 \\ 
Arnold, Jessica & BDH Acute General Medicine \& Cardiology (PGY1/2) & 3 \\ 
Arnold, Jessica & JHH Emergency (PGY1/2) & 5 \\ 
Arnold, Jessica & MH  Medicine - Cardiology (PGY1/2) & 4 \\ 
Arnold, Jessica & HNE Relief (PGY1/2) & 47 \\ 
Arnold, Jessica & BDH Surgery (PGY1/2) & 37 \\ 
Barrett, Jordan & BDH After Hours Internal Relief (PGY1/2) & 55 \\ 
Barrett, Jordan & CMN Emergency (PGY1/2) & 11 \\ 
Barrett, Jordan & JHH Surgery - Vascular (PGY1/2) & 3 \\ 
Barrett, Jordan & JHH General Medicine (PGY1/2) & 25 \\ 
Barrett, Jordan & JHH Surgery - Urology (PGY1/2) & 5 \\ 
Bazley, Stephanie & JHH General Surgery / Trauma (PGY1/2) & 1 \\ 
Bazley, Stephanie & JHH Surgery - Neurosurgery (PGY1/2) & 3 \\ 
Bazley, Stephanie & MH General Medicine (PGY1/2) & 48 \\ 
Bazley, Stephanie & JHH Emergency (PGY1/2) & 4 \\ 
Bazley, Stephanie & HNE Relief (PGY1/2) & 57 \\ 
Benjamin, Redgen & JHH Medicine Relief (PGY1/2) & 50 \\ 
Benjamin, Redgen & HNE Mental Health Lake Macquarie Ward - Mater hospital (PGY1/2) & 2 \\ 
Benjamin, Redgen & MH KK Rehabilitation (PGY 1/2) & 47 \\ 
Benjamin, Redgen & HNE Mental Health Older People's Service - Mater Hospital (PGY1/2) & 4 \\ 
Benjamin, Redgen & MH Emergency (PGY1/2) & 54 \\ 
Bennett, Samantha & JHH Medicine Relief (PGY1/2) & 8 \\ 
Bennett, Samantha & BDH Surgery (PGY1/2) & 33 \\ 
Bennett, Samantha & JHH Surgery - Urology (PGY1/2) & 3 \\ 
Bennett, Samantha & MH KK Rehabilitation (PGY 1/2) & 51 \\ 
Bennett, Samantha & CMN Medicine - Medical Oncology (01) (PGY1/2) & 5 \\ 
Bowden, Mia & JHH Acute General Surgery Unit (PGY1/2) & 3 \\ 
Bowden, Mia & JHH Surgery - Neurosurgery (PGY1/2) & 5 \\ 
Bowden, Mia & BDH After Hours Internal Relief (PGY1/2) & 47 \\ 
Bowden, Mia & JHH Surgery - Cardiothoracic Surgery (PGY1/2) & 4 \\ 
Bowden, Mia & MH Emergency (PGY1/2) & 26 \\ 
Brieva, Lautaro & MH General Medicine (PGY1/2) & 47 \\ 
Brieva, Lautaro & HNE Relief (PGY1/2) & 55 \\ 
Brieva, Lautaro & JHH Surgery - Orthopaedics (PGY1/2) & 28 \\ 
Brieva, Lautaro & JHH Medicine - Gastroenterology (PGY1/2) & 3 \\ 
Brieva, Lautaro & JHH Emergency (PGY1/2) & 4 \\ 
Brigden, Kurt & HNE Relief (PGY1/2) & 49 \\ 
Brigden, Kurt & TRRH Surgery - Orthopaedics 02 (PGY1/2) & 5 \\ 
Brigden, Kurt & TRRH Surgery C (PGY1/2) & 4 \\ 
Brigden, Kurt & JHH Acute General Surgery Unit (PGY1/2) & 2 \\ 
Brigden, Kurt & JHH Surgery - Orthopaedics (PGY1/2) & 32 \\ 
Clare, Grace & JHH Surgery Relief (PGY1/2) & 54 \\ 
Clare, Grace & JHH Surgery - Orthopaedics (PGY1/2) & 42 \\ 
Clare, Grace & TRRH Surgery - Orthopaedics 02 (PGY1/2) & 57 \\ 
Clare, Grace & JHH Emergency (PGY1/2) & 3 \\ 
Clare, Grace & HNE Mental Health Lake Macquarie Ward - Mater hospital (PGY1/2) & 1 \\ 
Clark, Lachlan & JHH Medicine - Nephrology \& Dialysis (PGY1/2) & 4 \\ 
Clark, Lachlan & JHH Surgery - Orthopaedics (PGY1/2) & 48 \\ 
Clark, Lachlan & CMN Medicine - Haematology (01) (PGY1/2) & 5 \\ 
Clark, Lachlan & CMN Emergency (PGY1/2) & 38 \\ 
Clark, Lachlan & CMN Surgery (PGY1/2) & 41 \\ 
Coyle, William & MH General Medicine (PGY1/2) & 23 \\ 
Coyle, William & CMN General Medicine (PGY1/2) & 21 \\ 
Coyle, William & HNE Relief (PGY1/2) & 58 \\ 
Coyle, William & TRRH Surgery C (PGY1/2) & 48 \\ 
Coyle, William & JHH Emergency (PGY1/2) & 1 \\ 
Craig, Graham & MH General Surgery (PGY1/2) & 51 \\ 
Craig, Graham & BDH Emergency (PGY1/2) & 3 \\ 
Craig, Graham & TRRH General Medicine 08 (PGY1/2) & 1 \\ 
Craig, Graham & JHH Emergency (PGY1/2) & 4 \\ 
Craig, Graham & JHH Medicine - Respiratory (PGY1/2) & 5 \\ 
Crawford, Matthew Crawford & HNE Relief (PGY1/2) & 56 \\ 
Crawford, Matthew Crawford & TRRH General Medicine 08 (PGY1/2) & 5 \\ 
Crawford, Matthew Crawford & HNE Mental Health \& Substance Use Service - Mater Hospital (PGY1/2) & 4 \\ 
Crawford, Matthew Crawford & JHH Emergency (PGY1/2) & 3 \\ 
Crawford, Matthew Crawford & JHH Surgery - Orthopaedics (PGY1/2) & 31 \\ 
Cubby, Kieran & JHH Surgery - Orthopaedics (PGY1/2) & 2 \\ 
Cubby, Kieran & JHH General Medicine (PGY1/2) & 1 \\ 
Cubby, Kieran & HNE Relief (PGY1/2) & 59 \\ 
Cubby, Kieran & JHH Medicine - Cardiology (PGY1/2) & 4 \\ 
Cubby, Kieran & JHH Emergency (PGY1/2) & 3 \\ 
Dixon, Monique & BDH After Hours Internal Relief (PGY1/2) & 46 \\ 
Dixon, Monique & MH General Surgery (PGY1/2) & 52 \\ 
Dixon, Monique & JHH General Medicine (PGY1/2) & 41 \\ 
Dixon, Monique & CMN Medicine - Medical Oncology (01) (PGY1/2) & 5 \\ 
Dixon, Monique & JHH Emergency (PGY1/2) & 1 \\ 
Doherty, Ailish & MH Emergency (PGY1/2) & 2 \\ 
Doherty, Ailish & MH General Medicine (PGY1/2) & 4 \\ 
Doherty, Ailish & JHH General Medicine (PGY1/2) & 5 \\ 
Doherty, Ailish & CMN Emergency (PGY1/2) & 3 \\ 
Doherty, Ailish & BDH After Hours Internal Relief (PGY1/2) & 59 \\ 
Douglas, Chloe & JHH Acute General Surgery Unit (PGY1/2) & 5 \\ 
Douglas, Chloe & JHH Medicine - Nephrology \& Dialysis (PGY1/2) & 4 \\ 
Douglas, Chloe & JHH Surgery - Orthopaedics (PGY1/2) & 47 \\ 
Douglas, Chloe & JHH Obstetrics \& Gynaecology (PGY1/2) & 1 \\ 
Douglas, Chloe & JHH Surgery Relief (PGY1/2) & 58 \\ 
Duggan, Georgia & JHH Surgery - Cardiothoracic Surgery (PGY1/2) & 2 \\ 
Duggan, Georgia & JHH Emergency (PGY1/2) & 3 \\ 
Duggan, Georgia & CMN Emergency (PGY1/2) & 33 \\ 
Duggan, Georgia & JHH General Surgery / Colorectal (PGY1/2) & 5 \\ 
Duggan, Georgia & JHH Surgery - Orthopaedics (PGY1/2) & 19 \\ 
Emily, Ong & JHH General Medicine (PGY1/2) & 3 \\ 
Emily, Ong & CMN General Medicine (PGY1/2) & 37 \\ 
Emily, Ong & BDH After Hours Internal Relief (PGY1/2) & 58 \\ 
Emily, Ong & JHH Surgery - Orthopaedics (PGY1/2) & 6 \\ 
Emily, Ong & JHH General Surgery / Trauma (PGY1/2) & 5 \\ 
Garvey, Matthew & JHH Emergency (PGY1/2) & 4 \\ 
Garvey, Matthew & MBH Emergency (PGY1/2) & 1 \\ 
Garvey, Matthew & HNE Relief (PGY1/2) & 59 \\ 
Garvey, Matthew & JHH General Medicine (PGY1/2) & 6 \\ 
Garvey, Matthew & HNE Mental Health Newcastle Inpatient Unit - Mater Hospital (PGY1/2) & 2 \\ 
Glover, Izabella & MH Emergency (PGY1/2) & 42 \\ 
Glover, Izabella & CMN Relief (PGY1/2) & 55 \\ 
Glover, Izabella & JHH Surgery - Orthopaedics (PGY1/2) & 17 \\ 
Glover, Izabella & MH General Surgery (PGY1/2) & 43 \\ 
Glover, Izabella & BDH Emergency (PGY1/2) & 49 \\ 
Gomersall, James & CMN Relief (PGY1/2) & 57 \\ 
Gomersall, James & MH KK Rehabilitation (PGY 1/2) & 47 \\ 
Gomersall, James & JHH Surgery - Vascular (PGY1/2) & 4 \\ 
Gomersall, James & JHH Surgery - Neurosurgery (PGY1/2) & 3 \\ 
Gomersall, James & JHH Medicine - Cardiology (PGY1/2) & 5 \\ 
Greentree, Bethany & JHH Medicine - Infectious Disease (PGY1/2) & 2 \\ 
Greentree, Bethany & MH General Surgery (PGY1/2) & 34 \\ 
Greentree, Bethany & CMN Emergency (PGY1/2) & 25 \\ 
Greentree, Bethany & CMN Palliative Care (PGY1/2) & 5 \\ 
Greentree, Bethany & JHH Acute General Surgery Unit (PGY1/2) & 46 \\ 
Grima, Zachary & JHH Medicine - Rehabilitation (PGY1/2) & 3 \\ 
Grima, Zachary & BDH After Hours Internal Relief (PGY1/2) & 53 \\ 
Grima, Zachary & CMN General Medicine (PGY1/2) & 22 \\ 
Grima, Zachary & JHH General Medicine (PGY1/2) & 24 \\ 
Grima, Zachary & MH General Surgery (PGY1/2) & 49 \\ 
Hamid, Sarah Tufailah Binte & MH Emergency (PGY1/2) & 4 \\ 
Hamid, Sarah Tufailah Binte & JHH Medicine - Rehabilitation (PGY1/2) & 3 \\ 
Hamid, Sarah Tufailah Binte & CMN General Medicine (PGY1/2) & 5 \\ 
Hamid, Sarah Tufailah Binte & JHH Surgery - Orthopaedics (PGY1/2) & 22 \\ 
Hamid, Sarah Tufailah Binte & JHH Medicine - Cardiology (PGY1/2) & 1 \\ 
Hatoum, Amira & HNE Mental Health \& Substance Use Service - Mater Hospital (PGY1/2) & 5 \\ 
Hatoum, Amira & HNE Mental Health Newcastle Inpatient Unit - Mater Hospital (PGY1/2) & 4 \\ 
Hatoum, Amira & BDH Surgery (PGY1/2) & 49 \\ 
Hatoum, Amira & MH General Medicine (PGY1/2) & 42 \\ 
Hatoum, Amira & JHH Acute General Surgery Unit (PGY1/2) & 39 \\ 
Higgins, Jack & JHH Emergency (PGY1/2) & 4 \\ 
Higgins, Jack & JHH General Medicine (PGY1/2) & 5 \\ 
Higgins, Jack & JHH Surgery - Neurosurgery (PGY1/2) & 2 \\ 
Higgins, Jack & CMN Emergency (PGY1/2) & 19 \\ 
Higgins, Jack & BDH Acute General Medicine \& Cardiology (PGY1/2) & 15 \\ 
Horn, Anthea & CMN General Medicine (PGY1/2) & 1 \\ 
Horn, Anthea & CMN Emergency (PGY1/2) & 2 \\ 
Horn, Anthea & JHH Medicine Relief (PGY1/2) & 52 \\ 
Horn, Anthea & HNE Mental Health \& Substance Use Service - Mater Hospital (PGY1/2) & 5 \\ 
Horn, Anthea & MH General Medicine (PGY1/2) & 49 \\ 
Horne, Jennifer & JHH Surgery - Neurosurgery (PGY1/2) & 3 \\ 
Horne, Jennifer & JHH Emergency (PGY1/2) & 1 \\ 
Horne, Jennifer & JHH General Surgery / Trauma (PGY1/2) & 2 \\ 
Horne, Jennifer & JHH Surgery - Orthopaedics (PGY1/2) & 15 \\ 
Horne, Jennifer & CMN General Medicine (PGY1/2) & 32 \\ 
House, Colin & JHH Surgery - Orthopaedics (PGY1/2) & 1 \\ 
House, Colin & CMN General Medicine (PGY1/2) & 48 \\ 
House, Colin & JHH Surgery - Orthopaedics (Team 6) (PGY1/2) & 2 \\ 
House, Colin & JHH General Medicine (PGY1/2) & 49 \\ 
House, Colin & JHH Surgery - Urology (PGY1/2) & 5 \\ 
Howdle, Gemma & CMN Medicine - Medical Oncology (01) (PGY1/2) & 4 \\ 
Howdle, Gemma & CMN Medicine - Gastroenterology with Drug \& Alcohol (PGY1/2) & 2 \\ 
Howdle, Gemma & CMN Emergency (PGY1/2) & 10 \\ 
Howdle, Gemma & CMN Relief (PGY1/2) & 46 \\ 
Howdle, Gemma & JHH Surgery - Orthopaedics (PGY1/2) & 43 \\ 
Jaarsma, Emily & JHH Surgery - Orthopaedics (Team 6) (PGY1/2) & 1 \\ 
Jaarsma, Emily & JHH Emergency (PGY1/2) & 4 \\ 
Jaarsma, Emily & MH Emergency (PGY1/2) & 33 \\ 
Jaarsma, Emily & BDH Surgery (PGY1/2) & 45 \\ 
Jaarsma, Emily & CMN General Medicine (PGY1/2) & 39 \\ 
Jan, Asna & CMN Emergency (PGY1/2) & 3 \\ 
Jan, Asna & MH Emergency (PGY1/2) & 44 \\ 
Jan, Asna & JHH Medicine Relief (PGY1/2) & 58 \\ 
Jan, Asna & JHH Medicine - Rheumatology (PGY1/2) & 2 \\ 
Jan, Asna & JHH Surgery - Orthopaedics (PGY1/2) & 23 \\ 
Janczuk, Daniel & MH KK Rehabilitation (PGY 1/2) & 5 \\ 
Janczuk, Daniel & CMN Palliative Care (PGY1/2) & 4 \\ 
Janczuk, Daniel & HNE Relief (PGY1/2) & 56 \\ 
Janczuk, Daniel & BDH Sub-Acute General Medicine (Team 5) (PGY1/2) & 20 \\ 
Janczuk, Daniel & JHH Surgery - Neurosurgery (PGY1/2) & 52 \\ 
Jessica, Boyley & JHH Medicine - Cardiology (PGY1/2) & 3 \\ 
Jessica, Boyley & JHH Medicine - Dermatology (PGY1/2) & 4 \\ 
Jessica, Boyley & JHH Medicine - Nephrology \& Dialysis (PGY1/2) & 5 \\ 
Jessica, Boyley & BDH After Hours Internal Relief (PGY1/2) & 47 \\ 
Jessica, Boyley & JHH Emergency (PGY1/2) & 2 \\ 
Keleher, Elise & CMN Relief (PGY1/2) & 39 \\ 
Keleher, Elise & JHH Surgery - Vascular (PGY1/2) & 4 \\ 
Keleher, Elise & JHH Medicine - Respiratory (PGY1/2) & 3 \\ 
Keleher, Elise & MH General Medicine (PGY1/2) & 52 \\ 
Keleher, Elise & JHH Obstetrics \& Gynaecology (PGY1/2) & 1 \\ 
Khalid, Mariam & HNE Relief (PGY1/2) & 54 \\ 
Khalid, Mariam & JHH Medicine - Respiratory (PGY1/2) & 2 \\ 
Khalid, Mariam & JHH Emergency (PGY1/2) & 3 \\ 
Khalid, Mariam & CMN General Medicine (PGY1/2) & 16 \\ 
Khalid, Mariam & CMN Surgery (PGY1/2) & 47 \\ 
Khanam, Khurshida & CMN Emergency (PGY1/2) & 4 \\ 
Khanam, Khurshida & CMN Surgery (PGY1/2) & 3 \\ 
Khanam, Khurshida & CMN Medicine - Cardiology (PGY1/2) & 1 \\ 
Khanam, Khurshida & MH Emergency (PGY1/2) & 15 \\ 
Khanam, Khurshida & MH General Medicine (PGY1/2) & 30 \\ 
Klasen, Caterina & JHH Medicine - Rehabilitation (PGY1/2) & 2 \\ 
Klasen, Caterina & JHH Surgery - Orthopaedics (PGY1/2) & 3 \\ 
Klasen, Caterina & JHH General Medicine (PGY1/2) & 4 \\ 
Klasen, Caterina & JHH Surgery - Urology (PGY1/2) & 5 \\ 
Klasen, Caterina & JHH Emergency (PGY1/2) & 1 \\ 
Kruszelnicki, Lola & CMN Surgery (PGY1/2) & 5 \\ 
Kruszelnicki, Lola & MH Emergency (PGY1/2) & 6 \\ 
Kruszelnicki, Lola & JHH Medicine - Gastroenterology (PGY1/2) & 3 \\ 
Kruszelnicki, Lola & JHH Emergency (PGY1/2) & 2 \\ 
Kruszelnicki, Lola & JHH Surgery Relief (PGY1/2) & 54 \\ 
Lane, Sarah & BDH Acute General Medicine (PGY1/2) & 2 \\ 
Lane, Sarah & MH General Medicine (PGY1/2) & 37 \\ 
Lane, Sarah & HNE Mental Health Lake Macquarie Ward - Mater hospital (PGY1/2) & 3 \\ 
Lane, Sarah & BDH Drug and Alcohol Clinical Services (PGY1/2) & 4 \\ 
Lane, Sarah & JHH Medicine Relief (PGY1/2) & 56 \\ 
Li, Judy & HNE Mental Health Older People's Service - Mater Hospital (PGY1/2) & 4 \\ 
Li, Judy & HNE Mental Health \& Substance Use Service - Mater Hospital (PGY1/2) & 3 \\ 
Li, Judy & JHH Surgery - Orthopaedics (PGY1/2) & 8 \\ 
Li, Judy & CMN General Medicine (PGY1/2) & 9 \\ 
Li, Judy & HNE Relief (PGY1/2) & 59 \\ 
Li, Lanxin & JHH Medicine - Gastroenterology (PGY1/2) & 3 \\ 
Li, Lanxin & JHH Medicine - Neurology (PGY1/2) & 5 \\ 
Li, Lanxin & HNE Relief (PGY1/2) & 55 \\ 
Li, Lanxin & CMN Surgery (PGY1/2) & 44 \\ 
Li, Lanxin & BDH Emergency (PGY1/2) & 37 \\ 
Ling, Koi Fei & JHH Surgery - Urology (PGY1/2) & 2 \\ 
Ling, Koi Fei & JHH Emergency (PGY1/2) & 1 \\ 
Ling, Koi Fei & CMN General Medicine (PGY1/2) & 34 \\ 
Ling, Koi Fei & HNE Relief (PGY1/2) & 44 \\ 
Ling, Koi Fei & JHH Medicine - Rehabilitation (PGY1/2) & 26 \\ 
Lusted, Lindsay & JHH Medicine - Cardiology (PGY1/2) & 5 \\ 
Lusted, Lindsay & JHH Obstetrics \& Gynaecology (PGY1/2) & 4 \\ 
Lusted, Lindsay & JHH Emergency (PGY1/2) & 1 \\ 
Lusted, Lindsay & JHH Medicine - MACU (PGY1/2) & 3 \\ 
Lusted, Lindsay & MH Emergency (PGY1/2) & 49 \\ 
Lye, Charmaine & JHH Medicine - Respiratory (PGY1/2) & 5 \\ 
Lye, Charmaine & JHH Medicine - Gastroenterology (PGY1/2) & 2 \\ 
Lye, Charmaine & MH General Surgery (PGY1/2) & 41 \\ 
Lye, Charmaine & JHH Emergency (PGY1/2) & 3 \\ 
Lye, Charmaine & CMN Relief (PGY1/2) & 57 \\ 
Maher, Clare & JHH Emergency (PGY1/2) & 5 \\ 
Maher, Clare & JHH Acute General Surgery Unit (PGY1/2) & 2 \\ 
Maher, Clare & CMN General Medicine (PGY1/2) & 32 \\ 
Maher, Clare & JHH Surgery - Ear, Nose and Throat (ENT) (PGY1/2) & 1 \\ 
Maher, Clare & JHH Medicine - Rehabilitation (PGY1/2) & 27 \\ 
McGrath, Joseph & JHH General Medicine (PGY1/2) & 2 \\ 
McGrath, Joseph & JHH Medicine - Cardiology (PGY1/2) & 3 \\ 
McGrath, Joseph & MH Emergency (PGY1/2) & 47 \\ 
McGrath, Joseph & JHH Surgery - Orthopaedics (PGY1/2) & 24 \\ 
McGrath, Joseph & JHH Medicine Relief (PGY1/2) & 56 \\ 
Miller, Codie & BDH Emergency (PGY1/2) & 1 \\ 
Miller, Codie & BDH Drug and Alcohol Clinical Services (PGY1/2) & 5 \\ 
Miller, Codie & HNE Relief (PGY1/2) & 49 \\ 
Miller, Codie & JHH Surgery - Orthopaedics (PGY1/2) & 44 \\ 
Miller, Codie & CMN General Medicine (PGY1/2) & 22 \\ 
Nagaratnam, Manisha & JHH General Surgery / Hepatopancreatobiliary and Upper GI Surgery (PGY1/2) & 1 \\ 
Nagaratnam, Manisha & HNE Relief (PGY1/2) & 54 \\ 
Nagaratnam, Manisha & JHH General Medicine (PGY1/2) & 23 \\ 
Nagaratnam, Manisha & JHH Surgery - Oral Maxillofacial (OMF) (PGY1/2) & 5 \\ 
Nagaratnam, Manisha & JHH Surgery - Cardiothoracic Surgery (PGY1/2) & 2 \\ 
Patterson, Alice & CMN Medicine - Cardiology (PGY1/2) & 3 \\ 
Patterson, Alice & CMN Relief (PGY1/2) & 37 \\ 
Patterson, Alice & MH General Medicine (PGY1/2) & 53 \\ 
Patterson, Alice & HNE Mental Health Newcastle Inpatient Unit - Mater Hospital (PGY1/2) & 4 \\ 
Patterson, Alice & JHH Emergency (PGY1/2) & 2 \\ 
Pierce, Matthew & JHH Emergency (PGY1/2) & 4 \\ 
Pierce, Matthew & JHH Surgery Relief (PGY1/2) & 57 \\ 
Pierce, Matthew & JHH Surgery - Neurosurgery (PGY1/2) & 2 \\ 
Pierce, Matthew & JHH Medicine - Rehabilitation (PGY1/2) & 19 \\ 
Pierce, Matthew & CMN Medicine - Cardiology (PGY1/2) & 5 \\ 
Pitman, Georgia & JHH Medicine - Gastroenterology (PGY1/2) & 4 \\ 
Pitman, Georgia & JHH Surgery - Orthopaedics (PGY1/2) & 10 \\ 
Pitman, Georgia & JHH Medicine - Infectious Disease (PGY1/2) & 3 \\ 
Pitman, Georgia & JHH Surgery - Vascular (PGY1/2) & 36 \\ 
Pitman, Georgia & JHH General Surgery / Hepatopancreatobiliary and Upper GI Surgery (PGY1/2) & 5 \\ 
Power, Jack & JHH Surgery - Neurosurgery (PGY1/2) & 3 \\ 
Power, Jack & JHH General Surgery / Upper GI (PGY1/2) & 4 \\ 
Power, Jack & HNE Relief (PGY1/2) & 42 \\ 
Power, Jack & CMN General Medicine (PGY1/2) & 31 \\ 
Power, Jack & JHH Medicine - Neurology (PGY1/2) & 2 \\ 
Pringle, Jarrad & JHH General Medicine (PGY1/2) & 1 \\ 
Pringle, Jarrad & BDH Acute General Medicine (PGY1/2) & 5 \\ 
Pringle, Jarrad & JHH Emergency (PGY1/2) & 2 \\ 
Pringle, Jarrad & JHH Surgery Relief (PGY1/2) & 51 \\ 
Pringle, Jarrad & MH Emergency (PGY1/2) & 9 \\ 
Qian, Gemma & JHH Surgery - Urology (PGY1/2) & 3 \\ 
Qian, Gemma & JHH General Surgery / Colorectal (PGY1/2) & 2 \\ 
Qian, Gemma & JHH Surgery Relief (PGY1/2) & 48 \\ 
Qian, Gemma & JHH General Surgery / Upper GI (PGY1/2) & 1 \\ 
Qian, Gemma & JHH Medicine - Gastroenterology (PGY1/2) & 17 \\ 
Raeside, Thomas & JHH Medicine - Respiratory (PGY1/2) & 1 \\ 
Raeside, Thomas & MH Emergency (PGY1/2) & 29 \\ 
Raeside, Thomas & JHH Surgery Relief (PGY1/2) & 58 \\ 
Raeside, Thomas & JHH Surgery - Vascular (PGY1/2) & 40 \\ 
Raeside, Thomas & JHH Medicine - Infectious Disease (PGY1/2) & 2 \\ 
Rogers, Samantha & JHH Obstetrics \& Gynaecology (PGY1/2) & 1 \\ 
Rogers, Samantha & CMN Medicine - Medical Oncology (01) (PGY1/2) & 2 \\ 
Rogers, Samantha & JHH Surgery - Orthopaedics (PGY1/2) & 17 \\ 
Rogers, Samantha & JHH Medicine Relief (PGY1/2) & 56 \\ 
Rogers, Samantha & CMN Medicine - Haematology (01) (PGY1/2) & 4 \\ 
Rosee, Patrick & MH General Surgery (PGY1/2) & 43 \\ 
Rosee, Patrick & JHH Surgery - Ear, Nose and Throat (ENT) (PGY1/2) & 2 \\ 
Rosee, Patrick & MBH Emergency (PGY1/2) & 3 \\ 
Rosee, Patrick & CMN Medicine - Gastroenterology with Drug \& Alcohol (PGY1/2) & 4 \\ 
Rosee, Patrick & JHH Emergency (PGY1/2) & 5 \\ 
Rui, Ma & JHH Emergency (PGY1/2) & 3 \\ 
Rui, Ma & CMN Relief (PGY1/2) & 58 \\ 
Rui, Ma & MH General Medicine (PGY1/2) & 49 \\ 
Rui, Ma & JHH Medicine - Neurology (PGY1/2) & 5 \\ 
Rui, Ma & HNE Mental Health Older People's Service - Mater Hospital (PGY1/2) & 45 \\ 
Ryan, Daniel & JHH Medicine Relief (PGY1/2) & 52 \\ 
Ryan, Daniel & JHH Emergency (PGY1/2) & 4 \\ 
Ryan, Daniel & CMN Medicine - Medical Oncology (01) (PGY1/2) & 2 \\ 
Ryan, Daniel & CMN General Medicine (PGY1/2) & 11 \\ 
Ryan, Daniel & CMN Emergency (PGY1/2) & 38 \\ 
Sadler, Amelia & BDH Emergency (PGY1/2) & 3 \\ 
Sadler, Amelia & MH General Medicine (PGY1/2) & 47 \\ 
Sadler, Amelia & JHH General Surgery / Hepatopancreatobiliary and Upper GI Surgery (PGY1/2) & 4 \\ 
Sadler, Amelia & JHH Medicine - Rehabilitation (PGY1/2) & 28 \\ 
Sadler, Amelia & HNE Relief (PGY1/2) & 58 \\ 
Sasa, Otovic & JHH Surgery - Vascular (PGY1/2) & 5 \\ 
Sasa, Otovic & JHH Surgery - Cardiothoracic Surgery (PGY1/2) & 4 \\ 
Sasa, Otovic & JHH Medicine - Cardiology (PGY1/2) & 3 \\ 
Sasa, Otovic & JHH General Surgery / Trauma (PGY1/2) & 2 \\ 
Sasa, Otovic & HNE Relief (PGY1/2) & 57 \\ 
Shepherd, Maya & CMN Surgery (PGY1/2) & 3 \\ 
Shepherd, Maya & BDH Sub-Acute General Medicine (Team 5) (PGY1/2) & 54 \\ 
Shepherd, Maya & BDH Acute General Medicine (PGY1/2) & 52 \\ 
Shepherd, Maya & JHH Surgery Relief (PGY1/2) & 39 \\ 
Shepherd, Maya & JHH Surgery - Orthopaedics (Team 6) (PGY1/2) & 5 \\ 
Simpson, Hannah & BDH Surgery (PGY1/2) & 4 \\ 
Simpson, Hannah & JHH Medicine - MACU (PGY1/2) & 2 \\ 
Simpson, Hannah & BDH Emergency (PGY1/2) & 10 \\ 
Simpson, Hannah & MBH Emergency (PGY1/2) & 1 \\ 
Simpson, Hannah & JHH Surgery - Vascular (PGY1/2) & 5 \\ 
Somers, Bonnie & CMN General Medicine (PGY1/2) & 34 \\ 
Somers, Bonnie & JHH Medicine - Rehabilitation (PGY1/2) & 10 \\ 
Somers, Bonnie & JHH Surgery - Urology (PGY1/2) & 2 \\ 
Somers, Bonnie & HNE Mental Health Lake Macquarie Ward - Mater hospital (PGY1/2) & 5 \\ 
Somers, Bonnie & TRRH Surgery - Orthopaedics 02 (PGY1/2) & 59 \\ 
Stanek, Samuel & CMN General Medicine (PGY1/2) & 1 \\ 
Stanek, Samuel & CMN Medicine - Haematology (01) (PGY1/2) & 2 \\ 
Stanek, Samuel & CMN Surgery (PGY1/2) & 5 \\ 
Stanek, Samuel & JHH Medicine Relief (PGY1/2) & 56 \\ 
Stanek, Samuel & MH KK Rehabilitation (PGY 1/2) & 53 \\ 
Steadman, Ashlee & CMN Emergency (PGY1/2) & 2 \\ 
Steadman, Ashlee & CMN General Medicine (PGY1/2) & 25 \\ 
Steadman, Ashlee & BDH Emergency (PGY1/2) & 3 \\ 
Steadman, Ashlee & JHH Acute General Surgery Unit (PGY1/2) & 5 \\ 
Steadman, Ashlee & BDH After Hours Internal Relief (PGY1/2) & 59 \\ 
Stutchbury, Daniel & JHH Emergency (PGY1/2) & 3 \\ 
Stutchbury, Daniel & CMN Emergency (PGY1/2) & 4 \\ 
Stutchbury, Daniel & JHH Medicine - Rehabilitation (PGY1/2) & 31 \\ 
Stutchbury, Daniel & JHH Surgery - Urology (PGY1/2) & 2 \\ 
Stutchbury, Daniel & HNE Relief (PGY1/2) & 55 \\ 
Swanton, Rosie & JHH Surgery Relief (PGY1/2) & 55 \\ 
Swanton, Rosie & JHH Emergency (PGY1/2) & 1 \\ 
Swanton, Rosie & MH General Surgery (PGY1/2) & 49 \\ 
Swanton, Rosie & BDH Acute General Medicine (PGY1/2) & 29 \\ 
Swanton, Rosie & HNE Mental Health \& Substance Use Service - Mater Hospital (PGY1/2) & 5 \\ 
Tamara, Best & JHH Emergency (PGY1/2) & 5 \\ 
Tamara, Best & JHH Acute General Surgery Unit (PGY1/2) & 4 \\ 
Tamara, Best & JHH Obstetrics \& Gynaecology (PGY1/2) & 1 \\ 
Tamara, Best & CMN Relief (PGY1/2) & 58 \\ 
Tamara, Best & MBH Emergency (PGY1/2) & 51 \\ 
Tang, Rachel & MH General Medicine (PGY1/2) & 4 \\ 
Tang, Rachel & JHH General Medicine (PGY1/2) & 5 \\ 
Tang, Rachel & MH Emergency (PGY1/2) & 2 \\ 
Tang, Rachel & BDH Emergency (PGY1/2) & 3 \\ 
Tang, Rachel & JHH Surgery - Vascular (PGY1/2) & 27 \\ 
Thomas, Stefan & JHH Surgery - Orthopaedics (PGY1/2) & 1 \\ 
Thomas, Stefan & JHH Surgery - Urology (PGY1/2) & 5 \\ 
Thomas, Stefan & JHH Emergency (PGY1/2) & 4 \\ 
Thomas, Stefan & JHH Medicine Relief (PGY1/2) & 50 \\ 
Thomas, Stefan & CMN Emergency (PGY1/2) & 11 \\ 
Tongs, Georgia & CMN Medicine - Haematology (01) (PGY1/2) & 2 \\ 
Tongs, Georgia & JHH Surgery - Oral Maxillofacial (OMF) (PGY1/2) & 3 \\ 
Tongs, Georgia & CMN Surgery (PGY1/2) & 16 \\ 
Tongs, Georgia & MH General Medicine (PGY1/2) & 43 \\ 
Tongs, Georgia & CMN Relief (PGY1/2) & 47 \\ 
Tou, Minnie Ying Yun & JHH General Medicine (PGY1/2) & 4 \\ 
Tou, Minnie Ying Yun & JHH Surgery - Urology (PGY1/2) & 3 \\ 
Tou, Minnie Ying Yun & JHH Emergency (PGY1/2) & 1 \\ 
Tou, Minnie Ying Yun & JHH Surgery - Neurosurgery (PGY1/2) & 14 \\ 
Tou, Minnie Ying Yun & JHH Medicine - Gastroenterology (PGY1/2) & 10 \\ 
Walker, Amy & JHH Medicine - Neurology (PGY1/2) & 1 \\ 
Walker, Amy & JHH Surgery Relief (PGY1/2) & 48 \\ 
Walker, Amy & JHH Medicine - Gastroenterology (PGY1/2) & 5 \\ 
Walker, Amy & BDH Acute General Medicine \& Rehabilitation (PGY1/2) & 37 \\ 
Walker, Amy & MH General Surgery (PGY1/2) & 53 \\ 
Wilson, Samantha & JHH Surgery - Orthopaedics (PGY1/2) & 3 \\ 
Wilson, Samantha & JHH General Medicine (PGY1/2) & 4 \\ 
Wilson, Samantha & JHH Acute General Surgery Unit (PGY1/2) & 5 \\ 
Wilson, Samantha & JHH Emergency (PGY1/2) & 2 \\ 
Wilson, Samantha & MH Emergency (PGY1/2) & 44 \\ 
Woodcock, Lucy & HNE Relief (PGY1/2) & 54 \\ 
Woodcock, Lucy & JHH General Surgery / Trauma (PGY1/2) & 3 \\ 
Woodcock, Lucy & BDH Acute General Medicine \& Cardiology (PGY1/2) & 42 \\ 
Woodcock, Lucy & JHH Medicine - Dermatology (PGY1/2) & 2 \\ 
Woodcock, Lucy & MH  Medicine - Cardiology (PGY1/2) & 37 \\ 
Woods, Andrew & CMN General Medicine (PGY1/2) & 36 \\ 
Woods, Andrew & CMN Surgery (PGY1/2) & 5 \\ 
Woods, Andrew & JHH Acute General Surgery Unit (PGY1/2) & 4 \\ 
Woods, Andrew & MH Emergency (PGY1/2) & 47 \\ 
Woods, Andrew & BDH Acute General Medicine (PGY1/2) & 20 \\ 
Wright, Kirsten & HNE Mental Health Lake Macquarie Ward - Mater hospital (PGY1/2) & 5 \\ 
Wright, Kirsten & JHH Emergency (PGY1/2) & 1 \\ 
Wright, Kirsten & HNE Mental Health Newcastle Inpatient Unit - Mater Hospital (PGY1/2) & 4 \\ 
Wright, Kirsten & CMN Medicine - Haematology (01) (PGY1/2) & 2 \\ 
Wright, Kirsten & JHH Medicine Relief (PGY1/2) & 53 \\ 
Zeng, Jim & HNE Mental Health Newcastle Inpatient Unit - Mater Hospital (PGY1/2) & 5 \\ 
Zeng, Jim & JHH Medicine - Respiratory (PGY1/2) & 1 \\ 
Zeng, Jim & HNE Mental Health Older People's Service - Mater Hospital (PGY1/2) & 3 \\ 
Zeng, Jim & CMN Surgery (PGY1/2) & 33 \\ 
Zeng, Jim & MH General Medicine (PGY1/2) & 43 \\ 
Zubrzycki, Nicolas & MH  Medicine - Cardiology (PGY1/2) & 4 \\ 
Zubrzycki, Nicolas & BDH Acute General Medicine \& Rehabilitation (PGY1/2) & 38 \\ 
Zubrzycki, Nicolas & JHH Emergency (PGY1/2) & 2 \\ 
Zubrzycki, Nicolas & JHH Medicine - Respiratory (PGY1/2) & 5 \\ 
Zubrzycki, Nicolas & JHH Surgery - Neurosurgery (PGY1/2) & 26 \\ 
legge-wilkinson, Hannah & JHH Surgery - Orthopaedics (PGY1/2) & 3 \\ 
legge-wilkinson, Hannah & HNE Mental Health Older People's Service - Mater Hospital (PGY1/2) & 2 \\ 
legge-wilkinson, Hannah & JHH Medicine - Cardiology (PGY1/2) & 5 \\ 
legge-wilkinson, Hannah & JHH Medicine - Nephrology \& Dialysis (PGY1/2) & 4 \\ 
legge-wilkinson, Hannah & CMN Emergency (PGY1/2) & 34 \\ 
\bottomrule
\end{longtable}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 2. HETI Compliance Report}


\CommentTok{\# Calculate average preference for each doctor across all 5 assignments}
\NormalTok{avg\_preference }\OtherTok{\textless{}{-}}\NormalTok{ doctor\_preference\_report }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(Doctor) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{Avg\_Score =} \FunctionTok{mean}\NormalTok{(Preference\_Score, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{))}

\CommentTok{\# Check if a doctor has been assigned to more than 1 term in any sub{-}specialty}
\NormalTok{sub\_specialty\_compliance }\OtherTok{\textless{}{-}} \FunctionTok{apply}\NormalTok{(assignment\_table[,}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{], }\DecValTok{1}\NormalTok{, }\ControlFlowTok{function}\NormalTok{(assignments) \{}
  \CommentTok{\# Map the assignments to their corresponding sub\_specialty\_status\_per\_term}
\NormalTok{  sub\_specialty\_terms }\OtherTok{\textless{}{-}}\NormalTok{ sub\_specialty\_status\_per\_term[assignments]}
  
  \CommentTok{\# Check if any sub{-}specialty is assigned more than 1 time}
\NormalTok{  max\_count }\OtherTok{\textless{}{-}} \FunctionTok{max}\NormalTok{(}\FunctionTok{table}\NormalTok{(sub\_specialty\_terms), }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
  \FunctionTok{return}\NormalTok{(max\_count }\SpecialCharTok{\textless{}=} \DecValTok{1}\NormalTok{)}
\NormalTok{\})}

\CommentTok{\# Check if a doctor has been assigned to more than 2 terms in any specialty}
\NormalTok{specialty\_compliance }\OtherTok{\textless{}{-}} \FunctionTok{apply}\NormalTok{(assignment\_table[,}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{], }\DecValTok{1}\NormalTok{, }\ControlFlowTok{function}\NormalTok{(assignments) \{}
  \CommentTok{\# Map the assignments to their corresponding specialty\_status\_per\_term}
\NormalTok{  specialty\_terms }\OtherTok{\textless{}{-}}\NormalTok{ specialty\_status\_per\_term[assignments]}
  
  \CommentTok{\# Check if any specialty is assigned more than 2 times}
\NormalTok{  max\_count }\OtherTok{\textless{}{-}} \FunctionTok{max}\NormalTok{(}\FunctionTok{table}\NormalTok{(specialty\_terms), }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
  \FunctionTok{return}\NormalTok{(max\_count }\SpecialCharTok{\textless{}} \DecValTok{3}\NormalTok{)}
\NormalTok{\})}

\CommentTok{\# Check if a doctor has been assigned to at least 3 "Team Based" terms}
\NormalTok{team\_based\_compliance }\OtherTok{\textless{}{-}} \FunctionTok{map\_lgl}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\NormalTok{num\_doctors, }\ControlFlowTok{function}\NormalTok{(i) \{}
\NormalTok{  doctor\_name }\OtherTok{\textless{}{-}}\NormalTok{ row\_names[i]}
\NormalTok{  terms\_assigned }\OtherTok{\textless{}{-}}\NormalTok{ doctor\_preference\_report }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{filter}\NormalTok{(Doctor }\SpecialCharTok{==}\NormalTok{ doctor\_name) }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{pull}\NormalTok{(Term)}
  
\NormalTok{  valid\_structures }\OtherTok{\textless{}{-}}\NormalTok{ clinical\_structure\_term[}\FunctionTok{match}\NormalTok{(terms\_assigned, }\FunctionTok{names}\NormalTok{(clinical\_structure\_term))]}
\NormalTok{  valid\_structures }\OtherTok{\textless{}{-}} \FunctionTok{na.omit}\NormalTok{(valid\_structures)}

\NormalTok{  team\_based\_count }\OtherTok{\textless{}{-}} \FunctionTok{sum}\NormalTok{(valid\_structures }\SpecialCharTok{==} \StringTok{"Team Based"}\NormalTok{)}
  
\NormalTok{  team\_based\_count }\SpecialCharTok{\textgreater{}=} \DecValTok{3}
\NormalTok{\})}

\CommentTok{\# Check for compliance with the desired term classifications}
\NormalTok{check\_term\_classifications }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(terms\_assigned) \{}
\NormalTok{  classification1 }\OtherTok{\textless{}{-}}\NormalTok{ term\_classification1[}\FunctionTok{match}\NormalTok{(terms\_assigned, column\_names)]}
\NormalTok{  classification2 }\OtherTok{\textless{}{-}}\NormalTok{ term\_classification2[}\FunctionTok{match}\NormalTok{(terms\_assigned, column\_names)]}
\NormalTok{  required\_terms }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"A{-}Undifferentiated illness patient care"}\NormalTok{, }
                      \StringTok{"B{-}Chronic illness patient care"}\NormalTok{, }
                      \StringTok{"C{-}Acute critical illness patient care"}\NormalTok{,}
                      \StringTok{"D{-}Peri{-}operative / procedural patient care"}\NormalTok{)}
  
  \CommentTok{\# Check for each term individually, without merging the classifications}
\NormalTok{  has\_required\_terms }\OtherTok{\textless{}{-}} \FunctionTok{sapply}\NormalTok{(required\_terms, }\ControlFlowTok{function}\NormalTok{(term) \{}
\NormalTok{    term }\SpecialCharTok{\%in\%}\NormalTok{ classification1 }\SpecialCharTok{||}\NormalTok{ term }\SpecialCharTok{\%in\%}\NormalTok{ classification2}
\NormalTok{  \})}
  
  \FunctionTok{return}\NormalTok{(}\FunctionTok{all}\NormalTok{(has\_required\_terms))}
\NormalTok{\}}

\NormalTok{term\_classifications\_compliance }\OtherTok{\textless{}{-}} \FunctionTok{sapply}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\NormalTok{num\_doctors, }\ControlFlowTok{function}\NormalTok{(i) \{}
\NormalTok{  doctor\_name }\OtherTok{\textless{}{-}}\NormalTok{ row\_names[i]}
\NormalTok{  terms\_assigned }\OtherTok{\textless{}{-}}\NormalTok{ doctor\_preference\_report}\SpecialCharTok{$}\NormalTok{Term[doctor\_preference\_report}\SpecialCharTok{$}\NormalTok{Doctor }\SpecialCharTok{==}\NormalTok{ doctor\_name]}
  \FunctionTok{return}\NormalTok{(}\FunctionTok{check\_term\_classifications}\NormalTok{(terms\_assigned))}
\NormalTok{\})}

\NormalTok{compliance\_data }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
  \AttributeTok{Doctor =}\NormalTok{ avg\_preference}\SpecialCharTok{$}\NormalTok{Doctor,}
  \AttributeTok{Avg\_Preference =}\NormalTok{ avg\_preference}\SpecialCharTok{$}\NormalTok{Avg\_Score,}
  \AttributeTok{SubSpecialty\_Compliance =}\NormalTok{ sub\_specialty\_compliance,}
  \AttributeTok{Specialty\_Compliance =}\NormalTok{ specialty\_compliance,}
  \AttributeTok{Team\_Based\_Compliance =}\NormalTok{ team\_based\_compliance,}
  \AttributeTok{Term\_Classifications\_Compliance =}\NormalTok{ term\_classifications\_compliance}
\NormalTok{)}

\CommentTok{\# Format with gt}

\NormalTok{HETI\_compliance\_table }\OtherTok{\textless{}{-}}\NormalTok{ compliance\_data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{gt}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{cols\_label}\NormalTok{(}
    \AttributeTok{Avg\_Preference =} \StringTok{"Avg. Preference (1{-}5)"}\NormalTok{,}
    \AttributeTok{SubSpecialty\_Compliance =} \StringTok{"Max 1 Term in Sub{-}Specialty"}\NormalTok{,}
    \AttributeTok{Specialty\_Compliance =} \StringTok{"Max 2 Terms in Specialty"}\NormalTok{,}
    \AttributeTok{Team\_Based\_Compliance =} \StringTok{"At Least 3 \textquotesingle{}Team Based\textquotesingle{} Terms"}\NormalTok{,}
    \AttributeTok{Term\_Classifications\_Compliance =} \StringTok{"Essential Classifications"}
\NormalTok{  )}

\FunctionTok{print}\NormalTok{(HETI\_compliance\_table)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## <div id="qbphmgogfw" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
##   <style>#qbphmgogfw table {
##   font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
##   -webkit-font-smoothing: antialiased;
##   -moz-osx-font-smoothing: grayscale;
## }
## 
## #qbphmgogfw thead, #qbphmgogfw tbody, #qbphmgogfw tfoot, #qbphmgogfw tr, #qbphmgogfw td, #qbphmgogfw th {
##   border-style: none;
## }
## 
## #qbphmgogfw p {
##   margin: 0;
##   padding: 0;
## }
## 
## #qbphmgogfw .gt_table {
##   display: table;
##   border-collapse: collapse;
##   line-height: normal;
##   margin-left: auto;
##   margin-right: auto;
##   color: #333333;
##   font-size: 16px;
##   font-weight: normal;
##   font-style: normal;
##   background-color: #FFFFFF;
##   width: auto;
##   border-top-style: solid;
##   border-top-width: 2px;
##   border-top-color: #A8A8A8;
##   border-right-style: none;
##   border-right-width: 2px;
##   border-right-color: #D3D3D3;
##   border-bottom-style: solid;
##   border-bottom-width: 2px;
##   border-bottom-color: #A8A8A8;
##   border-left-style: none;
##   border-left-width: 2px;
##   border-left-color: #D3D3D3;
## }
## 
## #qbphmgogfw .gt_caption {
##   padding-top: 4px;
##   padding-bottom: 4px;
## }
## 
## #qbphmgogfw .gt_title {
##   color: #333333;
##   font-size: 125%;
##   font-weight: initial;
##   padding-top: 4px;
##   padding-bottom: 4px;
##   padding-left: 5px;
##   padding-right: 5px;
##   border-bottom-color: #FFFFFF;
##   border-bottom-width: 0;
## }
## 
## #qbphmgogfw .gt_subtitle {
##   color: #333333;
##   font-size: 85%;
##   font-weight: initial;
##   padding-top: 3px;
##   padding-bottom: 5px;
##   padding-left: 5px;
##   padding-right: 5px;
##   border-top-color: #FFFFFF;
##   border-top-width: 0;
## }
## 
## #qbphmgogfw .gt_heading {
##   background-color: #FFFFFF;
##   text-align: center;
##   border-bottom-color: #FFFFFF;
##   border-left-style: none;
##   border-left-width: 1px;
##   border-left-color: #D3D3D3;
##   border-right-style: none;
##   border-right-width: 1px;
##   border-right-color: #D3D3D3;
## }
## 
## #qbphmgogfw .gt_bottom_border {
##   border-bottom-style: solid;
##   border-bottom-width: 2px;
##   border-bottom-color: #D3D3D3;
## }
## 
## #qbphmgogfw .gt_col_headings {
##   border-top-style: solid;
##   border-top-width: 2px;
##   border-top-color: #D3D3D3;
##   border-bottom-style: solid;
##   border-bottom-width: 2px;
##   border-bottom-color: #D3D3D3;
##   border-left-style: none;
##   border-left-width: 1px;
##   border-left-color: #D3D3D3;
##   border-right-style: none;
##   border-right-width: 1px;
##   border-right-color: #D3D3D3;
## }
## 
## #qbphmgogfw .gt_col_heading {
##   color: #333333;
##   background-color: #FFFFFF;
##   font-size: 100%;
##   font-weight: normal;
##   text-transform: inherit;
##   border-left-style: none;
##   border-left-width: 1px;
##   border-left-color: #D3D3D3;
##   border-right-style: none;
##   border-right-width: 1px;
##   border-right-color: #D3D3D3;
##   vertical-align: bottom;
##   padding-top: 5px;
##   padding-bottom: 6px;
##   padding-left: 5px;
##   padding-right: 5px;
##   overflow-x: hidden;
## }
## 
## #qbphmgogfw .gt_column_spanner_outer {
##   color: #333333;
##   background-color: #FFFFFF;
##   font-size: 100%;
##   font-weight: normal;
##   text-transform: inherit;
##   padding-top: 0;
##   padding-bottom: 0;
##   padding-left: 4px;
##   padding-right: 4px;
## }
## 
## #qbphmgogfw .gt_column_spanner_outer:first-child {
##   padding-left: 0;
## }
## 
## #qbphmgogfw .gt_column_spanner_outer:last-child {
##   padding-right: 0;
## }
## 
## #qbphmgogfw .gt_column_spanner {
##   border-bottom-style: solid;
##   border-bottom-width: 2px;
##   border-bottom-color: #D3D3D3;
##   vertical-align: bottom;
##   padding-top: 5px;
##   padding-bottom: 5px;
##   overflow-x: hidden;
##   display: inline-block;
##   width: 100%;
## }
## 
## #qbphmgogfw .gt_spanner_row {
##   border-bottom-style: hidden;
## }
## 
## #qbphmgogfw .gt_group_heading {
##   padding-top: 8px;
##   padding-bottom: 8px;
##   padding-left: 5px;
##   padding-right: 5px;
##   color: #333333;
##   background-color: #FFFFFF;
##   font-size: 100%;
##   font-weight: initial;
##   text-transform: inherit;
##   border-top-style: solid;
##   border-top-width: 2px;
##   border-top-color: #D3D3D3;
##   border-bottom-style: solid;
##   border-bottom-width: 2px;
##   border-bottom-color: #D3D3D3;
##   border-left-style: none;
##   border-left-width: 1px;
##   border-left-color: #D3D3D3;
##   border-right-style: none;
##   border-right-width: 1px;
##   border-right-color: #D3D3D3;
##   vertical-align: middle;
##   text-align: left;
## }
## 
## #qbphmgogfw .gt_empty_group_heading {
##   padding: 0.5px;
##   color: #333333;
##   background-color: #FFFFFF;
##   font-size: 100%;
##   font-weight: initial;
##   border-top-style: solid;
##   border-top-width: 2px;
##   border-top-color: #D3D3D3;
##   border-bottom-style: solid;
##   border-bottom-width: 2px;
##   border-bottom-color: #D3D3D3;
##   vertical-align: middle;
## }
## 
## #qbphmgogfw .gt_from_md > :first-child {
##   margin-top: 0;
## }
## 
## #qbphmgogfw .gt_from_md > :last-child {
##   margin-bottom: 0;
## }
## 
## #qbphmgogfw .gt_row {
##   padding-top: 8px;
##   padding-bottom: 8px;
##   padding-left: 5px;
##   padding-right: 5px;
##   margin: 10px;
##   border-top-style: solid;
##   border-top-width: 1px;
##   border-top-color: #D3D3D3;
##   border-left-style: none;
##   border-left-width: 1px;
##   border-left-color: #D3D3D3;
##   border-right-style: none;
##   border-right-width: 1px;
##   border-right-color: #D3D3D3;
##   vertical-align: middle;
##   overflow-x: hidden;
## }
## 
## #qbphmgogfw .gt_stub {
##   color: #333333;
##   background-color: #FFFFFF;
##   font-size: 100%;
##   font-weight: initial;
##   text-transform: inherit;
##   border-right-style: solid;
##   border-right-width: 2px;
##   border-right-color: #D3D3D3;
##   padding-left: 5px;
##   padding-right: 5px;
## }
## 
## #qbphmgogfw .gt_stub_row_group {
##   color: #333333;
##   background-color: #FFFFFF;
##   font-size: 100%;
##   font-weight: initial;
##   text-transform: inherit;
##   border-right-style: solid;
##   border-right-width: 2px;
##   border-right-color: #D3D3D3;
##   padding-left: 5px;
##   padding-right: 5px;
##   vertical-align: top;
## }
## 
## #qbphmgogfw .gt_row_group_first td {
##   border-top-width: 2px;
## }
## 
## #qbphmgogfw .gt_row_group_first th {
##   border-top-width: 2px;
## }
## 
## #qbphmgogfw .gt_summary_row {
##   color: #333333;
##   background-color: #FFFFFF;
##   text-transform: inherit;
##   padding-top: 8px;
##   padding-bottom: 8px;
##   padding-left: 5px;
##   padding-right: 5px;
## }
## 
## #qbphmgogfw .gt_first_summary_row {
##   border-top-style: solid;
##   border-top-color: #D3D3D3;
## }
## 
## #qbphmgogfw .gt_first_summary_row.thick {
##   border-top-width: 2px;
## }
## 
## #qbphmgogfw .gt_last_summary_row {
##   padding-top: 8px;
##   padding-bottom: 8px;
##   padding-left: 5px;
##   padding-right: 5px;
##   border-bottom-style: solid;
##   border-bottom-width: 2px;
##   border-bottom-color: #D3D3D3;
## }
## 
## #qbphmgogfw .gt_grand_summary_row {
##   color: #333333;
##   background-color: #FFFFFF;
##   text-transform: inherit;
##   padding-top: 8px;
##   padding-bottom: 8px;
##   padding-left: 5px;
##   padding-right: 5px;
## }
## 
## #qbphmgogfw .gt_first_grand_summary_row {
##   padding-top: 8px;
##   padding-bottom: 8px;
##   padding-left: 5px;
##   padding-right: 5px;
##   border-top-style: double;
##   border-top-width: 6px;
##   border-top-color: #D3D3D3;
## }
## 
## #qbphmgogfw .gt_last_grand_summary_row_top {
##   padding-top: 8px;
##   padding-bottom: 8px;
##   padding-left: 5px;
##   padding-right: 5px;
##   border-bottom-style: double;
##   border-bottom-width: 6px;
##   border-bottom-color: #D3D3D3;
## }
## 
## #qbphmgogfw .gt_striped {
##   background-color: rgba(128, 128, 128, 0.05);
## }
## 
## #qbphmgogfw .gt_table_body {
##   border-top-style: solid;
##   border-top-width: 2px;
##   border-top-color: #D3D3D3;
##   border-bottom-style: solid;
##   border-bottom-width: 2px;
##   border-bottom-color: #D3D3D3;
## }
## 
## #qbphmgogfw .gt_footnotes {
##   color: #333333;
##   background-color: #FFFFFF;
##   border-bottom-style: none;
##   border-bottom-width: 2px;
##   border-bottom-color: #D3D3D3;
##   border-left-style: none;
##   border-left-width: 2px;
##   border-left-color: #D3D3D3;
##   border-right-style: none;
##   border-right-width: 2px;
##   border-right-color: #D3D3D3;
## }
## 
## #qbphmgogfw .gt_footnote {
##   margin: 0px;
##   font-size: 90%;
##   padding-top: 4px;
##   padding-bottom: 4px;
##   padding-left: 5px;
##   padding-right: 5px;
## }
## 
## #qbphmgogfw .gt_sourcenotes {
##   color: #333333;
##   background-color: #FFFFFF;
##   border-bottom-style: none;
##   border-bottom-width: 2px;
##   border-bottom-color: #D3D3D3;
##   border-left-style: none;
##   border-left-width: 2px;
##   border-left-color: #D3D3D3;
##   border-right-style: none;
##   border-right-width: 2px;
##   border-right-color: #D3D3D3;
## }
## 
## #qbphmgogfw .gt_sourcenote {
##   font-size: 90%;
##   padding-top: 4px;
##   padding-bottom: 4px;
##   padding-left: 5px;
##   padding-right: 5px;
## }
## 
## #qbphmgogfw .gt_left {
##   text-align: left;
## }
## 
## #qbphmgogfw .gt_center {
##   text-align: center;
## }
## 
## #qbphmgogfw .gt_right {
##   text-align: right;
##   font-variant-numeric: tabular-nums;
## }
## 
## #qbphmgogfw .gt_font_normal {
##   font-weight: normal;
## }
## 
## #qbphmgogfw .gt_font_bold {
##   font-weight: bold;
## }
## 
## #qbphmgogfw .gt_font_italic {
##   font-style: italic;
## }
## 
## #qbphmgogfw .gt_super {
##   font-size: 65%;
## }
## 
## #qbphmgogfw .gt_footnote_marks {
##   font-size: 75%;
##   vertical-align: 0.4em;
##   position: initial;
## }
## 
## #qbphmgogfw .gt_asterisk {
##   font-size: 100%;
##   vertical-align: 0;
## }
## 
## #qbphmgogfw .gt_indent_1 {
##   text-indent: 5px;
## }
## 
## #qbphmgogfw .gt_indent_2 {
##   text-indent: 10px;
## }
## 
## #qbphmgogfw .gt_indent_3 {
##   text-indent: 15px;
## }
## 
## #qbphmgogfw .gt_indent_4 {
##   text-indent: 20px;
## }
## 
## #qbphmgogfw .gt_indent_5 {
##   text-indent: 25px;
## }
## </style>
##   <table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
##   <thead>
##     
##     <tr class="gt_col_headings">
##       <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Doctor">Doctor</th>
##       <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Avg. Preference (1-5)">Avg. Preference (1-5)</th>
##       <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Max 1 Term in Sub-Specialty">Max 1 Term in Sub-Specialty</th>
##       <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Max 2 Terms in Specialty">Max 2 Terms in Specialty</th>
##       <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="At Least 3 'Team Based' Terms">At Least 3 'Team Based' Terms</th>
##       <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Essential Classifications">Essential Classifications</th>
##     </tr>
##   </thead>
##   <tbody class="gt_table_body">
##     <tr><td headers="Doctor" class="gt_row gt_left">Anjum, Asad</td>
## <td headers="Avg_Preference" class="gt_row gt_right">30.8</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Arnold, Jessica</td>
## <td headers="Avg_Preference" class="gt_row gt_right">19.2</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">FALSE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Barrett, Jordan</td>
## <td headers="Avg_Preference" class="gt_row gt_right">19.8</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Bazley, Stephanie</td>
## <td headers="Avg_Preference" class="gt_row gt_right">22.6</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Benjamin, Redgen</td>
## <td headers="Avg_Preference" class="gt_row gt_right">31.4</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">FALSE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Bennett, Samantha</td>
## <td headers="Avg_Preference" class="gt_row gt_right">20.0</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Bowden, Mia</td>
## <td headers="Avg_Preference" class="gt_row gt_right">17.0</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">FALSE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Brieva, Lautaro</td>
## <td headers="Avg_Preference" class="gt_row gt_right">27.4</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Brigden, Kurt</td>
## <td headers="Avg_Preference" class="gt_row gt_right">18.4</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">FALSE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Clare, Grace</td>
## <td headers="Avg_Preference" class="gt_row gt_right">31.4</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Clark, Lachlan</td>
## <td headers="Avg_Preference" class="gt_row gt_right">27.2</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Coyle, William</td>
## <td headers="Avg_Preference" class="gt_row gt_right">30.2</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Craig, Graham</td>
## <td headers="Avg_Preference" class="gt_row gt_right">12.8</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Crawford, Matthew Crawford</td>
## <td headers="Avg_Preference" class="gt_row gt_right">19.8</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Cubby, Kieran</td>
## <td headers="Avg_Preference" class="gt_row gt_right">13.8</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Dixon, Monique</td>
## <td headers="Avg_Preference" class="gt_row gt_right">29.0</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Doherty, Ailish</td>
## <td headers="Avg_Preference" class="gt_row gt_right">14.6</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">FALSE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Douglas, Chloe</td>
## <td headers="Avg_Preference" class="gt_row gt_right">23.0</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Duggan, Georgia</td>
## <td headers="Avg_Preference" class="gt_row gt_right">12.4</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">FALSE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Emily, Ong</td>
## <td headers="Avg_Preference" class="gt_row gt_right">21.8</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">FALSE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Garvey, Matthew</td>
## <td headers="Avg_Preference" class="gt_row gt_right">14.4</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">FALSE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Glover, Izabella</td>
## <td headers="Avg_Preference" class="gt_row gt_right">41.2</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">FALSE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Gomersall, James</td>
## <td headers="Avg_Preference" class="gt_row gt_right">23.2</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">FALSE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Greentree, Bethany</td>
## <td headers="Avg_Preference" class="gt_row gt_right">22.4</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Grima, Zachary</td>
## <td headers="Avg_Preference" class="gt_row gt_right">30.2</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">FALSE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Hamid, Sarah Tufailah Binte</td>
## <td headers="Avg_Preference" class="gt_row gt_right">7.0</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Hatoum, Amira</td>
## <td headers="Avg_Preference" class="gt_row gt_right">27.8</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Higgins, Jack</td>
## <td headers="Avg_Preference" class="gt_row gt_right">9.0</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Horn, Anthea</td>
## <td headers="Avg_Preference" class="gt_row gt_right">21.8</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">FALSE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Horne, Jennifer</td>
## <td headers="Avg_Preference" class="gt_row gt_right">10.6</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">House, Colin</td>
## <td headers="Avg_Preference" class="gt_row gt_right">21.0</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">FALSE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Howdle, Gemma</td>
## <td headers="Avg_Preference" class="gt_row gt_right">21.0</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Jaarsma, Emily</td>
## <td headers="Avg_Preference" class="gt_row gt_right">24.4</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Jan, Asna</td>
## <td headers="Avg_Preference" class="gt_row gt_right">26.0</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Janczuk, Daniel</td>
## <td headers="Avg_Preference" class="gt_row gt_right">27.4</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">FALSE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Jessica, Boyley</td>
## <td headers="Avg_Preference" class="gt_row gt_right">12.2</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">FALSE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Keleher, Elise</td>
## <td headers="Avg_Preference" class="gt_row gt_right">19.8</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Khalid, Mariam</td>
## <td headers="Avg_Preference" class="gt_row gt_right">24.4</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Khanam, Khurshida</td>
## <td headers="Avg_Preference" class="gt_row gt_right">10.6</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Klasen, Caterina</td>
## <td headers="Avg_Preference" class="gt_row gt_right">3.0</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Kruszelnicki, Lola</td>
## <td headers="Avg_Preference" class="gt_row gt_right">14.0</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Lane, Sarah</td>
## <td headers="Avg_Preference" class="gt_row gt_right">20.4</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">FALSE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Li, Judy</td>
## <td headers="Avg_Preference" class="gt_row gt_right">16.6</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">FALSE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Li, Lanxin</td>
## <td headers="Avg_Preference" class="gt_row gt_right">28.8</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Ling, Koi Fei</td>
## <td headers="Avg_Preference" class="gt_row gt_right">21.4</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Lusted, Lindsay</td>
## <td headers="Avg_Preference" class="gt_row gt_right">12.4</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Lye, Charmaine</td>
## <td headers="Avg_Preference" class="gt_row gt_right">21.6</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Maher, Clare</td>
## <td headers="Avg_Preference" class="gt_row gt_right">13.4</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">McGrath, Joseph</td>
## <td headers="Avg_Preference" class="gt_row gt_right">26.4</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Miller, Codie</td>
## <td headers="Avg_Preference" class="gt_row gt_right">24.2</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Nagaratnam, Manisha</td>
## <td headers="Avg_Preference" class="gt_row gt_right">17.0</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">FALSE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Patterson, Alice</td>
## <td headers="Avg_Preference" class="gt_row gt_right">19.8</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Pierce, Matthew</td>
## <td headers="Avg_Preference" class="gt_row gt_right">17.4</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Pitman, Georgia</td>
## <td headers="Avg_Preference" class="gt_row gt_right">11.6</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Power, Jack</td>
## <td headers="Avg_Preference" class="gt_row gt_right">16.4</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Pringle, Jarrad</td>
## <td headers="Avg_Preference" class="gt_row gt_right">13.6</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">FALSE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Qian, Gemma</td>
## <td headers="Avg_Preference" class="gt_row gt_right">14.2</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Raeside, Thomas</td>
## <td headers="Avg_Preference" class="gt_row gt_right">26.0</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Rogers, Samantha</td>
## <td headers="Avg_Preference" class="gt_row gt_right">16.0</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">FALSE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Rosee, Patrick</td>
## <td headers="Avg_Preference" class="gt_row gt_right">11.4</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Rui, Ma</td>
## <td headers="Avg_Preference" class="gt_row gt_right">32.0</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">FALSE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Ryan, Daniel</td>
## <td headers="Avg_Preference" class="gt_row gt_right">21.4</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">FALSE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Sadler, Amelia</td>
## <td headers="Avg_Preference" class="gt_row gt_right">28.0</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Sasa, Otovic</td>
## <td headers="Avg_Preference" class="gt_row gt_right">14.2</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">FALSE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Shepherd, Maya</td>
## <td headers="Avg_Preference" class="gt_row gt_right">30.6</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Simpson, Hannah</td>
## <td headers="Avg_Preference" class="gt_row gt_right">4.4</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Somers, Bonnie</td>
## <td headers="Avg_Preference" class="gt_row gt_right">22.0</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">FALSE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Stanek, Samuel</td>
## <td headers="Avg_Preference" class="gt_row gt_right">23.4</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">FALSE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Steadman, Ashlee</td>
## <td headers="Avg_Preference" class="gt_row gt_right">18.8</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Stutchbury, Daniel</td>
## <td headers="Avg_Preference" class="gt_row gt_right">19.0</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Swanton, Rosie</td>
## <td headers="Avg_Preference" class="gt_row gt_right">27.8</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Tamara, Best</td>
## <td headers="Avg_Preference" class="gt_row gt_right">23.8</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">FALSE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Tang, Rachel</td>
## <td headers="Avg_Preference" class="gt_row gt_right">8.2</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Thomas, Stefan</td>
## <td headers="Avg_Preference" class="gt_row gt_right">14.2</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">FALSE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Tongs, Georgia</td>
## <td headers="Avg_Preference" class="gt_row gt_right">22.2</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">FALSE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Tou, Minnie Ying Yun</td>
## <td headers="Avg_Preference" class="gt_row gt_right">6.4</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Walker, Amy</td>
## <td headers="Avg_Preference" class="gt_row gt_right">28.8</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Wilson, Samantha</td>
## <td headers="Avg_Preference" class="gt_row gt_right">11.6</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Woodcock, Lucy</td>
## <td headers="Avg_Preference" class="gt_row gt_right">27.6</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Woods, Andrew</td>
## <td headers="Avg_Preference" class="gt_row gt_right">22.4</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Wright, Kirsten</td>
## <td headers="Avg_Preference" class="gt_row gt_right">13.0</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">FALSE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Zeng, Jim</td>
## <td headers="Avg_Preference" class="gt_row gt_right">17.0</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">Zubrzycki, Nicolas</td>
## <td headers="Avg_Preference" class="gt_row gt_right">15.0</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##     <tr><td headers="Doctor" class="gt_row gt_left">legge-wilkinson, Hannah</td>
## <td headers="Avg_Preference" class="gt_row gt_right">9.6</td>
## <td headers="SubSpecialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Specialty_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Team_Based_Compliance" class="gt_row gt_center">TRUE</td>
## <td headers="Term_Classifications_Compliance" class="gt_row gt_center">TRUE</td></tr>
##   </tbody>
##   
##   
## </table>
## </div>
\end{verbatim}

\hypertarget{model-evaluation}{%
\section{MODEL EVALUATION}\label{model-evaluation}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# How many Doctors with one Top 10 preference}

\CommentTok{\# Convert the preference matrix into a top 10 boolean matrix}
\NormalTok{top\_10\_matrix }\OtherTok{\textless{}{-}} \FunctionTok{t}\NormalTok{(}\FunctionTok{apply}\NormalTok{(preference\_matrix, }\DecValTok{1}\NormalTok{, }\ControlFlowTok{function}\NormalTok{(row) row }\SpecialCharTok{\%in\%} \FunctionTok{sort}\NormalTok{(row, }\AttributeTok{decreasing =} \ConstantTok{FALSE}\NormalTok{)[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{10}\NormalTok{]))}

\CommentTok{\# For each doctor, determine if the assigned terms are in their top 10 preferences}
\NormalTok{assignment\_top\_10\_matrix }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\DecValTok{0}\NormalTok{, }\AttributeTok{nrow =}\NormalTok{ num\_doctors, }\AttributeTok{ncol =}\NormalTok{ num\_assignments)}

\ControlFlowTok{for}\NormalTok{ (assignment\_num }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{num\_assignments) \{}
\NormalTok{  assignment\_column }\OtherTok{\textless{}{-}} \FunctionTok{paste0}\NormalTok{(}\StringTok{"Assignment"}\NormalTok{, assignment\_num)}
\NormalTok{  assigned\_terms }\OtherTok{\textless{}{-}}\NormalTok{ assignment\_table[, assignment\_column]}
  
  \CommentTok{\# Convert the assigned term names back to their column indices}
\NormalTok{  assigned\_indices }\OtherTok{\textless{}{-}} \FunctionTok{match}\NormalTok{(assigned\_terms, }\FunctionTok{colnames}\NormalTok{(selected\_data))}
  
  \ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{num\_doctors) \{}
\NormalTok{    assignment\_top\_10\_matrix[i, assignment\_num] }\OtherTok{\textless{}{-}}\NormalTok{ top\_10\_matrix[i, assigned\_indices[i]]}
\NormalTok{  \}}
\NormalTok{\}}

\CommentTok{\# Convert the preference matrix into a top 5 boolean matrix}
\NormalTok{top\_5\_matrix }\OtherTok{\textless{}{-}} \FunctionTok{t}\NormalTok{(}\FunctionTok{apply}\NormalTok{(preference\_matrix, }\DecValTok{1}\NormalTok{, }\ControlFlowTok{function}\NormalTok{(row) row }\SpecialCharTok{\%in\%} \FunctionTok{sort}\NormalTok{(row, }\AttributeTok{decreasing =} \ConstantTok{FALSE}\NormalTok{)[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{]))}

\CommentTok{\# Create a function to compute metrics for a given top\_x matrix}
\NormalTok{get\_metrics }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(matrix, assignment\_table, num\_assignments) \{}
\NormalTok{  assignment\_matrix }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\DecValTok{0}\NormalTok{, }\AttributeTok{nrow =}\NormalTok{ num\_doctors, }\AttributeTok{ncol =}\NormalTok{ num\_assignments)}
  
  \ControlFlowTok{for}\NormalTok{ (assignment\_num }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{num\_assignments) \{}
\NormalTok{    assignment\_column }\OtherTok{\textless{}{-}} \FunctionTok{paste0}\NormalTok{(}\StringTok{"Assignment"}\NormalTok{, assignment\_num)}
\NormalTok{    assigned\_terms }\OtherTok{\textless{}{-}}\NormalTok{ assignment\_table[, assignment\_column]}
    
    \CommentTok{\# Convert the assigned term names back to their column indices}
\NormalTok{    assigned\_indices }\OtherTok{\textless{}{-}} \FunctionTok{match}\NormalTok{(assigned\_terms, }\FunctionTok{colnames}\NormalTok{(selected\_data))}
    
    \ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{num\_doctors) \{}
\NormalTok{      assignment\_matrix[i, assignment\_num] }\OtherTok{\textless{}{-}}\NormalTok{ matrix[i, assigned\_indices[i]]}
\NormalTok{    \}}
\NormalTok{  \}}
  
  \FunctionTok{return}\NormalTok{(}\FunctionTok{rowSums}\NormalTok{(assignment\_matrix))}
\NormalTok{\}}

\NormalTok{top\_10\_counts\_per\_doctor }\OtherTok{\textless{}{-}} \FunctionTok{get\_metrics}\NormalTok{(top\_10\_matrix, assignment\_table, num\_assignments)}
\NormalTok{top\_5\_counts\_per\_doctor }\OtherTok{\textless{}{-}} \FunctionTok{get\_metrics}\NormalTok{(top\_5\_matrix, assignment\_table, num\_assignments)}

\CommentTok{\# Extract all assigned terms for each doctor across the assignments}
\NormalTok{assigned\_terms\_all }\OtherTok{\textless{}{-}} \FunctionTok{as.vector}\NormalTok{(}\FunctionTok{t}\NormalTok{(assignment\_table[, }\DecValTok{2}\SpecialCharTok{:}\NormalTok{(num\_assignments }\SpecialCharTok{+} \DecValTok{1}\NormalTok{)]))}

\CommentTok{\# Convert the assigned term names back to their column indices}
\NormalTok{assigned\_indices\_all }\OtherTok{\textless{}{-}} \FunctionTok{match}\NormalTok{(assigned\_terms\_all, }\FunctionTok{colnames}\NormalTok{(selected\_data))}

\CommentTok{\# Retrieve preference values using matrix indexing}
\NormalTok{assigned\_preference\_values }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\DecValTok{0}\NormalTok{, }\AttributeTok{nrow =}\NormalTok{ num\_doctors, }\AttributeTok{ncol =}\NormalTok{ num\_assignments)}
\ControlFlowTok{for}\NormalTok{ (assignment\_num }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{num\_assignments) \{}
\NormalTok{  assignment\_column }\OtherTok{\textless{}{-}} \FunctionTok{paste0}\NormalTok{(}\StringTok{"Assignment"}\NormalTok{, assignment\_num)}
\NormalTok{  assigned\_terms }\OtherTok{\textless{}{-}}\NormalTok{ assignment\_table[, assignment\_column]}
  
  \CommentTok{\# Convert the assigned term names back to their column indices}
\NormalTok{  assigned\_indices }\OtherTok{\textless{}{-}} \FunctionTok{match}\NormalTok{(assigned\_terms, }\FunctionTok{colnames}\NormalTok{(selected\_data))}
  
  \ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{num\_doctors) \{}
\NormalTok{    assigned\_preference\_values[i, assignment\_num] }\OtherTok{\textless{}{-}}\NormalTok{ preference\_matrix[i, assigned\_indices[i]]}
\NormalTok{  \}}
\NormalTok{\}}

\NormalTok{average\_assigned\_preference }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{(}\FunctionTok{as.vector}\NormalTok{(assigned\_preference\_values))}

\CommentTok{\# Calculate the percentage of TRUE values in term\_classifications\_compliance}
\NormalTok{overall\_percentage\_compliance }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{(term\_classifications\_compliance) }\SpecialCharTok{*} \DecValTok{100}

\CommentTok{\# Calculate the metrics of interest for each doctor}
\NormalTok{range\_per\_doctor }\OtherTok{\textless{}{-}} \FunctionTok{apply}\NormalTok{(assigned\_preference\_values, }\DecValTok{1}\NormalTok{, range)}
\NormalTok{max\_per\_doctor }\OtherTok{\textless{}{-}}\NormalTok{ range\_per\_doctor[}\DecValTok{2}\NormalTok{,]}
\NormalTok{min\_per\_doctor }\OtherTok{\textless{}{-}}\NormalTok{ range\_per\_doctor[}\DecValTok{1}\NormalTok{,]}
\NormalTok{sd\_per\_doctor }\OtherTok{\textless{}{-}} \FunctionTok{apply}\NormalTok{(assigned\_preference\_values, }\DecValTok{1}\NormalTok{, sd)}

\CommentTok{\# Compute the average values across all doctors}
\NormalTok{average\_max }\OtherTok{=} \FunctionTok{mean}\NormalTok{(max\_per\_doctor)}
\NormalTok{average\_min }\OtherTok{=} \FunctionTok{mean}\NormalTok{(min\_per\_doctor)}
\NormalTok{average\_sd }\OtherTok{=} \FunctionTok{mean}\NormalTok{(sd\_per\_doctor)}

\CommentTok{\# Create a data frame with the evaluation metrics}
\NormalTok{evaluation\_data }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
  \AttributeTok{Metric =} \FunctionTok{c}\NormalTok{(}\StringTok{"At least 1 term in Top 10 (\%)"}\NormalTok{, }
             \StringTok{"At least 2 terms in Top 10 (\%)"}\NormalTok{, }
             \StringTok{"At least 3 terms in Top 10 (\%)"}\NormalTok{, }
             \StringTok{"At least 1 term in Top 5 (\%)"}\NormalTok{,}
             \StringTok{"At least 2 term in Top 5 (\%)"}\NormalTok{,}
             \StringTok{"At least 3 term in Top 5 (\%)"}\NormalTok{,}
             \StringTok{"Percentage of lines with full HETI compliance"}\NormalTok{,}
             \StringTok{"Average Preference of Assigned Terms"}\NormalTok{,}
             \StringTok{"Average Max of Assigned Preferences"}\NormalTok{,}
             \StringTok{"Average Min of Assigned Preferences"}\NormalTok{,}
             \StringTok{"Average SD of Assigned Preferences"}\NormalTok{),}
  \AttributeTok{Value =} \FunctionTok{c}\NormalTok{(}\FunctionTok{sum}\NormalTok{(top\_10\_counts\_per\_doctor }\SpecialCharTok{\textgreater{}} \DecValTok{0}\NormalTok{) }\SpecialCharTok{/}\NormalTok{ num\_doctors }\SpecialCharTok{*} \DecValTok{100}\NormalTok{, }
            \FunctionTok{sum}\NormalTok{(top\_10\_counts\_per\_doctor }\SpecialCharTok{\textgreater{}=} \DecValTok{2}\NormalTok{) }\SpecialCharTok{/}\NormalTok{ num\_doctors }\SpecialCharTok{*} \DecValTok{100}\NormalTok{, }
            \FunctionTok{sum}\NormalTok{(top\_10\_counts\_per\_doctor }\SpecialCharTok{\textgreater{}=} \DecValTok{3}\NormalTok{) }\SpecialCharTok{/}\NormalTok{ num\_doctors }\SpecialCharTok{*} \DecValTok{100}\NormalTok{, }
            \FunctionTok{sum}\NormalTok{(top\_5\_counts\_per\_doctor }\SpecialCharTok{\textgreater{}} \DecValTok{0}\NormalTok{) }\SpecialCharTok{/}\NormalTok{ num\_doctors }\SpecialCharTok{*} \DecValTok{100}\NormalTok{,}
            \FunctionTok{sum}\NormalTok{(top\_5\_counts\_per\_doctor }\SpecialCharTok{\textgreater{}=} \DecValTok{2}\NormalTok{) }\SpecialCharTok{/}\NormalTok{ num\_doctors }\SpecialCharTok{*} \DecValTok{100}\NormalTok{,}
            \FunctionTok{sum}\NormalTok{(top\_5\_counts\_per\_doctor }\SpecialCharTok{\textgreater{}=} \DecValTok{3}\NormalTok{) }\SpecialCharTok{/}\NormalTok{ num\_doctors }\SpecialCharTok{*} \DecValTok{100}\NormalTok{,}
\NormalTok{            overall\_percentage\_compliance,}
\NormalTok{            average\_assigned\_preference,}
\NormalTok{            average\_max,}
\NormalTok{            average\_min,}
\NormalTok{            average\_sd)}
\NormalTok{)}

\CommentTok{\# Round the values to 2 decimal places}
\NormalTok{evaluation\_data}\SpecialCharTok{$}\NormalTok{Value }\OtherTok{\textless{}{-}} \FunctionTok{round}\NormalTok{(evaluation\_data}\SpecialCharTok{$}\NormalTok{Value, }\DecValTok{2}\NormalTok{)}

\CommentTok{\# Generate the table using gt}
\NormalTok{evaluation\_table }\OtherTok{\textless{}{-}} \FunctionTok{gt}\NormalTok{(evaluation\_data) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{tab\_header}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"Model Evaluation"}
\NormalTok{  ) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{cols\_label}\NormalTok{(}
    \AttributeTok{Metric =} \StringTok{"Metric"}\NormalTok{,}
    \AttributeTok{Value =} \StringTok{"Value"}
\NormalTok{  )}

\CommentTok{\# Print the table}
\FunctionTok{print}\NormalTok{(evaluation\_table)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## <div id="bzdjbnslmc" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
##   <style>#bzdjbnslmc table {
##   font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
##   -webkit-font-smoothing: antialiased;
##   -moz-osx-font-smoothing: grayscale;
## }
## 
## #bzdjbnslmc thead, #bzdjbnslmc tbody, #bzdjbnslmc tfoot, #bzdjbnslmc tr, #bzdjbnslmc td, #bzdjbnslmc th {
##   border-style: none;
## }
## 
## #bzdjbnslmc p {
##   margin: 0;
##   padding: 0;
## }
## 
## #bzdjbnslmc .gt_table {
##   display: table;
##   border-collapse: collapse;
##   line-height: normal;
##   margin-left: auto;
##   margin-right: auto;
##   color: #333333;
##   font-size: 16px;
##   font-weight: normal;
##   font-style: normal;
##   background-color: #FFFFFF;
##   width: auto;
##   border-top-style: solid;
##   border-top-width: 2px;
##   border-top-color: #A8A8A8;
##   border-right-style: none;
##   border-right-width: 2px;
##   border-right-color: #D3D3D3;
##   border-bottom-style: solid;
##   border-bottom-width: 2px;
##   border-bottom-color: #A8A8A8;
##   border-left-style: none;
##   border-left-width: 2px;
##   border-left-color: #D3D3D3;
## }
## 
## #bzdjbnslmc .gt_caption {
##   padding-top: 4px;
##   padding-bottom: 4px;
## }
## 
## #bzdjbnslmc .gt_title {
##   color: #333333;
##   font-size: 125%;
##   font-weight: initial;
##   padding-top: 4px;
##   padding-bottom: 4px;
##   padding-left: 5px;
##   padding-right: 5px;
##   border-bottom-color: #FFFFFF;
##   border-bottom-width: 0;
## }
## 
## #bzdjbnslmc .gt_subtitle {
##   color: #333333;
##   font-size: 85%;
##   font-weight: initial;
##   padding-top: 3px;
##   padding-bottom: 5px;
##   padding-left: 5px;
##   padding-right: 5px;
##   border-top-color: #FFFFFF;
##   border-top-width: 0;
## }
## 
## #bzdjbnslmc .gt_heading {
##   background-color: #FFFFFF;
##   text-align: center;
##   border-bottom-color: #FFFFFF;
##   border-left-style: none;
##   border-left-width: 1px;
##   border-left-color: #D3D3D3;
##   border-right-style: none;
##   border-right-width: 1px;
##   border-right-color: #D3D3D3;
## }
## 
## #bzdjbnslmc .gt_bottom_border {
##   border-bottom-style: solid;
##   border-bottom-width: 2px;
##   border-bottom-color: #D3D3D3;
## }
## 
## #bzdjbnslmc .gt_col_headings {
##   border-top-style: solid;
##   border-top-width: 2px;
##   border-top-color: #D3D3D3;
##   border-bottom-style: solid;
##   border-bottom-width: 2px;
##   border-bottom-color: #D3D3D3;
##   border-left-style: none;
##   border-left-width: 1px;
##   border-left-color: #D3D3D3;
##   border-right-style: none;
##   border-right-width: 1px;
##   border-right-color: #D3D3D3;
## }
## 
## #bzdjbnslmc .gt_col_heading {
##   color: #333333;
##   background-color: #FFFFFF;
##   font-size: 100%;
##   font-weight: normal;
##   text-transform: inherit;
##   border-left-style: none;
##   border-left-width: 1px;
##   border-left-color: #D3D3D3;
##   border-right-style: none;
##   border-right-width: 1px;
##   border-right-color: #D3D3D3;
##   vertical-align: bottom;
##   padding-top: 5px;
##   padding-bottom: 6px;
##   padding-left: 5px;
##   padding-right: 5px;
##   overflow-x: hidden;
## }
## 
## #bzdjbnslmc .gt_column_spanner_outer {
##   color: #333333;
##   background-color: #FFFFFF;
##   font-size: 100%;
##   font-weight: normal;
##   text-transform: inherit;
##   padding-top: 0;
##   padding-bottom: 0;
##   padding-left: 4px;
##   padding-right: 4px;
## }
## 
## #bzdjbnslmc .gt_column_spanner_outer:first-child {
##   padding-left: 0;
## }
## 
## #bzdjbnslmc .gt_column_spanner_outer:last-child {
##   padding-right: 0;
## }
## 
## #bzdjbnslmc .gt_column_spanner {
##   border-bottom-style: solid;
##   border-bottom-width: 2px;
##   border-bottom-color: #D3D3D3;
##   vertical-align: bottom;
##   padding-top: 5px;
##   padding-bottom: 5px;
##   overflow-x: hidden;
##   display: inline-block;
##   width: 100%;
## }
## 
## #bzdjbnslmc .gt_spanner_row {
##   border-bottom-style: hidden;
## }
## 
## #bzdjbnslmc .gt_group_heading {
##   padding-top: 8px;
##   padding-bottom: 8px;
##   padding-left: 5px;
##   padding-right: 5px;
##   color: #333333;
##   background-color: #FFFFFF;
##   font-size: 100%;
##   font-weight: initial;
##   text-transform: inherit;
##   border-top-style: solid;
##   border-top-width: 2px;
##   border-top-color: #D3D3D3;
##   border-bottom-style: solid;
##   border-bottom-width: 2px;
##   border-bottom-color: #D3D3D3;
##   border-left-style: none;
##   border-left-width: 1px;
##   border-left-color: #D3D3D3;
##   border-right-style: none;
##   border-right-width: 1px;
##   border-right-color: #D3D3D3;
##   vertical-align: middle;
##   text-align: left;
## }
## 
## #bzdjbnslmc .gt_empty_group_heading {
##   padding: 0.5px;
##   color: #333333;
##   background-color: #FFFFFF;
##   font-size: 100%;
##   font-weight: initial;
##   border-top-style: solid;
##   border-top-width: 2px;
##   border-top-color: #D3D3D3;
##   border-bottom-style: solid;
##   border-bottom-width: 2px;
##   border-bottom-color: #D3D3D3;
##   vertical-align: middle;
## }
## 
## #bzdjbnslmc .gt_from_md > :first-child {
##   margin-top: 0;
## }
## 
## #bzdjbnslmc .gt_from_md > :last-child {
##   margin-bottom: 0;
## }
## 
## #bzdjbnslmc .gt_row {
##   padding-top: 8px;
##   padding-bottom: 8px;
##   padding-left: 5px;
##   padding-right: 5px;
##   margin: 10px;
##   border-top-style: solid;
##   border-top-width: 1px;
##   border-top-color: #D3D3D3;
##   border-left-style: none;
##   border-left-width: 1px;
##   border-left-color: #D3D3D3;
##   border-right-style: none;
##   border-right-width: 1px;
##   border-right-color: #D3D3D3;
##   vertical-align: middle;
##   overflow-x: hidden;
## }
## 
## #bzdjbnslmc .gt_stub {
##   color: #333333;
##   background-color: #FFFFFF;
##   font-size: 100%;
##   font-weight: initial;
##   text-transform: inherit;
##   border-right-style: solid;
##   border-right-width: 2px;
##   border-right-color: #D3D3D3;
##   padding-left: 5px;
##   padding-right: 5px;
## }
## 
## #bzdjbnslmc .gt_stub_row_group {
##   color: #333333;
##   background-color: #FFFFFF;
##   font-size: 100%;
##   font-weight: initial;
##   text-transform: inherit;
##   border-right-style: solid;
##   border-right-width: 2px;
##   border-right-color: #D3D3D3;
##   padding-left: 5px;
##   padding-right: 5px;
##   vertical-align: top;
## }
## 
## #bzdjbnslmc .gt_row_group_first td {
##   border-top-width: 2px;
## }
## 
## #bzdjbnslmc .gt_row_group_first th {
##   border-top-width: 2px;
## }
## 
## #bzdjbnslmc .gt_summary_row {
##   color: #333333;
##   background-color: #FFFFFF;
##   text-transform: inherit;
##   padding-top: 8px;
##   padding-bottom: 8px;
##   padding-left: 5px;
##   padding-right: 5px;
## }
## 
## #bzdjbnslmc .gt_first_summary_row {
##   border-top-style: solid;
##   border-top-color: #D3D3D3;
## }
## 
## #bzdjbnslmc .gt_first_summary_row.thick {
##   border-top-width: 2px;
## }
## 
## #bzdjbnslmc .gt_last_summary_row {
##   padding-top: 8px;
##   padding-bottom: 8px;
##   padding-left: 5px;
##   padding-right: 5px;
##   border-bottom-style: solid;
##   border-bottom-width: 2px;
##   border-bottom-color: #D3D3D3;
## }
## 
## #bzdjbnslmc .gt_grand_summary_row {
##   color: #333333;
##   background-color: #FFFFFF;
##   text-transform: inherit;
##   padding-top: 8px;
##   padding-bottom: 8px;
##   padding-left: 5px;
##   padding-right: 5px;
## }
## 
## #bzdjbnslmc .gt_first_grand_summary_row {
##   padding-top: 8px;
##   padding-bottom: 8px;
##   padding-left: 5px;
##   padding-right: 5px;
##   border-top-style: double;
##   border-top-width: 6px;
##   border-top-color: #D3D3D3;
## }
## 
## #bzdjbnslmc .gt_last_grand_summary_row_top {
##   padding-top: 8px;
##   padding-bottom: 8px;
##   padding-left: 5px;
##   padding-right: 5px;
##   border-bottom-style: double;
##   border-bottom-width: 6px;
##   border-bottom-color: #D3D3D3;
## }
## 
## #bzdjbnslmc .gt_striped {
##   background-color: rgba(128, 128, 128, 0.05);
## }
## 
## #bzdjbnslmc .gt_table_body {
##   border-top-style: solid;
##   border-top-width: 2px;
##   border-top-color: #D3D3D3;
##   border-bottom-style: solid;
##   border-bottom-width: 2px;
##   border-bottom-color: #D3D3D3;
## }
## 
## #bzdjbnslmc .gt_footnotes {
##   color: #333333;
##   background-color: #FFFFFF;
##   border-bottom-style: none;
##   border-bottom-width: 2px;
##   border-bottom-color: #D3D3D3;
##   border-left-style: none;
##   border-left-width: 2px;
##   border-left-color: #D3D3D3;
##   border-right-style: none;
##   border-right-width: 2px;
##   border-right-color: #D3D3D3;
## }
## 
## #bzdjbnslmc .gt_footnote {
##   margin: 0px;
##   font-size: 90%;
##   padding-top: 4px;
##   padding-bottom: 4px;
##   padding-left: 5px;
##   padding-right: 5px;
## }
## 
## #bzdjbnslmc .gt_sourcenotes {
##   color: #333333;
##   background-color: #FFFFFF;
##   border-bottom-style: none;
##   border-bottom-width: 2px;
##   border-bottom-color: #D3D3D3;
##   border-left-style: none;
##   border-left-width: 2px;
##   border-left-color: #D3D3D3;
##   border-right-style: none;
##   border-right-width: 2px;
##   border-right-color: #D3D3D3;
## }
## 
## #bzdjbnslmc .gt_sourcenote {
##   font-size: 90%;
##   padding-top: 4px;
##   padding-bottom: 4px;
##   padding-left: 5px;
##   padding-right: 5px;
## }
## 
## #bzdjbnslmc .gt_left {
##   text-align: left;
## }
## 
## #bzdjbnslmc .gt_center {
##   text-align: center;
## }
## 
## #bzdjbnslmc .gt_right {
##   text-align: right;
##   font-variant-numeric: tabular-nums;
## }
## 
## #bzdjbnslmc .gt_font_normal {
##   font-weight: normal;
## }
## 
## #bzdjbnslmc .gt_font_bold {
##   font-weight: bold;
## }
## 
## #bzdjbnslmc .gt_font_italic {
##   font-style: italic;
## }
## 
## #bzdjbnslmc .gt_super {
##   font-size: 65%;
## }
## 
## #bzdjbnslmc .gt_footnote_marks {
##   font-size: 75%;
##   vertical-align: 0.4em;
##   position: initial;
## }
## 
## #bzdjbnslmc .gt_asterisk {
##   font-size: 100%;
##   vertical-align: 0;
## }
## 
## #bzdjbnslmc .gt_indent_1 {
##   text-indent: 5px;
## }
## 
## #bzdjbnslmc .gt_indent_2 {
##   text-indent: 10px;
## }
## 
## #bzdjbnslmc .gt_indent_3 {
##   text-indent: 15px;
## }
## 
## #bzdjbnslmc .gt_indent_4 {
##   text-indent: 20px;
## }
## 
## #bzdjbnslmc .gt_indent_5 {
##   text-indent: 25px;
## }
## </style>
##   <table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
##   <thead>
##     <tr class="gt_heading">
##       <td colspan="2" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>Model Evaluation</td>
##     </tr>
##     
##     <tr class="gt_col_headings">
##       <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Metric">Metric</th>
##       <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Value">Value</th>
##     </tr>
##   </thead>
##   <tbody class="gt_table_body">
##     <tr><td headers="Metric" class="gt_row gt_left">At least 1 term in Top 10 (%)</td>
## <td headers="Value" class="gt_row gt_right">98.81</td></tr>
##     <tr><td headers="Metric" class="gt_row gt_left">At least 2 terms in Top 10 (%)</td>
## <td headers="Value" class="gt_row gt_right">96.43</td></tr>
##     <tr><td headers="Metric" class="gt_row gt_left">At least 3 terms in Top 10 (%)</td>
## <td headers="Value" class="gt_row gt_right">64.29</td></tr>
##     <tr><td headers="Metric" class="gt_row gt_left">At least 1 term in Top 5 (%)</td>
## <td headers="Value" class="gt_row gt_right">98.81</td></tr>
##     <tr><td headers="Metric" class="gt_row gt_left">At least 2 term in Top 5 (%)</td>
## <td headers="Value" class="gt_row gt_right">96.43</td></tr>
##     <tr><td headers="Metric" class="gt_row gt_left">At least 3 term in Top 5 (%)</td>
## <td headers="Value" class="gt_row gt_right">58.33</td></tr>
##     <tr><td headers="Metric" class="gt_row gt_left">Percentage of lines with full HETI compliance</td>
## <td headers="Value" class="gt_row gt_right">65.48</td></tr>
##     <tr><td headers="Metric" class="gt_row gt_left">Average Preference of Assigned Terms</td>
## <td headers="Value" class="gt_row gt_right">19.81</td></tr>
##     <tr><td headers="Metric" class="gt_row gt_left">Average Max of Assigned Preferences</td>
## <td headers="Value" class="gt_row gt_right">48.73</td></tr>
##     <tr><td headers="Metric" class="gt_row gt_left">Average Min of Assigned Preferences</td>
## <td headers="Value" class="gt_row gt_right">2.04</td></tr>
##     <tr><td headers="Metric" class="gt_row gt_left">Average SD of Assigned Preferences</td>
## <td headers="Value" class="gt_row gt_right">21.08</td></tr>
##   </tbody>
##   
##   
## </table>
## </div>
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Term Subscription Evaluation}

\CommentTok{\# Assuming \textquotesingle{}selected\_data\textquotesingle{} and \textquotesingle{}term\_master\_df\textquotesingle{} have been defined}
\CommentTok{\# Convert selected data to a matrix}
\NormalTok{preference\_matrix }\OtherTok{\textless{}{-}} \FunctionTok{as.matrix}\NormalTok{(selected\_data)}

\CommentTok{\# Get the number of doctors}
\NormalTok{num\_doctors }\OtherTok{\textless{}{-}} \FunctionTok{nrow}\NormalTok{(preference\_matrix)}

\CommentTok{\# Convert preferences to numeric values for ranking}
\NormalTok{numeric\_preference\_matrix }\OtherTok{\textless{}{-}} \FunctionTok{apply}\NormalTok{(preference\_matrix, }\DecValTok{2}\NormalTok{, as.numeric)}

\CommentTok{\# Find the indices of the top 5 preferences for each doctor}
\NormalTok{top\_5\_indices }\OtherTok{\textless{}{-}} \FunctionTok{apply}\NormalTok{(numeric\_preference\_matrix, }\DecValTok{1}\NormalTok{, }\ControlFlowTok{function}\NormalTok{(x) }\FunctionTok{order}\NormalTok{(x, }\AttributeTok{decreasing =} \ConstantTok{FALSE}\NormalTok{)[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{])}

\CommentTok{\# Convert matrix to a long format tibble to count top 5 preferences for each term}
\NormalTok{preference\_long }\OtherTok{\textless{}{-}} \FunctionTok{as.data.frame}\NormalTok{(}\FunctionTok{t}\NormalTok{(top\_5\_indices)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pivot\_longer}\NormalTok{(}\FunctionTok{everything}\NormalTok{(), }\AttributeTok{names\_to =} \StringTok{"Doctor"}\NormalTok{, }\AttributeTok{values\_to =} \StringTok{"Term\_Index"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Term\_Name =} \FunctionTok{colnames}\NormalTok{(selected\_data)[Term\_Index],}
         \AttributeTok{Top\_5\_Flag =} \DecValTok{1}\NormalTok{)}

\CommentTok{\# Aggregate the max doctors per term across all terms from \textquotesingle{}term\_master\_df\textquotesingle{}}
\NormalTok{max\_doctors\_per\_term }\OtherTok{\textless{}{-}} \FunctionTok{rowSums}\NormalTok{(}\FunctionTok{cbind}\NormalTok{(}
\NormalTok{  term\_master\_df}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{PGY1 Term 1 Allocation}\StringTok{\textasciigrave{}}\NormalTok{,}
\NormalTok{  term\_master\_df}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{PGY1 Term 2 Allocation}\StringTok{\textasciigrave{}}\NormalTok{,}
\NormalTok{  term\_master\_df}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{PGY1 Term 3 Allocation}\StringTok{\textasciigrave{}}\NormalTok{,}
\NormalTok{  term\_master\_df}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{PGY1 Term 4 Allocation}\StringTok{\textasciigrave{}}\NormalTok{,}
\NormalTok{  term\_master\_df}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{PGY1 Term 5 Allocation}\StringTok{\textasciigrave{}}
\NormalTok{), }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\# Create a data frame of available terms with all terms from \textquotesingle{}term\_master\_df\textquotesingle{}}
\NormalTok{available\_terms\_df }\OtherTok{\textless{}{-}}\NormalTok{ term\_master\_df }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Term Name}\StringTok{\textasciigrave{}}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{rename}\NormalTok{(}\AttributeTok{Term\_Name =} \StringTok{\textasciigrave{}}\AttributeTok{Term Name}\StringTok{\textasciigrave{}}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{distinct}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Number\_of\_Available\_Terms =}\NormalTok{ max\_doctors\_per\_term)}

\CommentTok{\# Calculate the count and percentage of doctors who ranked each term in their top 5}
\NormalTok{top\_5\_preference }\OtherTok{\textless{}{-}}\NormalTok{ preference\_long }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(Term\_Name) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}
    \AttributeTok{Count =} \FunctionTok{n}\NormalTok{(),}
    \AttributeTok{Percentage =} \FunctionTok{round}\NormalTok{((Count }\SpecialCharTok{/}\NormalTok{ num\_doctors) }\SpecialCharTok{*} \DecValTok{100}\NormalTok{, }\DecValTok{1}\NormalTok{)  }\CommentTok{\# Round to 1 decimal place}
\NormalTok{  ) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ungroup}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{complete}\NormalTok{(}\AttributeTok{Term\_Name =}\NormalTok{ available\_terms\_df}\SpecialCharTok{$}\NormalTok{Term\_Name) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{replace\_na}\NormalTok{(}\FunctionTok{list}\NormalTok{(}\AttributeTok{Count =} \DecValTok{0}\NormalTok{, }\AttributeTok{Percentage =} \DecValTok{0}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{arrange}\NormalTok{(}\FunctionTok{desc}\NormalTok{(Percentage)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Ranking =} \FunctionTok{row\_number}\NormalTok{())}

\CommentTok{\# Join the data frames to calculate surplus or deficit and create the label}
\NormalTok{top\_5\_preference\_complete }\OtherTok{\textless{}{-}} \FunctionTok{left\_join}\NormalTok{(top\_5\_preference, available\_terms\_df, }\AttributeTok{by =} \StringTok{"Term\_Name"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{Surplus\_Deficit =}\NormalTok{ Number\_of\_Available\_Terms }\SpecialCharTok{{-}}\NormalTok{ Count}
\NormalTok{  )}

\CommentTok{\# Use gt to display the results, excluding the raw Surplus\_Deficit column}
\NormalTok{top\_5\_gt\_BASIC }\OtherTok{\textless{}{-}} \FunctionTok{gt}\NormalTok{(top\_5\_preference\_complete) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{tab\_header}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"PGY1 Terms Ranked by \% of Top 5 Preference"}
\NormalTok{  ) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{cols\_label}\NormalTok{(}
    \AttributeTok{Term\_Name =} \StringTok{"Term Name"}\NormalTok{,}
    \AttributeTok{Percentage =} \StringTok{"\% Top 5 Preferences"}\NormalTok{,}
    \AttributeTok{Ranking =} \StringTok{"Ranking"}\NormalTok{,}
    \AttributeTok{Count =} \StringTok{"Count"}\NormalTok{,}
    \AttributeTok{Number\_of\_Available\_Terms =} \StringTok{"Terms Available"}\NormalTok{,}
    \AttributeTok{Surplus\_Deficit =} \StringTok{"Surplus/Deficit"}
\NormalTok{  ) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{tab\_spanner}\NormalTok{(}\AttributeTok{label =} \StringTok{"Preferences"}\NormalTok{, }\AttributeTok{columns =} \FunctionTok{c}\NormalTok{(}\StringTok{"Term\_Name"}\NormalTok{, }\StringTok{"Percentage"}\NormalTok{, }\StringTok{"Count"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{cols\_move\_to\_start}\NormalTok{(}\AttributeTok{columns =} \StringTok{"Ranking"}\NormalTok{)}

\CommentTok{\# Print the gt table}
\FunctionTok{print}\NormalTok{(top\_5\_gt\_BASIC)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## <div id="sujvtvwecx" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
##   <style>#sujvtvwecx table {
##   font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
##   -webkit-font-smoothing: antialiased;
##   -moz-osx-font-smoothing: grayscale;
## }
## 
## #sujvtvwecx thead, #sujvtvwecx tbody, #sujvtvwecx tfoot, #sujvtvwecx tr, #sujvtvwecx td, #sujvtvwecx th {
##   border-style: none;
## }
## 
## #sujvtvwecx p {
##   margin: 0;
##   padding: 0;
## }
## 
## #sujvtvwecx .gt_table {
##   display: table;
##   border-collapse: collapse;
##   line-height: normal;
##   margin-left: auto;
##   margin-right: auto;
##   color: #333333;
##   font-size: 16px;
##   font-weight: normal;
##   font-style: normal;
##   background-color: #FFFFFF;
##   width: auto;
##   border-top-style: solid;
##   border-top-width: 2px;
##   border-top-color: #A8A8A8;
##   border-right-style: none;
##   border-right-width: 2px;
##   border-right-color: #D3D3D3;
##   border-bottom-style: solid;
##   border-bottom-width: 2px;
##   border-bottom-color: #A8A8A8;
##   border-left-style: none;
##   border-left-width: 2px;
##   border-left-color: #D3D3D3;
## }
## 
## #sujvtvwecx .gt_caption {
##   padding-top: 4px;
##   padding-bottom: 4px;
## }
## 
## #sujvtvwecx .gt_title {
##   color: #333333;
##   font-size: 125%;
##   font-weight: initial;
##   padding-top: 4px;
##   padding-bottom: 4px;
##   padding-left: 5px;
##   padding-right: 5px;
##   border-bottom-color: #FFFFFF;
##   border-bottom-width: 0;
## }
## 
## #sujvtvwecx .gt_subtitle {
##   color: #333333;
##   font-size: 85%;
##   font-weight: initial;
##   padding-top: 3px;
##   padding-bottom: 5px;
##   padding-left: 5px;
##   padding-right: 5px;
##   border-top-color: #FFFFFF;
##   border-top-width: 0;
## }
## 
## #sujvtvwecx .gt_heading {
##   background-color: #FFFFFF;
##   text-align: center;
##   border-bottom-color: #FFFFFF;
##   border-left-style: none;
##   border-left-width: 1px;
##   border-left-color: #D3D3D3;
##   border-right-style: none;
##   border-right-width: 1px;
##   border-right-color: #D3D3D3;
## }
## 
## #sujvtvwecx .gt_bottom_border {
##   border-bottom-style: solid;
##   border-bottom-width: 2px;
##   border-bottom-color: #D3D3D3;
## }
## 
## #sujvtvwecx .gt_col_headings {
##   border-top-style: solid;
##   border-top-width: 2px;
##   border-top-color: #D3D3D3;
##   border-bottom-style: solid;
##   border-bottom-width: 2px;
##   border-bottom-color: #D3D3D3;
##   border-left-style: none;
##   border-left-width: 1px;
##   border-left-color: #D3D3D3;
##   border-right-style: none;
##   border-right-width: 1px;
##   border-right-color: #D3D3D3;
## }
## 
## #sujvtvwecx .gt_col_heading {
##   color: #333333;
##   background-color: #FFFFFF;
##   font-size: 100%;
##   font-weight: normal;
##   text-transform: inherit;
##   border-left-style: none;
##   border-left-width: 1px;
##   border-left-color: #D3D3D3;
##   border-right-style: none;
##   border-right-width: 1px;
##   border-right-color: #D3D3D3;
##   vertical-align: bottom;
##   padding-top: 5px;
##   padding-bottom: 6px;
##   padding-left: 5px;
##   padding-right: 5px;
##   overflow-x: hidden;
## }
## 
## #sujvtvwecx .gt_column_spanner_outer {
##   color: #333333;
##   background-color: #FFFFFF;
##   font-size: 100%;
##   font-weight: normal;
##   text-transform: inherit;
##   padding-top: 0;
##   padding-bottom: 0;
##   padding-left: 4px;
##   padding-right: 4px;
## }
## 
## #sujvtvwecx .gt_column_spanner_outer:first-child {
##   padding-left: 0;
## }
## 
## #sujvtvwecx .gt_column_spanner_outer:last-child {
##   padding-right: 0;
## }
## 
## #sujvtvwecx .gt_column_spanner {
##   border-bottom-style: solid;
##   border-bottom-width: 2px;
##   border-bottom-color: #D3D3D3;
##   vertical-align: bottom;
##   padding-top: 5px;
##   padding-bottom: 5px;
##   overflow-x: hidden;
##   display: inline-block;
##   width: 100%;
## }
## 
## #sujvtvwecx .gt_spanner_row {
##   border-bottom-style: hidden;
## }
## 
## #sujvtvwecx .gt_group_heading {
##   padding-top: 8px;
##   padding-bottom: 8px;
##   padding-left: 5px;
##   padding-right: 5px;
##   color: #333333;
##   background-color: #FFFFFF;
##   font-size: 100%;
##   font-weight: initial;
##   text-transform: inherit;
##   border-top-style: solid;
##   border-top-width: 2px;
##   border-top-color: #D3D3D3;
##   border-bottom-style: solid;
##   border-bottom-width: 2px;
##   border-bottom-color: #D3D3D3;
##   border-left-style: none;
##   border-left-width: 1px;
##   border-left-color: #D3D3D3;
##   border-right-style: none;
##   border-right-width: 1px;
##   border-right-color: #D3D3D3;
##   vertical-align: middle;
##   text-align: left;
## }
## 
## #sujvtvwecx .gt_empty_group_heading {
##   padding: 0.5px;
##   color: #333333;
##   background-color: #FFFFFF;
##   font-size: 100%;
##   font-weight: initial;
##   border-top-style: solid;
##   border-top-width: 2px;
##   border-top-color: #D3D3D3;
##   border-bottom-style: solid;
##   border-bottom-width: 2px;
##   border-bottom-color: #D3D3D3;
##   vertical-align: middle;
## }
## 
## #sujvtvwecx .gt_from_md > :first-child {
##   margin-top: 0;
## }
## 
## #sujvtvwecx .gt_from_md > :last-child {
##   margin-bottom: 0;
## }
## 
## #sujvtvwecx .gt_row {
##   padding-top: 8px;
##   padding-bottom: 8px;
##   padding-left: 5px;
##   padding-right: 5px;
##   margin: 10px;
##   border-top-style: solid;
##   border-top-width: 1px;
##   border-top-color: #D3D3D3;
##   border-left-style: none;
##   border-left-width: 1px;
##   border-left-color: #D3D3D3;
##   border-right-style: none;
##   border-right-width: 1px;
##   border-right-color: #D3D3D3;
##   vertical-align: middle;
##   overflow-x: hidden;
## }
## 
## #sujvtvwecx .gt_stub {
##   color: #333333;
##   background-color: #FFFFFF;
##   font-size: 100%;
##   font-weight: initial;
##   text-transform: inherit;
##   border-right-style: solid;
##   border-right-width: 2px;
##   border-right-color: #D3D3D3;
##   padding-left: 5px;
##   padding-right: 5px;
## }
## 
## #sujvtvwecx .gt_stub_row_group {
##   color: #333333;
##   background-color: #FFFFFF;
##   font-size: 100%;
##   font-weight: initial;
##   text-transform: inherit;
##   border-right-style: solid;
##   border-right-width: 2px;
##   border-right-color: #D3D3D3;
##   padding-left: 5px;
##   padding-right: 5px;
##   vertical-align: top;
## }
## 
## #sujvtvwecx .gt_row_group_first td {
##   border-top-width: 2px;
## }
## 
## #sujvtvwecx .gt_row_group_first th {
##   border-top-width: 2px;
## }
## 
## #sujvtvwecx .gt_summary_row {
##   color: #333333;
##   background-color: #FFFFFF;
##   text-transform: inherit;
##   padding-top: 8px;
##   padding-bottom: 8px;
##   padding-left: 5px;
##   padding-right: 5px;
## }
## 
## #sujvtvwecx .gt_first_summary_row {
##   border-top-style: solid;
##   border-top-color: #D3D3D3;
## }
## 
## #sujvtvwecx .gt_first_summary_row.thick {
##   border-top-width: 2px;
## }
## 
## #sujvtvwecx .gt_last_summary_row {
##   padding-top: 8px;
##   padding-bottom: 8px;
##   padding-left: 5px;
##   padding-right: 5px;
##   border-bottom-style: solid;
##   border-bottom-width: 2px;
##   border-bottom-color: #D3D3D3;
## }
## 
## #sujvtvwecx .gt_grand_summary_row {
##   color: #333333;
##   background-color: #FFFFFF;
##   text-transform: inherit;
##   padding-top: 8px;
##   padding-bottom: 8px;
##   padding-left: 5px;
##   padding-right: 5px;
## }
## 
## #sujvtvwecx .gt_first_grand_summary_row {
##   padding-top: 8px;
##   padding-bottom: 8px;
##   padding-left: 5px;
##   padding-right: 5px;
##   border-top-style: double;
##   border-top-width: 6px;
##   border-top-color: #D3D3D3;
## }
## 
## #sujvtvwecx .gt_last_grand_summary_row_top {
##   padding-top: 8px;
##   padding-bottom: 8px;
##   padding-left: 5px;
##   padding-right: 5px;
##   border-bottom-style: double;
##   border-bottom-width: 6px;
##   border-bottom-color: #D3D3D3;
## }
## 
## #sujvtvwecx .gt_striped {
##   background-color: rgba(128, 128, 128, 0.05);
## }
## 
## #sujvtvwecx .gt_table_body {
##   border-top-style: solid;
##   border-top-width: 2px;
##   border-top-color: #D3D3D3;
##   border-bottom-style: solid;
##   border-bottom-width: 2px;
##   border-bottom-color: #D3D3D3;
## }
## 
## #sujvtvwecx .gt_footnotes {
##   color: #333333;
##   background-color: #FFFFFF;
##   border-bottom-style: none;
##   border-bottom-width: 2px;
##   border-bottom-color: #D3D3D3;
##   border-left-style: none;
##   border-left-width: 2px;
##   border-left-color: #D3D3D3;
##   border-right-style: none;
##   border-right-width: 2px;
##   border-right-color: #D3D3D3;
## }
## 
## #sujvtvwecx .gt_footnote {
##   margin: 0px;
##   font-size: 90%;
##   padding-top: 4px;
##   padding-bottom: 4px;
##   padding-left: 5px;
##   padding-right: 5px;
## }
## 
## #sujvtvwecx .gt_sourcenotes {
##   color: #333333;
##   background-color: #FFFFFF;
##   border-bottom-style: none;
##   border-bottom-width: 2px;
##   border-bottom-color: #D3D3D3;
##   border-left-style: none;
##   border-left-width: 2px;
##   border-left-color: #D3D3D3;
##   border-right-style: none;
##   border-right-width: 2px;
##   border-right-color: #D3D3D3;
## }
## 
## #sujvtvwecx .gt_sourcenote {
##   font-size: 90%;
##   padding-top: 4px;
##   padding-bottom: 4px;
##   padding-left: 5px;
##   padding-right: 5px;
## }
## 
## #sujvtvwecx .gt_left {
##   text-align: left;
## }
## 
## #sujvtvwecx .gt_center {
##   text-align: center;
## }
## 
## #sujvtvwecx .gt_right {
##   text-align: right;
##   font-variant-numeric: tabular-nums;
## }
## 
## #sujvtvwecx .gt_font_normal {
##   font-weight: normal;
## }
## 
## #sujvtvwecx .gt_font_bold {
##   font-weight: bold;
## }
## 
## #sujvtvwecx .gt_font_italic {
##   font-style: italic;
## }
## 
## #sujvtvwecx .gt_super {
##   font-size: 65%;
## }
## 
## #sujvtvwecx .gt_footnote_marks {
##   font-size: 75%;
##   vertical-align: 0.4em;
##   position: initial;
## }
## 
## #sujvtvwecx .gt_asterisk {
##   font-size: 100%;
##   vertical-align: 0;
## }
## 
## #sujvtvwecx .gt_indent_1 {
##   text-indent: 5px;
## }
## 
## #sujvtvwecx .gt_indent_2 {
##   text-indent: 10px;
## }
## 
## #sujvtvwecx .gt_indent_3 {
##   text-indent: 15px;
## }
## 
## #sujvtvwecx .gt_indent_4 {
##   text-indent: 20px;
## }
## 
## #sujvtvwecx .gt_indent_5 {
##   text-indent: 25px;
## }
## </style>
##   <table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
##   <thead>
##     <tr class="gt_heading">
##       <td colspan="6" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>PGY1 Terms Ranked by % of Top 5 Preference</td>
##     </tr>
##     
##     <tr class="gt_col_headings gt_spanner_row">
##       <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col" id="Ranking">Ranking</th>
##       <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="3" scope="colgroup" id="Preferences">
##         <span class="gt_column_spanner">Preferences</span>
##       </th>
##       <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col" id="Terms Available">Terms Available</th>
##       <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col" id="Surplus/Deficit">Surplus/Deficit</th>
##     </tr>
##     <tr class="gt_col_headings">
##       <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Term Name">Term Name</th>
##       <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="% Top 5 Preferences">% Top 5 Preferences</th>
##       <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Count">Count</th>
##     </tr>
##   </thead>
##   <tbody class="gt_table_body">
##     <tr><td headers="Ranking" class="gt_row gt_right">1</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Emergency (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">57.1</td>
## <td headers="Count" class="gt_row gt_right">48</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">37</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-11</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">2</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Obstetrics &amp; Gynaecology (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">27.4</td>
## <td headers="Count" class="gt_row gt_right">23</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">5</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-18</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">3</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Medicine - Cardiology (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">25.0</td>
## <td headers="Count" class="gt_row gt_right">21</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">8</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-13</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">4</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Medicine - Respiratory (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">19.0</td>
## <td headers="Count" class="gt_row gt_right">16</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">7</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-9</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">5</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH General Surgery / Trauma (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">17.9</td>
## <td headers="Count" class="gt_row gt_right">15</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">5</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-10</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">6</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Medicine - Rheumatology (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">16.7</td>
## <td headers="Count" class="gt_row gt_right">14</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">1</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-13</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">7</td>
## <td headers="Term_Name" class="gt_row gt_left">CMN Medicine - Cardiology (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">15.5</td>
## <td headers="Count" class="gt_row gt_right">13</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">3</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-10</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">8</td>
## <td headers="Term_Name" class="gt_row gt_left">CMN Medicine - Gastroenterology with Drug &amp; Alcohol (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">15.5</td>
## <td headers="Count" class="gt_row gt_right">13</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">2</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-11</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">9</td>
## <td headers="Term_Name" class="gt_row gt_left">HNE Mental Health &amp; Substance Use Service - Mater Hospital (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">15.5</td>
## <td headers="Count" class="gt_row gt_right">13</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">5</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-8</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">10</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Medicine - Dermatology (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">15.5</td>
## <td headers="Count" class="gt_row gt_right">13</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">2</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-11</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">11</td>
## <td headers="Term_Name" class="gt_row gt_left">CMN Medicine - Haematology (01) (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">13.1</td>
## <td headers="Count" class="gt_row gt_right">11</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">5</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-6</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">12</td>
## <td headers="Term_Name" class="gt_row gt_left">HNE Mental Health Lake Macquarie Ward - Mater hospital (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">13.1</td>
## <td headers="Count" class="gt_row gt_right">11</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">5</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-6</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">13</td>
## <td headers="Term_Name" class="gt_row gt_left">HNE Mental Health Newcastle Inpatient Unit - Mater Hospital (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">13.1</td>
## <td headers="Count" class="gt_row gt_right">11</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">5</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-6</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">14</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH General Medicine (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">11.9</td>
## <td headers="Count" class="gt_row gt_right">10</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">20</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">10</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">15</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Medicine - Infectious Disease (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">11.9</td>
## <td headers="Count" class="gt_row gt_right">10</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">3</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-7</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">16</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Surgery - Urology (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">11.9</td>
## <td headers="Count" class="gt_row gt_right">10</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">10</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">0</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">17</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Medicine - Gastroenterology (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">10.7</td>
## <td headers="Count" class="gt_row gt_right">9</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">8</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-1</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">18</td>
## <td headers="Term_Name" class="gt_row gt_left">CMN Medicine - Medical Oncology (01) (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">9.5</td>
## <td headers="Count" class="gt_row gt_right">8</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">5</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-3</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">19</td>
## <td headers="Term_Name" class="gt_row gt_left">CMN Palliative Care (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">9.5</td>
## <td headers="Count" class="gt_row gt_right">8</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">2</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-6</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">20</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Acute General Surgery Unit (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">9.5</td>
## <td headers="Count" class="gt_row gt_right">8</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">10</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">2</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">21</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Surgery - Ear, Nose and Throat (ENT) (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">9.5</td>
## <td headers="Count" class="gt_row gt_right">8</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">2</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-6</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">22</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH General Surgery / Hepatopancreatobiliary and Upper GI Surgery (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">8.3</td>
## <td headers="Count" class="gt_row gt_right">7</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">3</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-4</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">23</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Medicine - MACU (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">8.3</td>
## <td headers="Count" class="gt_row gt_right">7</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">2</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-5</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">24</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Medicine - Nephrology &amp; Dialysis (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">8.3</td>
## <td headers="Count" class="gt_row gt_right">7</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">4</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-3</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">25</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Surgery - Neurosurgery (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">8.3</td>
## <td headers="Count" class="gt_row gt_right">7</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">10</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">3</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">26</td>
## <td headers="Term_Name" class="gt_row gt_left">BDH Drug and Alcohol Clinical Services (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">7.1</td>
## <td headers="Count" class="gt_row gt_right">6</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">2</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-4</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">27</td>
## <td headers="Term_Name" class="gt_row gt_left">BDH Emergency (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">7.1</td>
## <td headers="Count" class="gt_row gt_right">6</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">8</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">2</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">28</td>
## <td headers="Term_Name" class="gt_row gt_left">CMN Emergency (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">7.1</td>
## <td headers="Count" class="gt_row gt_right">6</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">15</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">9</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">29</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Medicine - Neurology (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">7.1</td>
## <td headers="Count" class="gt_row gt_right">6</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">4</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-2</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">30</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Surgery - Cardiothoracic Surgery (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">7.1</td>
## <td headers="Count" class="gt_row gt_right">6</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">4</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-2</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">31</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Surgery - Oral Maxillofacial (OMF) (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">7.1</td>
## <td headers="Count" class="gt_row gt_right">6</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">2</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-4</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">32</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Surgery - Orthopaedics (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">7.1</td>
## <td headers="Count" class="gt_row gt_right">6</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">25</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">19</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">33</td>
## <td headers="Term_Name" class="gt_row gt_left">CMN Surgery (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">6.0</td>
## <td headers="Count" class="gt_row gt_right">5</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">10</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">5</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">34</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Surgery - Orthopaedics (Team 6) (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">6.0</td>
## <td headers="Count" class="gt_row gt_right">5</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">3</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-2</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">35</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Surgery - Vascular (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">6.0</td>
## <td headers="Count" class="gt_row gt_right">5</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">8</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">3</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">36</td>
## <td headers="Term_Name" class="gt_row gt_left">TRRH General Medicine 08 (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">6.0</td>
## <td headers="Count" class="gt_row gt_right">5</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">3</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-2</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">37</td>
## <td headers="Term_Name" class="gt_row gt_left">HNE Mental Health Older People's Service - Mater Hospital (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">4.8</td>
## <td headers="Count" class="gt_row gt_right">4</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">5</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">1</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">38</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH General Surgery / Colorectal (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">4.8</td>
## <td headers="Count" class="gt_row gt_right">4</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">2</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-2</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">39</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Medicine - Rehabilitation (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">4.8</td>
## <td headers="Count" class="gt_row gt_right">4</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">9</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">5</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">40</td>
## <td headers="Term_Name" class="gt_row gt_left">BDH Acute General Medicine &amp; Cardiology (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">3.6</td>
## <td headers="Count" class="gt_row gt_right">3</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">3</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">0</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">41</td>
## <td headers="Term_Name" class="gt_row gt_left">CMN General Medicine (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">3.6</td>
## <td headers="Count" class="gt_row gt_right">3</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">20</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">17</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">42</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH General Surgery / Upper GI (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">3.6</td>
## <td headers="Count" class="gt_row gt_right">3</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">2</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-1</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">43</td>
## <td headers="Term_Name" class="gt_row gt_left">MBH Emergency (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">3.6</td>
## <td headers="Count" class="gt_row gt_right">3</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">4</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">1</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">44</td>
## <td headers="Term_Name" class="gt_row gt_left">MH Emergency (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">3.6</td>
## <td headers="Count" class="gt_row gt_right">3</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">25</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">22</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">45</td>
## <td headers="Term_Name" class="gt_row gt_left">BDH Acute General Medicine (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">2.4</td>
## <td headers="Count" class="gt_row gt_right">2</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">5</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">3</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">46</td>
## <td headers="Term_Name" class="gt_row gt_left">MH  Medicine - Cardiology (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">2.4</td>
## <td headers="Count" class="gt_row gt_right">2</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">3</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">1</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">47</td>
## <td headers="Term_Name" class="gt_row gt_left">MH General Medicine (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">2.4</td>
## <td headers="Count" class="gt_row gt_right">2</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">15</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">13</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">48</td>
## <td headers="Term_Name" class="gt_row gt_left">BDH Surgery (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">1.2</td>
## <td headers="Count" class="gt_row gt_right">1</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">5</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">4</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">49</td>
## <td headers="Term_Name" class="gt_row gt_left">MH KK Rehabilitation (PGY 1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">1.2</td>
## <td headers="Count" class="gt_row gt_right">1</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">5</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">4</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">50</td>
## <td headers="Term_Name" class="gt_row gt_left">TRRH Surgery - Orthopaedics 02 (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">1.2</td>
## <td headers="Count" class="gt_row gt_right">1</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">3</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">2</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">51</td>
## <td headers="Term_Name" class="gt_row gt_left">TRRH Surgery C (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">1.2</td>
## <td headers="Count" class="gt_row gt_right">1</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">2</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">1</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">52</td>
## <td headers="Term_Name" class="gt_row gt_left">BDH Acute General Medicine &amp; Rehabilitation (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">0.0</td>
## <td headers="Count" class="gt_row gt_right">0</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">2</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">2</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">53</td>
## <td headers="Term_Name" class="gt_row gt_left">BDH After Hours Internal Relief (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">0.0</td>
## <td headers="Count" class="gt_row gt_right">0</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">8</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">8</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">54</td>
## <td headers="Term_Name" class="gt_row gt_left">BDH Sub-Acute General Medicine (Team 5) (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">0.0</td>
## <td headers="Count" class="gt_row gt_right">0</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">2</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">2</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">55</td>
## <td headers="Term_Name" class="gt_row gt_left">CMN Relief (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">0.0</td>
## <td headers="Count" class="gt_row gt_right">0</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">18</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">18</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">56</td>
## <td headers="Term_Name" class="gt_row gt_left">HNE Relief (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">0.0</td>
## <td headers="Count" class="gt_row gt_right">0</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">50</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">50</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">57</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Medicine Relief (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">0.0</td>
## <td headers="Count" class="gt_row gt_right">0</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">15</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">15</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">58</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Surgery Relief (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">0.0</td>
## <td headers="Count" class="gt_row gt_right">0</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">10</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">10</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">59</td>
## <td headers="Term_Name" class="gt_row gt_left">MH General Surgery (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">0.0</td>
## <td headers="Count" class="gt_row gt_right">0</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">10</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">10</td></tr>
##   </tbody>
##   
##   
## </table>
## </div>
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# REFRAMING THE QUESTION {-} WHAT IS A SOUGHT AFTER TERM? \#\#}

\DocumentationTok{\#\# Ranking by Number of spots \#\#}

\CommentTok{\# Assuming top\_5\_preference\_complete already has the Surplus\_Deficit column calculated}
\NormalTok{top\_5\_preference\_complete }\OtherTok{\textless{}{-}}\NormalTok{ top\_5\_preference\_complete }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{arrange}\NormalTok{(Surplus\_Deficit) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Ranking =} \FunctionTok{row\_number}\NormalTok{())}

\CommentTok{\# Use gt to display the results}
\NormalTok{top\_5\_gt\_INTER }\OtherTok{\textless{}{-}} \FunctionTok{gt}\NormalTok{(top\_5\_preference\_complete) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{tab\_header}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"PGY1 Terms Ranked by Total Surplus/Deficit"}
\NormalTok{  ) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{cols\_label}\NormalTok{(}
    \AttributeTok{Term\_Name =} \StringTok{"Term Name"}\NormalTok{,}
    \AttributeTok{Percentage =} \StringTok{"\% Top 5 Preferences"}\NormalTok{,}
    \AttributeTok{Ranking =} \StringTok{"Ranking"}\NormalTok{,}
    \AttributeTok{Count =} \StringTok{"Count"}\NormalTok{,}
    \AttributeTok{Number\_of\_Available\_Terms =} \StringTok{"Terms Available"}\NormalTok{,}
    \AttributeTok{Surplus\_Deficit =} \StringTok{"Surplus/Deficit"}
\NormalTok{  ) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{tab\_spanner}\NormalTok{(}\AttributeTok{label =} \StringTok{"Preferences"}\NormalTok{, }\AttributeTok{columns =} \FunctionTok{c}\NormalTok{(}\StringTok{"Term\_Name"}\NormalTok{, }\StringTok{"Percentage"}\NormalTok{, }\StringTok{"Count"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{cols\_move\_to\_start}\NormalTok{(}\AttributeTok{columns =} \StringTok{"Ranking"}\NormalTok{)}

\CommentTok{\# Print the gt table}
\FunctionTok{print}\NormalTok{(top\_5\_gt\_INTER)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## <div id="kcbddualgo" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
##   <style>#kcbddualgo table {
##   font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
##   -webkit-font-smoothing: antialiased;
##   -moz-osx-font-smoothing: grayscale;
## }
## 
## #kcbddualgo thead, #kcbddualgo tbody, #kcbddualgo tfoot, #kcbddualgo tr, #kcbddualgo td, #kcbddualgo th {
##   border-style: none;
## }
## 
## #kcbddualgo p {
##   margin: 0;
##   padding: 0;
## }
## 
## #kcbddualgo .gt_table {
##   display: table;
##   border-collapse: collapse;
##   line-height: normal;
##   margin-left: auto;
##   margin-right: auto;
##   color: #333333;
##   font-size: 16px;
##   font-weight: normal;
##   font-style: normal;
##   background-color: #FFFFFF;
##   width: auto;
##   border-top-style: solid;
##   border-top-width: 2px;
##   border-top-color: #A8A8A8;
##   border-right-style: none;
##   border-right-width: 2px;
##   border-right-color: #D3D3D3;
##   border-bottom-style: solid;
##   border-bottom-width: 2px;
##   border-bottom-color: #A8A8A8;
##   border-left-style: none;
##   border-left-width: 2px;
##   border-left-color: #D3D3D3;
## }
## 
## #kcbddualgo .gt_caption {
##   padding-top: 4px;
##   padding-bottom: 4px;
## }
## 
## #kcbddualgo .gt_title {
##   color: #333333;
##   font-size: 125%;
##   font-weight: initial;
##   padding-top: 4px;
##   padding-bottom: 4px;
##   padding-left: 5px;
##   padding-right: 5px;
##   border-bottom-color: #FFFFFF;
##   border-bottom-width: 0;
## }
## 
## #kcbddualgo .gt_subtitle {
##   color: #333333;
##   font-size: 85%;
##   font-weight: initial;
##   padding-top: 3px;
##   padding-bottom: 5px;
##   padding-left: 5px;
##   padding-right: 5px;
##   border-top-color: #FFFFFF;
##   border-top-width: 0;
## }
## 
## #kcbddualgo .gt_heading {
##   background-color: #FFFFFF;
##   text-align: center;
##   border-bottom-color: #FFFFFF;
##   border-left-style: none;
##   border-left-width: 1px;
##   border-left-color: #D3D3D3;
##   border-right-style: none;
##   border-right-width: 1px;
##   border-right-color: #D3D3D3;
## }
## 
## #kcbddualgo .gt_bottom_border {
##   border-bottom-style: solid;
##   border-bottom-width: 2px;
##   border-bottom-color: #D3D3D3;
## }
## 
## #kcbddualgo .gt_col_headings {
##   border-top-style: solid;
##   border-top-width: 2px;
##   border-top-color: #D3D3D3;
##   border-bottom-style: solid;
##   border-bottom-width: 2px;
##   border-bottom-color: #D3D3D3;
##   border-left-style: none;
##   border-left-width: 1px;
##   border-left-color: #D3D3D3;
##   border-right-style: none;
##   border-right-width: 1px;
##   border-right-color: #D3D3D3;
## }
## 
## #kcbddualgo .gt_col_heading {
##   color: #333333;
##   background-color: #FFFFFF;
##   font-size: 100%;
##   font-weight: normal;
##   text-transform: inherit;
##   border-left-style: none;
##   border-left-width: 1px;
##   border-left-color: #D3D3D3;
##   border-right-style: none;
##   border-right-width: 1px;
##   border-right-color: #D3D3D3;
##   vertical-align: bottom;
##   padding-top: 5px;
##   padding-bottom: 6px;
##   padding-left: 5px;
##   padding-right: 5px;
##   overflow-x: hidden;
## }
## 
## #kcbddualgo .gt_column_spanner_outer {
##   color: #333333;
##   background-color: #FFFFFF;
##   font-size: 100%;
##   font-weight: normal;
##   text-transform: inherit;
##   padding-top: 0;
##   padding-bottom: 0;
##   padding-left: 4px;
##   padding-right: 4px;
## }
## 
## #kcbddualgo .gt_column_spanner_outer:first-child {
##   padding-left: 0;
## }
## 
## #kcbddualgo .gt_column_spanner_outer:last-child {
##   padding-right: 0;
## }
## 
## #kcbddualgo .gt_column_spanner {
##   border-bottom-style: solid;
##   border-bottom-width: 2px;
##   border-bottom-color: #D3D3D3;
##   vertical-align: bottom;
##   padding-top: 5px;
##   padding-bottom: 5px;
##   overflow-x: hidden;
##   display: inline-block;
##   width: 100%;
## }
## 
## #kcbddualgo .gt_spanner_row {
##   border-bottom-style: hidden;
## }
## 
## #kcbddualgo .gt_group_heading {
##   padding-top: 8px;
##   padding-bottom: 8px;
##   padding-left: 5px;
##   padding-right: 5px;
##   color: #333333;
##   background-color: #FFFFFF;
##   font-size: 100%;
##   font-weight: initial;
##   text-transform: inherit;
##   border-top-style: solid;
##   border-top-width: 2px;
##   border-top-color: #D3D3D3;
##   border-bottom-style: solid;
##   border-bottom-width: 2px;
##   border-bottom-color: #D3D3D3;
##   border-left-style: none;
##   border-left-width: 1px;
##   border-left-color: #D3D3D3;
##   border-right-style: none;
##   border-right-width: 1px;
##   border-right-color: #D3D3D3;
##   vertical-align: middle;
##   text-align: left;
## }
## 
## #kcbddualgo .gt_empty_group_heading {
##   padding: 0.5px;
##   color: #333333;
##   background-color: #FFFFFF;
##   font-size: 100%;
##   font-weight: initial;
##   border-top-style: solid;
##   border-top-width: 2px;
##   border-top-color: #D3D3D3;
##   border-bottom-style: solid;
##   border-bottom-width: 2px;
##   border-bottom-color: #D3D3D3;
##   vertical-align: middle;
## }
## 
## #kcbddualgo .gt_from_md > :first-child {
##   margin-top: 0;
## }
## 
## #kcbddualgo .gt_from_md > :last-child {
##   margin-bottom: 0;
## }
## 
## #kcbddualgo .gt_row {
##   padding-top: 8px;
##   padding-bottom: 8px;
##   padding-left: 5px;
##   padding-right: 5px;
##   margin: 10px;
##   border-top-style: solid;
##   border-top-width: 1px;
##   border-top-color: #D3D3D3;
##   border-left-style: none;
##   border-left-width: 1px;
##   border-left-color: #D3D3D3;
##   border-right-style: none;
##   border-right-width: 1px;
##   border-right-color: #D3D3D3;
##   vertical-align: middle;
##   overflow-x: hidden;
## }
## 
## #kcbddualgo .gt_stub {
##   color: #333333;
##   background-color: #FFFFFF;
##   font-size: 100%;
##   font-weight: initial;
##   text-transform: inherit;
##   border-right-style: solid;
##   border-right-width: 2px;
##   border-right-color: #D3D3D3;
##   padding-left: 5px;
##   padding-right: 5px;
## }
## 
## #kcbddualgo .gt_stub_row_group {
##   color: #333333;
##   background-color: #FFFFFF;
##   font-size: 100%;
##   font-weight: initial;
##   text-transform: inherit;
##   border-right-style: solid;
##   border-right-width: 2px;
##   border-right-color: #D3D3D3;
##   padding-left: 5px;
##   padding-right: 5px;
##   vertical-align: top;
## }
## 
## #kcbddualgo .gt_row_group_first td {
##   border-top-width: 2px;
## }
## 
## #kcbddualgo .gt_row_group_first th {
##   border-top-width: 2px;
## }
## 
## #kcbddualgo .gt_summary_row {
##   color: #333333;
##   background-color: #FFFFFF;
##   text-transform: inherit;
##   padding-top: 8px;
##   padding-bottom: 8px;
##   padding-left: 5px;
##   padding-right: 5px;
## }
## 
## #kcbddualgo .gt_first_summary_row {
##   border-top-style: solid;
##   border-top-color: #D3D3D3;
## }
## 
## #kcbddualgo .gt_first_summary_row.thick {
##   border-top-width: 2px;
## }
## 
## #kcbddualgo .gt_last_summary_row {
##   padding-top: 8px;
##   padding-bottom: 8px;
##   padding-left: 5px;
##   padding-right: 5px;
##   border-bottom-style: solid;
##   border-bottom-width: 2px;
##   border-bottom-color: #D3D3D3;
## }
## 
## #kcbddualgo .gt_grand_summary_row {
##   color: #333333;
##   background-color: #FFFFFF;
##   text-transform: inherit;
##   padding-top: 8px;
##   padding-bottom: 8px;
##   padding-left: 5px;
##   padding-right: 5px;
## }
## 
## #kcbddualgo .gt_first_grand_summary_row {
##   padding-top: 8px;
##   padding-bottom: 8px;
##   padding-left: 5px;
##   padding-right: 5px;
##   border-top-style: double;
##   border-top-width: 6px;
##   border-top-color: #D3D3D3;
## }
## 
## #kcbddualgo .gt_last_grand_summary_row_top {
##   padding-top: 8px;
##   padding-bottom: 8px;
##   padding-left: 5px;
##   padding-right: 5px;
##   border-bottom-style: double;
##   border-bottom-width: 6px;
##   border-bottom-color: #D3D3D3;
## }
## 
## #kcbddualgo .gt_striped {
##   background-color: rgba(128, 128, 128, 0.05);
## }
## 
## #kcbddualgo .gt_table_body {
##   border-top-style: solid;
##   border-top-width: 2px;
##   border-top-color: #D3D3D3;
##   border-bottom-style: solid;
##   border-bottom-width: 2px;
##   border-bottom-color: #D3D3D3;
## }
## 
## #kcbddualgo .gt_footnotes {
##   color: #333333;
##   background-color: #FFFFFF;
##   border-bottom-style: none;
##   border-bottom-width: 2px;
##   border-bottom-color: #D3D3D3;
##   border-left-style: none;
##   border-left-width: 2px;
##   border-left-color: #D3D3D3;
##   border-right-style: none;
##   border-right-width: 2px;
##   border-right-color: #D3D3D3;
## }
## 
## #kcbddualgo .gt_footnote {
##   margin: 0px;
##   font-size: 90%;
##   padding-top: 4px;
##   padding-bottom: 4px;
##   padding-left: 5px;
##   padding-right: 5px;
## }
## 
## #kcbddualgo .gt_sourcenotes {
##   color: #333333;
##   background-color: #FFFFFF;
##   border-bottom-style: none;
##   border-bottom-width: 2px;
##   border-bottom-color: #D3D3D3;
##   border-left-style: none;
##   border-left-width: 2px;
##   border-left-color: #D3D3D3;
##   border-right-style: none;
##   border-right-width: 2px;
##   border-right-color: #D3D3D3;
## }
## 
## #kcbddualgo .gt_sourcenote {
##   font-size: 90%;
##   padding-top: 4px;
##   padding-bottom: 4px;
##   padding-left: 5px;
##   padding-right: 5px;
## }
## 
## #kcbddualgo .gt_left {
##   text-align: left;
## }
## 
## #kcbddualgo .gt_center {
##   text-align: center;
## }
## 
## #kcbddualgo .gt_right {
##   text-align: right;
##   font-variant-numeric: tabular-nums;
## }
## 
## #kcbddualgo .gt_font_normal {
##   font-weight: normal;
## }
## 
## #kcbddualgo .gt_font_bold {
##   font-weight: bold;
## }
## 
## #kcbddualgo .gt_font_italic {
##   font-style: italic;
## }
## 
## #kcbddualgo .gt_super {
##   font-size: 65%;
## }
## 
## #kcbddualgo .gt_footnote_marks {
##   font-size: 75%;
##   vertical-align: 0.4em;
##   position: initial;
## }
## 
## #kcbddualgo .gt_asterisk {
##   font-size: 100%;
##   vertical-align: 0;
## }
## 
## #kcbddualgo .gt_indent_1 {
##   text-indent: 5px;
## }
## 
## #kcbddualgo .gt_indent_2 {
##   text-indent: 10px;
## }
## 
## #kcbddualgo .gt_indent_3 {
##   text-indent: 15px;
## }
## 
## #kcbddualgo .gt_indent_4 {
##   text-indent: 20px;
## }
## 
## #kcbddualgo .gt_indent_5 {
##   text-indent: 25px;
## }
## </style>
##   <table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
##   <thead>
##     <tr class="gt_heading">
##       <td colspan="6" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>PGY1 Terms Ranked by Total Surplus/Deficit</td>
##     </tr>
##     
##     <tr class="gt_col_headings gt_spanner_row">
##       <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col" id="Ranking">Ranking</th>
##       <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="3" scope="colgroup" id="Preferences">
##         <span class="gt_column_spanner">Preferences</span>
##       </th>
##       <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col" id="Terms Available">Terms Available</th>
##       <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col" id="Surplus/Deficit">Surplus/Deficit</th>
##     </tr>
##     <tr class="gt_col_headings">
##       <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Term Name">Term Name</th>
##       <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="% Top 5 Preferences">% Top 5 Preferences</th>
##       <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Count">Count</th>
##     </tr>
##   </thead>
##   <tbody class="gt_table_body">
##     <tr><td headers="Ranking" class="gt_row gt_right">1</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Obstetrics &amp; Gynaecology (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">27.4</td>
## <td headers="Count" class="gt_row gt_right">23</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">5</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-18</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">2</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Medicine - Cardiology (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">25.0</td>
## <td headers="Count" class="gt_row gt_right">21</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">8</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-13</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">3</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Medicine - Rheumatology (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">16.7</td>
## <td headers="Count" class="gt_row gt_right">14</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">1</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-13</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">4</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Emergency (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">57.1</td>
## <td headers="Count" class="gt_row gt_right">48</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">37</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-11</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">5</td>
## <td headers="Term_Name" class="gt_row gt_left">CMN Medicine - Gastroenterology with Drug &amp; Alcohol (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">15.5</td>
## <td headers="Count" class="gt_row gt_right">13</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">2</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-11</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">6</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Medicine - Dermatology (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">15.5</td>
## <td headers="Count" class="gt_row gt_right">13</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">2</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-11</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">7</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH General Surgery / Trauma (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">17.9</td>
## <td headers="Count" class="gt_row gt_right">15</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">5</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-10</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">8</td>
## <td headers="Term_Name" class="gt_row gt_left">CMN Medicine - Cardiology (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">15.5</td>
## <td headers="Count" class="gt_row gt_right">13</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">3</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-10</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">9</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Medicine - Respiratory (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">19.0</td>
## <td headers="Count" class="gt_row gt_right">16</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">7</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-9</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">10</td>
## <td headers="Term_Name" class="gt_row gt_left">HNE Mental Health &amp; Substance Use Service - Mater Hospital (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">15.5</td>
## <td headers="Count" class="gt_row gt_right">13</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">5</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-8</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">11</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Medicine - Infectious Disease (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">11.9</td>
## <td headers="Count" class="gt_row gt_right">10</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">3</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-7</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">12</td>
## <td headers="Term_Name" class="gt_row gt_left">CMN Medicine - Haematology (01) (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">13.1</td>
## <td headers="Count" class="gt_row gt_right">11</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">5</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-6</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">13</td>
## <td headers="Term_Name" class="gt_row gt_left">HNE Mental Health Lake Macquarie Ward - Mater hospital (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">13.1</td>
## <td headers="Count" class="gt_row gt_right">11</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">5</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-6</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">14</td>
## <td headers="Term_Name" class="gt_row gt_left">HNE Mental Health Newcastle Inpatient Unit - Mater Hospital (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">13.1</td>
## <td headers="Count" class="gt_row gt_right">11</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">5</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-6</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">15</td>
## <td headers="Term_Name" class="gt_row gt_left">CMN Palliative Care (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">9.5</td>
## <td headers="Count" class="gt_row gt_right">8</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">2</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-6</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">16</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Surgery - Ear, Nose and Throat (ENT) (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">9.5</td>
## <td headers="Count" class="gt_row gt_right">8</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">2</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-6</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">17</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Medicine - MACU (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">8.3</td>
## <td headers="Count" class="gt_row gt_right">7</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">2</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-5</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">18</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH General Surgery / Hepatopancreatobiliary and Upper GI Surgery (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">8.3</td>
## <td headers="Count" class="gt_row gt_right">7</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">3</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-4</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">19</td>
## <td headers="Term_Name" class="gt_row gt_left">BDH Drug and Alcohol Clinical Services (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">7.1</td>
## <td headers="Count" class="gt_row gt_right">6</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">2</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-4</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">20</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Surgery - Oral Maxillofacial (OMF) (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">7.1</td>
## <td headers="Count" class="gt_row gt_right">6</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">2</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-4</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">21</td>
## <td headers="Term_Name" class="gt_row gt_left">CMN Medicine - Medical Oncology (01) (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">9.5</td>
## <td headers="Count" class="gt_row gt_right">8</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">5</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-3</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">22</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Medicine - Nephrology &amp; Dialysis (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">8.3</td>
## <td headers="Count" class="gt_row gt_right">7</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">4</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-3</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">23</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Medicine - Neurology (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">7.1</td>
## <td headers="Count" class="gt_row gt_right">6</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">4</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-2</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">24</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Surgery - Cardiothoracic Surgery (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">7.1</td>
## <td headers="Count" class="gt_row gt_right">6</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">4</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-2</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">25</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Surgery - Orthopaedics (Team 6) (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">6.0</td>
## <td headers="Count" class="gt_row gt_right">5</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">3</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-2</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">26</td>
## <td headers="Term_Name" class="gt_row gt_left">TRRH General Medicine 08 (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">6.0</td>
## <td headers="Count" class="gt_row gt_right">5</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">3</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-2</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">27</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH General Surgery / Colorectal (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">4.8</td>
## <td headers="Count" class="gt_row gt_right">4</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">2</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-2</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">28</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Medicine - Gastroenterology (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">10.7</td>
## <td headers="Count" class="gt_row gt_right">9</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">8</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-1</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">29</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH General Surgery / Upper GI (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">3.6</td>
## <td headers="Count" class="gt_row gt_right">3</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">2</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-1</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">30</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Surgery - Urology (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">11.9</td>
## <td headers="Count" class="gt_row gt_right">10</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">10</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">0</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">31</td>
## <td headers="Term_Name" class="gt_row gt_left">BDH Acute General Medicine &amp; Cardiology (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">3.6</td>
## <td headers="Count" class="gt_row gt_right">3</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">3</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">0</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">32</td>
## <td headers="Term_Name" class="gt_row gt_left">HNE Mental Health Older People's Service - Mater Hospital (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">4.8</td>
## <td headers="Count" class="gt_row gt_right">4</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">5</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">1</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">33</td>
## <td headers="Term_Name" class="gt_row gt_left">MBH Emergency (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">3.6</td>
## <td headers="Count" class="gt_row gt_right">3</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">4</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">1</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">34</td>
## <td headers="Term_Name" class="gt_row gt_left">MH  Medicine - Cardiology (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">2.4</td>
## <td headers="Count" class="gt_row gt_right">2</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">3</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">1</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">35</td>
## <td headers="Term_Name" class="gt_row gt_left">TRRH Surgery C (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">1.2</td>
## <td headers="Count" class="gt_row gt_right">1</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">2</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">1</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">36</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Acute General Surgery Unit (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">9.5</td>
## <td headers="Count" class="gt_row gt_right">8</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">10</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">2</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">37</td>
## <td headers="Term_Name" class="gt_row gt_left">BDH Emergency (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">7.1</td>
## <td headers="Count" class="gt_row gt_right">6</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">8</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">2</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">38</td>
## <td headers="Term_Name" class="gt_row gt_left">TRRH Surgery - Orthopaedics 02 (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">1.2</td>
## <td headers="Count" class="gt_row gt_right">1</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">3</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">2</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">39</td>
## <td headers="Term_Name" class="gt_row gt_left">BDH Acute General Medicine &amp; Rehabilitation (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">0.0</td>
## <td headers="Count" class="gt_row gt_right">0</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">2</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">2</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">40</td>
## <td headers="Term_Name" class="gt_row gt_left">BDH Sub-Acute General Medicine (Team 5) (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">0.0</td>
## <td headers="Count" class="gt_row gt_right">0</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">2</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">2</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">41</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Surgery - Neurosurgery (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">8.3</td>
## <td headers="Count" class="gt_row gt_right">7</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">10</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">3</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">42</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Surgery - Vascular (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">6.0</td>
## <td headers="Count" class="gt_row gt_right">5</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">8</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">3</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">43</td>
## <td headers="Term_Name" class="gt_row gt_left">BDH Acute General Medicine (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">2.4</td>
## <td headers="Count" class="gt_row gt_right">2</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">5</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">3</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">44</td>
## <td headers="Term_Name" class="gt_row gt_left">BDH Surgery (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">1.2</td>
## <td headers="Count" class="gt_row gt_right">1</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">5</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">4</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">45</td>
## <td headers="Term_Name" class="gt_row gt_left">MH KK Rehabilitation (PGY 1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">1.2</td>
## <td headers="Count" class="gt_row gt_right">1</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">5</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">4</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">46</td>
## <td headers="Term_Name" class="gt_row gt_left">CMN Surgery (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">6.0</td>
## <td headers="Count" class="gt_row gt_right">5</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">10</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">5</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">47</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Medicine - Rehabilitation (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">4.8</td>
## <td headers="Count" class="gt_row gt_right">4</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">9</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">5</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">48</td>
## <td headers="Term_Name" class="gt_row gt_left">BDH After Hours Internal Relief (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">0.0</td>
## <td headers="Count" class="gt_row gt_right">0</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">8</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">8</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">49</td>
## <td headers="Term_Name" class="gt_row gt_left">CMN Emergency (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">7.1</td>
## <td headers="Count" class="gt_row gt_right">6</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">15</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">9</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">50</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH General Medicine (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">11.9</td>
## <td headers="Count" class="gt_row gt_right">10</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">20</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">10</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">51</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Surgery Relief (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">0.0</td>
## <td headers="Count" class="gt_row gt_right">0</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">10</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">10</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">52</td>
## <td headers="Term_Name" class="gt_row gt_left">MH General Surgery (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">0.0</td>
## <td headers="Count" class="gt_row gt_right">0</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">10</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">10</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">53</td>
## <td headers="Term_Name" class="gt_row gt_left">MH General Medicine (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">2.4</td>
## <td headers="Count" class="gt_row gt_right">2</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">15</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">13</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">54</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Medicine Relief (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">0.0</td>
## <td headers="Count" class="gt_row gt_right">0</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">15</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">15</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">55</td>
## <td headers="Term_Name" class="gt_row gt_left">CMN General Medicine (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">3.6</td>
## <td headers="Count" class="gt_row gt_right">3</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">20</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">17</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">56</td>
## <td headers="Term_Name" class="gt_row gt_left">CMN Relief (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">0.0</td>
## <td headers="Count" class="gt_row gt_right">0</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">18</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">18</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">57</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Surgery - Orthopaedics (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">7.1</td>
## <td headers="Count" class="gt_row gt_right">6</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">25</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">19</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">58</td>
## <td headers="Term_Name" class="gt_row gt_left">MH Emergency (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">3.6</td>
## <td headers="Count" class="gt_row gt_right">3</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">25</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">22</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">59</td>
## <td headers="Term_Name" class="gt_row gt_left">HNE Relief (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">0.0</td>
## <td headers="Count" class="gt_row gt_right">0</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">50</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">50</td></tr>
##   </tbody>
##   
##   
## </table>
## </div>
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Join the data frames to calculate surplus or deficit and create the label}
\NormalTok{top\_5\_preference\_complete }\OtherTok{\textless{}{-}} \FunctionTok{left\_join}\NormalTok{(top\_5\_preference, available\_terms\_df, }\AttributeTok{by =} \StringTok{"Term\_Name"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{Surplus\_Deficit =}\NormalTok{ Number\_of\_Available\_Terms }\SpecialCharTok{{-}}\NormalTok{ Count,}
    \AttributeTok{Over\_Under\_Subscription =} \FunctionTok{round}\NormalTok{(((Count }\SpecialCharTok{/}\NormalTok{ Number\_of\_Available\_Terms) }\SpecialCharTok{{-}} \DecValTok{1}\NormalTok{) }\SpecialCharTok{*} \DecValTok{100}\NormalTok{, }\DecValTok{1}\NormalTok{)}
\NormalTok{  ) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{arrange}\NormalTok{(}\FunctionTok{desc}\NormalTok{(Over\_Under\_Subscription)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Ranking =} \FunctionTok{row\_number}\NormalTok{())  }\CommentTok{\# Update the ranking based on the new order}

\CommentTok{\# Use gt to display the results}
\NormalTok{top\_5\_gt }\OtherTok{\textless{}{-}} \FunctionTok{gt}\NormalTok{(top\_5\_preference\_complete) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{tab\_header}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"PGY1 Terms Ranked by \% Over/Under Subscription"}
\NormalTok{  ) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{cols\_label}\NormalTok{(}
    \AttributeTok{Term\_Name =} \StringTok{"Term Name"}\NormalTok{,}
    \AttributeTok{Percentage =} \StringTok{"\% Top 5 Preferences"}\NormalTok{,}
    \AttributeTok{Ranking =} \StringTok{"Ranking"}\NormalTok{,}
    \AttributeTok{Count =} \StringTok{"Count"}\NormalTok{,}
    \AttributeTok{Number\_of\_Available\_Terms =} \StringTok{"Terms Available"}\NormalTok{,}
    \AttributeTok{Surplus\_Deficit =} \StringTok{"Surplus/Deficit"}\NormalTok{,}
    \AttributeTok{Over\_Under\_Subscription =} \StringTok{"Over/Under Subscription (\%)"}
\NormalTok{  ) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{tab\_spanner}\NormalTok{(}\AttributeTok{label =} \StringTok{"Preferences"}\NormalTok{, }\AttributeTok{columns =} \FunctionTok{c}\NormalTok{(}\StringTok{"Term\_Name"}\NormalTok{, }\StringTok{"Percentage"}\NormalTok{, }\StringTok{"Count"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{cols\_move\_to\_start}\NormalTok{(}\AttributeTok{columns =} \StringTok{"Ranking"}\NormalTok{)}

\CommentTok{\# Print the gt table}
\FunctionTok{print}\NormalTok{(top\_5\_gt)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## <div id="ujyecscivu" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
##   <style>#ujyecscivu table {
##   font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
##   -webkit-font-smoothing: antialiased;
##   -moz-osx-font-smoothing: grayscale;
## }
## 
## #ujyecscivu thead, #ujyecscivu tbody, #ujyecscivu tfoot, #ujyecscivu tr, #ujyecscivu td, #ujyecscivu th {
##   border-style: none;
## }
## 
## #ujyecscivu p {
##   margin: 0;
##   padding: 0;
## }
## 
## #ujyecscivu .gt_table {
##   display: table;
##   border-collapse: collapse;
##   line-height: normal;
##   margin-left: auto;
##   margin-right: auto;
##   color: #333333;
##   font-size: 16px;
##   font-weight: normal;
##   font-style: normal;
##   background-color: #FFFFFF;
##   width: auto;
##   border-top-style: solid;
##   border-top-width: 2px;
##   border-top-color: #A8A8A8;
##   border-right-style: none;
##   border-right-width: 2px;
##   border-right-color: #D3D3D3;
##   border-bottom-style: solid;
##   border-bottom-width: 2px;
##   border-bottom-color: #A8A8A8;
##   border-left-style: none;
##   border-left-width: 2px;
##   border-left-color: #D3D3D3;
## }
## 
## #ujyecscivu .gt_caption {
##   padding-top: 4px;
##   padding-bottom: 4px;
## }
## 
## #ujyecscivu .gt_title {
##   color: #333333;
##   font-size: 125%;
##   font-weight: initial;
##   padding-top: 4px;
##   padding-bottom: 4px;
##   padding-left: 5px;
##   padding-right: 5px;
##   border-bottom-color: #FFFFFF;
##   border-bottom-width: 0;
## }
## 
## #ujyecscivu .gt_subtitle {
##   color: #333333;
##   font-size: 85%;
##   font-weight: initial;
##   padding-top: 3px;
##   padding-bottom: 5px;
##   padding-left: 5px;
##   padding-right: 5px;
##   border-top-color: #FFFFFF;
##   border-top-width: 0;
## }
## 
## #ujyecscivu .gt_heading {
##   background-color: #FFFFFF;
##   text-align: center;
##   border-bottom-color: #FFFFFF;
##   border-left-style: none;
##   border-left-width: 1px;
##   border-left-color: #D3D3D3;
##   border-right-style: none;
##   border-right-width: 1px;
##   border-right-color: #D3D3D3;
## }
## 
## #ujyecscivu .gt_bottom_border {
##   border-bottom-style: solid;
##   border-bottom-width: 2px;
##   border-bottom-color: #D3D3D3;
## }
## 
## #ujyecscivu .gt_col_headings {
##   border-top-style: solid;
##   border-top-width: 2px;
##   border-top-color: #D3D3D3;
##   border-bottom-style: solid;
##   border-bottom-width: 2px;
##   border-bottom-color: #D3D3D3;
##   border-left-style: none;
##   border-left-width: 1px;
##   border-left-color: #D3D3D3;
##   border-right-style: none;
##   border-right-width: 1px;
##   border-right-color: #D3D3D3;
## }
## 
## #ujyecscivu .gt_col_heading {
##   color: #333333;
##   background-color: #FFFFFF;
##   font-size: 100%;
##   font-weight: normal;
##   text-transform: inherit;
##   border-left-style: none;
##   border-left-width: 1px;
##   border-left-color: #D3D3D3;
##   border-right-style: none;
##   border-right-width: 1px;
##   border-right-color: #D3D3D3;
##   vertical-align: bottom;
##   padding-top: 5px;
##   padding-bottom: 6px;
##   padding-left: 5px;
##   padding-right: 5px;
##   overflow-x: hidden;
## }
## 
## #ujyecscivu .gt_column_spanner_outer {
##   color: #333333;
##   background-color: #FFFFFF;
##   font-size: 100%;
##   font-weight: normal;
##   text-transform: inherit;
##   padding-top: 0;
##   padding-bottom: 0;
##   padding-left: 4px;
##   padding-right: 4px;
## }
## 
## #ujyecscivu .gt_column_spanner_outer:first-child {
##   padding-left: 0;
## }
## 
## #ujyecscivu .gt_column_spanner_outer:last-child {
##   padding-right: 0;
## }
## 
## #ujyecscivu .gt_column_spanner {
##   border-bottom-style: solid;
##   border-bottom-width: 2px;
##   border-bottom-color: #D3D3D3;
##   vertical-align: bottom;
##   padding-top: 5px;
##   padding-bottom: 5px;
##   overflow-x: hidden;
##   display: inline-block;
##   width: 100%;
## }
## 
## #ujyecscivu .gt_spanner_row {
##   border-bottom-style: hidden;
## }
## 
## #ujyecscivu .gt_group_heading {
##   padding-top: 8px;
##   padding-bottom: 8px;
##   padding-left: 5px;
##   padding-right: 5px;
##   color: #333333;
##   background-color: #FFFFFF;
##   font-size: 100%;
##   font-weight: initial;
##   text-transform: inherit;
##   border-top-style: solid;
##   border-top-width: 2px;
##   border-top-color: #D3D3D3;
##   border-bottom-style: solid;
##   border-bottom-width: 2px;
##   border-bottom-color: #D3D3D3;
##   border-left-style: none;
##   border-left-width: 1px;
##   border-left-color: #D3D3D3;
##   border-right-style: none;
##   border-right-width: 1px;
##   border-right-color: #D3D3D3;
##   vertical-align: middle;
##   text-align: left;
## }
## 
## #ujyecscivu .gt_empty_group_heading {
##   padding: 0.5px;
##   color: #333333;
##   background-color: #FFFFFF;
##   font-size: 100%;
##   font-weight: initial;
##   border-top-style: solid;
##   border-top-width: 2px;
##   border-top-color: #D3D3D3;
##   border-bottom-style: solid;
##   border-bottom-width: 2px;
##   border-bottom-color: #D3D3D3;
##   vertical-align: middle;
## }
## 
## #ujyecscivu .gt_from_md > :first-child {
##   margin-top: 0;
## }
## 
## #ujyecscivu .gt_from_md > :last-child {
##   margin-bottom: 0;
## }
## 
## #ujyecscivu .gt_row {
##   padding-top: 8px;
##   padding-bottom: 8px;
##   padding-left: 5px;
##   padding-right: 5px;
##   margin: 10px;
##   border-top-style: solid;
##   border-top-width: 1px;
##   border-top-color: #D3D3D3;
##   border-left-style: none;
##   border-left-width: 1px;
##   border-left-color: #D3D3D3;
##   border-right-style: none;
##   border-right-width: 1px;
##   border-right-color: #D3D3D3;
##   vertical-align: middle;
##   overflow-x: hidden;
## }
## 
## #ujyecscivu .gt_stub {
##   color: #333333;
##   background-color: #FFFFFF;
##   font-size: 100%;
##   font-weight: initial;
##   text-transform: inherit;
##   border-right-style: solid;
##   border-right-width: 2px;
##   border-right-color: #D3D3D3;
##   padding-left: 5px;
##   padding-right: 5px;
## }
## 
## #ujyecscivu .gt_stub_row_group {
##   color: #333333;
##   background-color: #FFFFFF;
##   font-size: 100%;
##   font-weight: initial;
##   text-transform: inherit;
##   border-right-style: solid;
##   border-right-width: 2px;
##   border-right-color: #D3D3D3;
##   padding-left: 5px;
##   padding-right: 5px;
##   vertical-align: top;
## }
## 
## #ujyecscivu .gt_row_group_first td {
##   border-top-width: 2px;
## }
## 
## #ujyecscivu .gt_row_group_first th {
##   border-top-width: 2px;
## }
## 
## #ujyecscivu .gt_summary_row {
##   color: #333333;
##   background-color: #FFFFFF;
##   text-transform: inherit;
##   padding-top: 8px;
##   padding-bottom: 8px;
##   padding-left: 5px;
##   padding-right: 5px;
## }
## 
## #ujyecscivu .gt_first_summary_row {
##   border-top-style: solid;
##   border-top-color: #D3D3D3;
## }
## 
## #ujyecscivu .gt_first_summary_row.thick {
##   border-top-width: 2px;
## }
## 
## #ujyecscivu .gt_last_summary_row {
##   padding-top: 8px;
##   padding-bottom: 8px;
##   padding-left: 5px;
##   padding-right: 5px;
##   border-bottom-style: solid;
##   border-bottom-width: 2px;
##   border-bottom-color: #D3D3D3;
## }
## 
## #ujyecscivu .gt_grand_summary_row {
##   color: #333333;
##   background-color: #FFFFFF;
##   text-transform: inherit;
##   padding-top: 8px;
##   padding-bottom: 8px;
##   padding-left: 5px;
##   padding-right: 5px;
## }
## 
## #ujyecscivu .gt_first_grand_summary_row {
##   padding-top: 8px;
##   padding-bottom: 8px;
##   padding-left: 5px;
##   padding-right: 5px;
##   border-top-style: double;
##   border-top-width: 6px;
##   border-top-color: #D3D3D3;
## }
## 
## #ujyecscivu .gt_last_grand_summary_row_top {
##   padding-top: 8px;
##   padding-bottom: 8px;
##   padding-left: 5px;
##   padding-right: 5px;
##   border-bottom-style: double;
##   border-bottom-width: 6px;
##   border-bottom-color: #D3D3D3;
## }
## 
## #ujyecscivu .gt_striped {
##   background-color: rgba(128, 128, 128, 0.05);
## }
## 
## #ujyecscivu .gt_table_body {
##   border-top-style: solid;
##   border-top-width: 2px;
##   border-top-color: #D3D3D3;
##   border-bottom-style: solid;
##   border-bottom-width: 2px;
##   border-bottom-color: #D3D3D3;
## }
## 
## #ujyecscivu .gt_footnotes {
##   color: #333333;
##   background-color: #FFFFFF;
##   border-bottom-style: none;
##   border-bottom-width: 2px;
##   border-bottom-color: #D3D3D3;
##   border-left-style: none;
##   border-left-width: 2px;
##   border-left-color: #D3D3D3;
##   border-right-style: none;
##   border-right-width: 2px;
##   border-right-color: #D3D3D3;
## }
## 
## #ujyecscivu .gt_footnote {
##   margin: 0px;
##   font-size: 90%;
##   padding-top: 4px;
##   padding-bottom: 4px;
##   padding-left: 5px;
##   padding-right: 5px;
## }
## 
## #ujyecscivu .gt_sourcenotes {
##   color: #333333;
##   background-color: #FFFFFF;
##   border-bottom-style: none;
##   border-bottom-width: 2px;
##   border-bottom-color: #D3D3D3;
##   border-left-style: none;
##   border-left-width: 2px;
##   border-left-color: #D3D3D3;
##   border-right-style: none;
##   border-right-width: 2px;
##   border-right-color: #D3D3D3;
## }
## 
## #ujyecscivu .gt_sourcenote {
##   font-size: 90%;
##   padding-top: 4px;
##   padding-bottom: 4px;
##   padding-left: 5px;
##   padding-right: 5px;
## }
## 
## #ujyecscivu .gt_left {
##   text-align: left;
## }
## 
## #ujyecscivu .gt_center {
##   text-align: center;
## }
## 
## #ujyecscivu .gt_right {
##   text-align: right;
##   font-variant-numeric: tabular-nums;
## }
## 
## #ujyecscivu .gt_font_normal {
##   font-weight: normal;
## }
## 
## #ujyecscivu .gt_font_bold {
##   font-weight: bold;
## }
## 
## #ujyecscivu .gt_font_italic {
##   font-style: italic;
## }
## 
## #ujyecscivu .gt_super {
##   font-size: 65%;
## }
## 
## #ujyecscivu .gt_footnote_marks {
##   font-size: 75%;
##   vertical-align: 0.4em;
##   position: initial;
## }
## 
## #ujyecscivu .gt_asterisk {
##   font-size: 100%;
##   vertical-align: 0;
## }
## 
## #ujyecscivu .gt_indent_1 {
##   text-indent: 5px;
## }
## 
## #ujyecscivu .gt_indent_2 {
##   text-indent: 10px;
## }
## 
## #ujyecscivu .gt_indent_3 {
##   text-indent: 15px;
## }
## 
## #ujyecscivu .gt_indent_4 {
##   text-indent: 20px;
## }
## 
## #ujyecscivu .gt_indent_5 {
##   text-indent: 25px;
## }
## </style>
##   <table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
##   <thead>
##     <tr class="gt_heading">
##       <td colspan="7" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>PGY1 Terms Ranked by % Over/Under Subscription</td>
##     </tr>
##     
##     <tr class="gt_col_headings gt_spanner_row">
##       <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col" id="Ranking">Ranking</th>
##       <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="3" scope="colgroup" id="Preferences">
##         <span class="gt_column_spanner">Preferences</span>
##       </th>
##       <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col" id="Terms Available">Terms Available</th>
##       <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col" id="Surplus/Deficit">Surplus/Deficit</th>
##       <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col" id="Over/Under Subscription (%)">Over/Under Subscription (%)</th>
##     </tr>
##     <tr class="gt_col_headings">
##       <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Term Name">Term Name</th>
##       <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="% Top 5 Preferences">% Top 5 Preferences</th>
##       <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Count">Count</th>
##     </tr>
##   </thead>
##   <tbody class="gt_table_body">
##     <tr><td headers="Ranking" class="gt_row gt_right">1</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Medicine - Rheumatology (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">16.7</td>
## <td headers="Count" class="gt_row gt_right">14</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">1</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-13</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">1300.0</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">2</td>
## <td headers="Term_Name" class="gt_row gt_left">CMN Medicine - Gastroenterology with Drug &amp; Alcohol (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">15.5</td>
## <td headers="Count" class="gt_row gt_right">13</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">2</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-11</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">550.0</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">3</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Medicine - Dermatology (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">15.5</td>
## <td headers="Count" class="gt_row gt_right">13</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">2</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-11</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">550.0</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">4</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Obstetrics &amp; Gynaecology (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">27.4</td>
## <td headers="Count" class="gt_row gt_right">23</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">5</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-18</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">360.0</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">5</td>
## <td headers="Term_Name" class="gt_row gt_left">CMN Medicine - Cardiology (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">15.5</td>
## <td headers="Count" class="gt_row gt_right">13</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">3</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-10</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">333.3</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">6</td>
## <td headers="Term_Name" class="gt_row gt_left">CMN Palliative Care (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">9.5</td>
## <td headers="Count" class="gt_row gt_right">8</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">2</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-6</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">300.0</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">7</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Surgery - Ear, Nose and Throat (ENT) (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">9.5</td>
## <td headers="Count" class="gt_row gt_right">8</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">2</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-6</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">300.0</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">8</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Medicine - MACU (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">8.3</td>
## <td headers="Count" class="gt_row gt_right">7</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">2</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-5</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">250.0</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">9</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Medicine - Infectious Disease (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">11.9</td>
## <td headers="Count" class="gt_row gt_right">10</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">3</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-7</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">233.3</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">10</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH General Surgery / Trauma (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">17.9</td>
## <td headers="Count" class="gt_row gt_right">15</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">5</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-10</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">200.0</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">11</td>
## <td headers="Term_Name" class="gt_row gt_left">BDH Drug and Alcohol Clinical Services (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">7.1</td>
## <td headers="Count" class="gt_row gt_right">6</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">2</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-4</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">200.0</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">12</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Surgery - Oral Maxillofacial (OMF) (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">7.1</td>
## <td headers="Count" class="gt_row gt_right">6</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">2</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-4</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">200.0</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">13</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Medicine - Cardiology (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">25.0</td>
## <td headers="Count" class="gt_row gt_right">21</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">8</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-13</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">162.5</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">14</td>
## <td headers="Term_Name" class="gt_row gt_left">HNE Mental Health &amp; Substance Use Service - Mater Hospital (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">15.5</td>
## <td headers="Count" class="gt_row gt_right">13</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">5</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-8</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">160.0</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">15</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH General Surgery / Hepatopancreatobiliary and Upper GI Surgery (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">8.3</td>
## <td headers="Count" class="gt_row gt_right">7</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">3</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-4</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">133.3</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">16</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Medicine - Respiratory (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">19.0</td>
## <td headers="Count" class="gt_row gt_right">16</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">7</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-9</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">128.6</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">17</td>
## <td headers="Term_Name" class="gt_row gt_left">CMN Medicine - Haematology (01) (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">13.1</td>
## <td headers="Count" class="gt_row gt_right">11</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">5</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-6</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">120.0</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">18</td>
## <td headers="Term_Name" class="gt_row gt_left">HNE Mental Health Lake Macquarie Ward - Mater hospital (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">13.1</td>
## <td headers="Count" class="gt_row gt_right">11</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">5</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-6</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">120.0</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">19</td>
## <td headers="Term_Name" class="gt_row gt_left">HNE Mental Health Newcastle Inpatient Unit - Mater Hospital (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">13.1</td>
## <td headers="Count" class="gt_row gt_right">11</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">5</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-6</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">120.0</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">20</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH General Surgery / Colorectal (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">4.8</td>
## <td headers="Count" class="gt_row gt_right">4</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">2</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-2</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">100.0</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">21</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Medicine - Nephrology &amp; Dialysis (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">8.3</td>
## <td headers="Count" class="gt_row gt_right">7</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">4</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-3</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">75.0</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">22</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Surgery - Orthopaedics (Team 6) (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">6.0</td>
## <td headers="Count" class="gt_row gt_right">5</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">3</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-2</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">66.7</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">23</td>
## <td headers="Term_Name" class="gt_row gt_left">TRRH General Medicine 08 (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">6.0</td>
## <td headers="Count" class="gt_row gt_right">5</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">3</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-2</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">66.7</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">24</td>
## <td headers="Term_Name" class="gt_row gt_left">CMN Medicine - Medical Oncology (01) (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">9.5</td>
## <td headers="Count" class="gt_row gt_right">8</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">5</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-3</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">60.0</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">25</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Medicine - Neurology (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">7.1</td>
## <td headers="Count" class="gt_row gt_right">6</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">4</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-2</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">50.0</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">26</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Surgery - Cardiothoracic Surgery (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">7.1</td>
## <td headers="Count" class="gt_row gt_right">6</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">4</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-2</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">50.0</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">27</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH General Surgery / Upper GI (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">3.6</td>
## <td headers="Count" class="gt_row gt_right">3</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">2</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-1</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">50.0</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">28</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Emergency (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">57.1</td>
## <td headers="Count" class="gt_row gt_right">48</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">37</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-11</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">29.7</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">29</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Medicine - Gastroenterology (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">10.7</td>
## <td headers="Count" class="gt_row gt_right">9</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">8</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">-1</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">12.5</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">30</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Surgery - Urology (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">11.9</td>
## <td headers="Count" class="gt_row gt_right">10</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">10</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">0</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">0.0</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">31</td>
## <td headers="Term_Name" class="gt_row gt_left">BDH Acute General Medicine &amp; Cardiology (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">3.6</td>
## <td headers="Count" class="gt_row gt_right">3</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">3</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">0</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">0.0</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">32</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Acute General Surgery Unit (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">9.5</td>
## <td headers="Count" class="gt_row gt_right">8</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">10</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">2</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">-20.0</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">33</td>
## <td headers="Term_Name" class="gt_row gt_left">HNE Mental Health Older People's Service - Mater Hospital (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">4.8</td>
## <td headers="Count" class="gt_row gt_right">4</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">5</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">1</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">-20.0</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">34</td>
## <td headers="Term_Name" class="gt_row gt_left">BDH Emergency (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">7.1</td>
## <td headers="Count" class="gt_row gt_right">6</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">8</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">2</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">-25.0</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">35</td>
## <td headers="Term_Name" class="gt_row gt_left">MBH Emergency (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">3.6</td>
## <td headers="Count" class="gt_row gt_right">3</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">4</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">1</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">-25.0</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">36</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Surgery - Neurosurgery (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">8.3</td>
## <td headers="Count" class="gt_row gt_right">7</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">10</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">3</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">-30.0</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">37</td>
## <td headers="Term_Name" class="gt_row gt_left">MH  Medicine - Cardiology (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">2.4</td>
## <td headers="Count" class="gt_row gt_right">2</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">3</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">1</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">-33.3</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">38</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Surgery - Vascular (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">6.0</td>
## <td headers="Count" class="gt_row gt_right">5</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">8</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">3</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">-37.5</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">39</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH General Medicine (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">11.9</td>
## <td headers="Count" class="gt_row gt_right">10</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">20</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">10</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">-50.0</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">40</td>
## <td headers="Term_Name" class="gt_row gt_left">CMN Surgery (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">6.0</td>
## <td headers="Count" class="gt_row gt_right">5</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">10</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">5</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">-50.0</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">41</td>
## <td headers="Term_Name" class="gt_row gt_left">TRRH Surgery C (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">1.2</td>
## <td headers="Count" class="gt_row gt_right">1</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">2</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">1</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">-50.0</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">42</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Medicine - Rehabilitation (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">4.8</td>
## <td headers="Count" class="gt_row gt_right">4</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">9</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">5</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">-55.6</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">43</td>
## <td headers="Term_Name" class="gt_row gt_left">CMN Emergency (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">7.1</td>
## <td headers="Count" class="gt_row gt_right">6</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">15</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">9</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">-60.0</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">44</td>
## <td headers="Term_Name" class="gt_row gt_left">BDH Acute General Medicine (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">2.4</td>
## <td headers="Count" class="gt_row gt_right">2</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">5</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">3</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">-60.0</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">45</td>
## <td headers="Term_Name" class="gt_row gt_left">TRRH Surgery - Orthopaedics 02 (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">1.2</td>
## <td headers="Count" class="gt_row gt_right">1</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">3</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">2</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">-66.7</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">46</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Surgery - Orthopaedics (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">7.1</td>
## <td headers="Count" class="gt_row gt_right">6</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">25</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">19</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">-76.0</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">47</td>
## <td headers="Term_Name" class="gt_row gt_left">BDH Surgery (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">1.2</td>
## <td headers="Count" class="gt_row gt_right">1</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">5</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">4</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">-80.0</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">48</td>
## <td headers="Term_Name" class="gt_row gt_left">MH KK Rehabilitation (PGY 1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">1.2</td>
## <td headers="Count" class="gt_row gt_right">1</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">5</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">4</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">-80.0</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">49</td>
## <td headers="Term_Name" class="gt_row gt_left">CMN General Medicine (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">3.6</td>
## <td headers="Count" class="gt_row gt_right">3</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">20</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">17</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">-85.0</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">50</td>
## <td headers="Term_Name" class="gt_row gt_left">MH General Medicine (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">2.4</td>
## <td headers="Count" class="gt_row gt_right">2</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">15</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">13</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">-86.7</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">51</td>
## <td headers="Term_Name" class="gt_row gt_left">MH Emergency (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">3.6</td>
## <td headers="Count" class="gt_row gt_right">3</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">25</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">22</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">-88.0</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">52</td>
## <td headers="Term_Name" class="gt_row gt_left">BDH Acute General Medicine &amp; Rehabilitation (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">0.0</td>
## <td headers="Count" class="gt_row gt_right">0</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">2</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">2</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">-100.0</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">53</td>
## <td headers="Term_Name" class="gt_row gt_left">BDH After Hours Internal Relief (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">0.0</td>
## <td headers="Count" class="gt_row gt_right">0</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">8</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">8</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">-100.0</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">54</td>
## <td headers="Term_Name" class="gt_row gt_left">BDH Sub-Acute General Medicine (Team 5) (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">0.0</td>
## <td headers="Count" class="gt_row gt_right">0</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">2</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">2</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">-100.0</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">55</td>
## <td headers="Term_Name" class="gt_row gt_left">CMN Relief (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">0.0</td>
## <td headers="Count" class="gt_row gt_right">0</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">18</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">18</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">-100.0</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">56</td>
## <td headers="Term_Name" class="gt_row gt_left">HNE Relief (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">0.0</td>
## <td headers="Count" class="gt_row gt_right">0</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">50</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">50</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">-100.0</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">57</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Medicine Relief (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">0.0</td>
## <td headers="Count" class="gt_row gt_right">0</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">15</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">15</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">-100.0</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">58</td>
## <td headers="Term_Name" class="gt_row gt_left">JHH Surgery Relief (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">0.0</td>
## <td headers="Count" class="gt_row gt_right">0</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">10</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">10</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">-100.0</td></tr>
##     <tr><td headers="Ranking" class="gt_row gt_right">59</td>
## <td headers="Term_Name" class="gt_row gt_left">MH General Surgery (PGY1/2)</td>
## <td headers="Percentage" class="gt_row gt_right">0.0</td>
## <td headers="Count" class="gt_row gt_right">0</td>
## <td headers="Number_of_Available_Terms" class="gt_row gt_right">10</td>
## <td headers="Surplus_Deficit" class="gt_row gt_right">10</td>
## <td headers="Over_Under_Subscription" class="gt_row gt_right">-100.0</td></tr>
##   </tbody>
##   
##   
## </table>
## </div>
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{export\_tables }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(assignment\_table, evaluation\_table, doctor\_preference\_report, HETI\_compliance\_table, preference\_matrix, unassigned\_df, filename) \{}
  
  \CommentTok{\# Convert gt tables back to data.frame if necessary}
  \ControlFlowTok{if}\NormalTok{ (}\FunctionTok{inherits}\NormalTok{(assignment\_table, }\StringTok{"gt\_tbl"}\NormalTok{)) \{}
\NormalTok{    assignment\_table }\OtherTok{\textless{}{-}} \FunctionTok{as.data.frame}\NormalTok{(assignment\_table)}
\NormalTok{  \}}
  \ControlFlowTok{if}\NormalTok{ (}\FunctionTok{inherits}\NormalTok{(evaluation\_table, }\StringTok{"gt\_tbl"}\NormalTok{)) \{}
\NormalTok{    evaluation\_table }\OtherTok{\textless{}{-}} \FunctionTok{as.data.frame}\NormalTok{(evaluation\_table)}
\NormalTok{  \}}
  \ControlFlowTok{if}\NormalTok{ (}\FunctionTok{inherits}\NormalTok{(doctor\_preference\_report, }\StringTok{"gt\_tbl"}\NormalTok{)) \{}
\NormalTok{    doctor\_preference\_report }\OtherTok{\textless{}{-}} \FunctionTok{as.data.frame}\NormalTok{(doctor\_preference\_report)}
\NormalTok{  \}}
  \ControlFlowTok{if}\NormalTok{ (}\FunctionTok{inherits}\NormalTok{(HETI\_compliance\_table, }\StringTok{"gt\_tbl"}\NormalTok{)) \{}
\NormalTok{    HETI\_compliance\_table }\OtherTok{\textless{}{-}} \FunctionTok{as.data.frame}\NormalTok{(HETI\_compliance\_table)}
\NormalTok{  \}}
  
  \CommentTok{\# Convert the preference\_matrix to a data frame and add Doctor names if it\textquotesingle{}s a matrix}
  \ControlFlowTok{if}\NormalTok{ (}\FunctionTok{is.matrix}\NormalTok{(preference\_matrix)) \{}
\NormalTok{    preference\_matrix\_df }\OtherTok{\textless{}{-}} \FunctionTok{as.data.frame}\NormalTok{(preference\_matrix)}
    \CommentTok{\# Add doctor names from the rownames of the matrix if they exist}
    \ControlFlowTok{if}\NormalTok{ (}\SpecialCharTok{!}\FunctionTok{is.null}\NormalTok{(}\FunctionTok{rownames}\NormalTok{(preference\_matrix))) \{}
\NormalTok{      preference\_matrix\_df }\OtherTok{\textless{}{-}} \FunctionTok{cbind}\NormalTok{(}\AttributeTok{Doctor =} \FunctionTok{rownames}\NormalTok{(preference\_matrix), preference\_matrix\_df)}
\NormalTok{    \}}
\NormalTok{  \} }\ControlFlowTok{else}\NormalTok{ \{}
\NormalTok{    preference\_matrix\_df }\OtherTok{\textless{}{-}}\NormalTok{ preference\_matrix}
\NormalTok{  \}}
  
  \CommentTok{\# Join the survey\_data and assignment\_table on the "Doctor" column}
\NormalTok{  assignment\_table\_with\_survey }\OtherTok{\textless{}{-}} \FunctionTok{left\_join}\NormalTok{(survey\_data, assignment\_table, }\AttributeTok{by =} \StringTok{"Doctor"}\NormalTok{)}
  
  \CommentTok{\# Prepare the list of tables to be exported}
\NormalTok{  tables\_list }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}
    \AttributeTok{AssignmentTable =}\NormalTok{ assignment\_table\_with\_survey,}
    \AttributeTok{EvaluationTable =}\NormalTok{ evaluation\_table,}
    \AttributeTok{DoctorPreferenceReport =}\NormalTok{ doctor\_preference\_report,}
    \AttributeTok{HETIComplianceTable =}\NormalTok{ HETI\_compliance\_table,}
    \AttributeTok{PreferenceMatrix =}\NormalTok{ preference\_matrix\_df,}
    \AttributeTok{UnassignedTerms =}\NormalTok{ unassigned\_df}
\NormalTok{  )}
  
  \CommentTok{\# Export to .xlsx file}
\NormalTok{  writexl}\SpecialCharTok{::}\FunctionTok{write\_xlsx}\NormalTok{(tables\_list, }\AttributeTok{path =}\NormalTok{ filename)}
\NormalTok{\}}

\CommentTok{\# Call the function with all the necessary data frames and the filename}
\FunctionTok{export\_tables}\NormalTok{(}
  \AttributeTok{assignment\_table =}\NormalTok{ assignment\_table,}
  \AttributeTok{unassigned\_df =}\NormalTok{ unassigned\_df,}
  \AttributeTok{doctor\_preference\_report =}\NormalTok{ doctor\_preference\_report,}
  \AttributeTok{HETI\_compliance\_table =}\NormalTok{ HETI\_compliance\_table,}
  \AttributeTok{preference\_matrix =}\NormalTok{ preference\_matrix,}
  \AttributeTok{evaluation\_table =}\NormalTok{ evaluation\_table,}
  
  \AttributeTok{filename =} \StringTok{"PGY1\_Allocations\_export.xlsx"}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\emph{This code, inclusive of all associated documentation and related
content, is the exclusive intellectual property of Dr.~Scott Johnson
Gelzinnis under the Copyright Act 1968 (Cth) of Australia. Any
unauthorized use, reproduction, distribution, or modification of this
material, in entirety or in parts, without the prior written consent of
Dr.~Scott Johnson Gelzinnis, may constitute a breach of Australian
copyright laws and can result in legal action.}

\end{document}
